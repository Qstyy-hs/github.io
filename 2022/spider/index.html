<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    
    <title>学习札记-Python爬虫基础入门 | Kmoon | 个人学习记录</title>

    <meta name="description" content="&lt;blockquote&gt;
&lt;p&gt;2022-12-18 ~ 2022.12.22&lt;br&gt;历时四天，过了一遍尚硅谷视频，掌握了基础爬虫知识。&lt;br&gt;接下来计划利用一周时间将所有案例练习全部亲手敲一遍，巩固一下各个库和框架的内容。&lt;br&gt;然后自己写一个爬取携程网特定旅游景点评论数据，导入MySQL数据库(作为乡村文旅项目数据源)&lt;/p&gt;
&lt;/blockquote&gt;">
    <meta name="keywords" content="">

    

    <meta property="og:locale" content="cn" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content= "学习札记-Python爬虫基础入门 | Kmoon | 个人学习记录"  />
    <meta property="og:description" content= "&lt;blockquote&gt;
&lt;p&gt;2022-12-18 ~ 2022.12.22&lt;br&gt;历时四天，过了一遍尚硅谷视频，掌握了基础爬虫知识。&lt;br&gt;接下来计划利用一周时间将所有案例练习全部亲手敲一遍，巩固一下各个库和框架的内容。&lt;br&gt;然后自己写一个爬取携程网特定旅游景点评论数据，导入MySQL数据库(作为乡村文旅项目数据源)&lt;/p&gt;
&lt;/blockquote&gt;" />
    <meta property="og:url" content="https://www.kmoon.fun/2022/spider/index.html" />
    <meta property="og:site_name" content="" />
    <meta property="article:author" content="Kmoon" />
    <meta property="article:publisher" content="" />
    <meta property="og:description" content="&lt;blockquote&gt;
&lt;p&gt;2022-12-18 ~ 2022.12.22&lt;br&gt;历时四天，过了一遍尚硅谷视频，掌握了基础爬虫知识。&lt;br&gt;接下来计划利用一周时间将所有案例练习全部亲手敲一遍，巩固一下各个库和框架的内容。&lt;br&gt;然后自己写一个爬取携程网特定旅游景点评论数据，导入MySQL数据库(作为乡村文旅项目数据源)&lt;/p&gt;
&lt;/blockquote&gt;" />
    <meta name="twitter:title" content="学习札记-Python爬虫基础入门 | Kmoon | 个人学习记录"/>
    <meta name="twitter:description" content="&lt;blockquote&gt;
&lt;p&gt;2022-12-18 ~ 2022.12.22&lt;br&gt;历时四天，过了一遍尚硅谷视频，掌握了基础爬虫知识。&lt;br&gt;接下来计划利用一周时间将所有案例练习全部亲手敲一遍，巩固一下各个库和框架的内容。&lt;br&gt;然后自己写一个爬取携程网特定旅游景点评论数据，导入MySQL数据库(作为乡村文旅项目数据源)&lt;/p&gt;
&lt;/blockquote&gt;"/>
    <script type="application/ld+json">
        {
            "description": "&lt;blockquote&gt;
&lt;p&gt;2022-12-18 ~ 2022.12.22&lt;br&gt;历时四天，过了一遍尚硅谷视频，掌握了基础爬虫知识。&lt;br&gt;接下来计划利用一周时间将所有案例练习全部亲手敲一遍，巩固一下各个库和框架的内容。&lt;br&gt;然后自己写一个爬取携程网特定旅游景点评论数据，导入MySQL数据库(作为乡村文旅项目数据源)&lt;/p&gt;
&lt;/blockquote&gt;",
            "author": { "@type": "Person", "name": "Kmoon" },
            "@type": "BlogPosting",
            "url": "https://www.kmoon.fun/2022/spider/index.html",
            "publisher": {
            "@type": "Organization",
            "logo": {
                "@type": "ImageObject",
                "url": "https://www.kmoon.fun/image/avatar.png"
            },
            "name": "Kmoon"
            },
            "headline": "学习札记-Python爬虫基础入门 | Kmoon | 个人学习记录",
            "datePublished": "2022-12-18T00:51:41.000Z",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://www.kmoon.fun/2022/spider/index.html"
            },
            "@context": "http://schema.org"
        }
    </script>




    

    
    <meta property="algolia:search" data-application-id="8Z51BHYAUH" data-api-key="dbc9dafd607e95ea5aa312369120eabd" data-index-name="kmoon_blog">
    

    

    

    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🌜️</text></svg>">
    

    

    

    
<link rel="stylesheet" href="/dist/build.css?v=1654266144177.css">


    
<link rel="stylesheet" href="/dist/custom.css?v=1654266144177.css">


    <script>
        window.isPost = true
        window.aomori = {
            
            
            valine: {
                enable: true,
                appId: "i7G1tHcsR13KVa00grUUf6mr-gzGzoHsz",
                appKey: "94N35fphXFiN5BGMNS9V5mHe",
                placeholder: "Hello World!",
                avatar: "",
                pageSize: "10",
                lang: "zh-CN",
                visitor: false,
                highlight: false,
                recordIP: false,
                emojiCDN: "",
                enableQQ: false,
                requiredFields: []
            },
            
            
        }
        window.aomori_logo_typed_animated = true
        window.aomori_search_algolia = true

    </script>

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Kmoon | 个人学习记录" type="application/atom+xml">
</head>

<body>

    <div class="container">
    <header class="header">
        <div class="header-type">
            
            <div class="header-type-avatar avatar avatar-sm">
                <img src="/image/avatar.png" alt="Kmoon">
            </div>
            
            <div class="header-type-inner">
                
                    <div id="typed-strings" style="display:none">
                        <p>Kmoon | 个人学习记录</p>
                    </div>
                    <a class="header-type-title" id="typed" href="/"></a>
                
    
                
            </div>
        </div>
        <div class="header-menu">
            <div class="header-menu-inner">
                
                <a href="/">主页</a>
                
                <a href="/archives">归档</a>
                
                <a href="/2022/10/about/">关于</a>
                
                <a href="/friends">友链</a>
                
                <a href="/photography">摄影</a>
                
                <a href="/categories/%E6%B7%B1%E6%B8%8A/">深渊</a>
                
                <a href="/wiki/">Wiki</a>
                
            </div>
            <div class="header-menu-social">
                
    <a class="social" target="_blank" href="https://github.com/kmoonn/">
        <ion-icon name="logo-github"></ion-icon>
    </a>

    <a class="social" target="_blank" href="">
        <ion-icon name="logo-wechat"></ion-icon>
    </a>

            </div>
        </div>

        <div class="header-menu-mobile">
            <div class="header-menu-mobile-inner" id="mobile-menu-open">
                <i class="icon icon-menu"></i>
            </div>
        </div>
    </header>

    <div class="header-menu-mobile-menu">
        <div class="header-menu-mobile-menu-bg"></div>
        <div class="header-menu-mobile-menu-wrap">
            <div class="header-menu-mobile-menu-inner">
                <div class="header-menu-mobile-menu-close" id="mobile-menu-close">
                    <i class="icon icon-cross"></i>
                </div>
                <div class="header-menu-mobile-menu-list">
                    
                    <a href="/">主页</a>
                    
                    <a href="/archives">归档</a>
                    
                    <a href="/2022/10/about/">关于</a>
                    
                    <a href="/friends">友链</a>
                    
                    <a href="/photography">摄影</a>
                    
                    <a href="/categories/%E6%B7%B1%E6%B8%8A/">深渊</a>
                    
                    <a href="/wiki/">Wiki</a>
                    
                </div>
            </div>
        </div>
    </div>

</div>

    <div class="container">
        <div class="main">
            <section class="inner">
                <section class="inner-main">
                    <div class="post">
    <article id="post-cld1b87d9002zo8vm583d5sqr" class="article article-type-post" itemscope
    itemprop="blogPost">

    <div class="article-inner">

        
          
        
        
        

        
        <header class="article-header">
            
  
    <h1 class="article-title" itemprop="name">
      学习札记-Python爬虫基础入门
    </h1>
  

        </header>
        

        <div class="article-more-info article-more-info-post hairline">

            <div class="article-date">
  <time datetime="2022-12-18T00:51:41.000Z" itemprop="datePublished">2022-12-18</time>
</div>

            
            <div class="article-category">
                <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0%E6%9C%AD%E8%AE%B0/">学习札记</a>
            </div>
            

            
            <div class="article-tag">
                <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li></ul>
            </div>
            

            
            <div class="article-busuanzi">
                <span id="busuanzi_value_page_pv">N</span> 人看过
            </div>
            

        </div>

        <div class="article-entry post-inner-html hairline" itemprop="articleBody">
            <blockquote>
<p>2022-12-18 ~ 2022.12.22<br>历时四天，过了一遍尚硅谷视频，掌握了基础爬虫知识。<br>接下来计划利用一周时间将所有案例练习全部亲手敲一遍，巩固一下各个库和框架的内容。<br>然后自己写一个爬取携程网特定旅游景点评论数据，导入MySQL数据库(作为乡村文旅项目数据源)</p>
</blockquote>
<span id="more"></span>

<img src="http://image.kmoon.fun//images/202212221721137.png" alt="image-20221222172157807" style="zoom:80%;">

<h3 id="案例练习"><a href="#案例练习" class="headerlink" title="案例练习"></a>案例练习</h3><ul>
<li>post请求百度翻译</li>
<li>ajax的get请求豆瓣电影</li>
<li>ajax的post请求肯德基官网</li>
<li>QQ空间的cookie登录</li>
<li>xpath获取站长之家素材</li>
<li>jsonpath解析淘票票</li>
<li>bs4爬取星巴克数据</li>
<li>requests cookie登录古诗文网</li>
<li>超级鹰打码平台使用</li>
<li>scrapy 58同城</li>
<li>scrapy 汽车之家</li>
<li>scrapy 当当网</li>
<li>scrapy 电影天堂</li>
<li>scrapy 链接提取器</li>
<li>scrapy crawlspider 读书网数据入库</li>
</ul>
<p><img src="http://image.kmoon.fun//images/202212180855461.png" alt="image-20221218085504392"></p>
<h1 id="python安装"><a href="#python安装" class="headerlink" title="python安装"></a>python安装</h1><p><a href="http://www.python.org/">http://www.python.org/</a>	python3.7</p>
<h1 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h1><p>用户变量 Path： E:\python\   E:\python\Scripts\</p>
<p>新添加的路径 E:\python 是Python安装好以后Python.exe 这个可执行文件所在的目录</p>
<p>新添加的路径 E:\python\Scripts 是Python安装好以后， pip.exe 这个可执行文件所在的目录。</p>
<h1 id="pip"><a href="#pip" class="headerlink" title="pip"></a>pip</h1><blockquote>
<p>pip是一个现代的、通用的Python包管理工具。</p>
<p>提供了对python包的查找、下载、安装、卸载的功能，便于我们对Python的资源包进行管理。</p>
</blockquote>
<p>pip -V 查看版本</p>
<p><img src="http://image.kmoon.fun//images/202212180923100.png" alt="image-20221218092308052"></p>
<h2 id="修改pip下载源"><a href="#修改pip下载源" class="headerlink" title="修改pip下载源"></a>修改pip下载源</h2><p>默认是从 <a href="https://files.pythonhosted.org/">https://files.pythonhosted.org/</a> 网站上下载</p>
<p><code>pip install 包名 -i 国内源地址</code></p>
<p><img src="http://image.kmoon.fun//images/202212180924238.png" alt="image-20221218092445165"></p>
<h1 id="运行Python"><a href="#运行Python" class="headerlink" title="运行Python"></a>运行Python</h1><h2 id="终端运行"><a href="#终端运行" class="headerlink" title="终端运行"></a>终端运行</h2><ol>
<li><p>直接在python解释器中书写代码</p>
<p>退出python环境： exit()  ctrl+Z</p>
</li>
<li><p>使用ipython解释器编写代码</p>
</li>
</ol>
<h2 id="运行python文件"><a href="#运行python文件" class="headerlink" title="运行python文件"></a>运行python文件</h2><p>使用python指令运行后缀为.py的python文件</p>
<h1 id="Pycharm"><a href="#Pycharm" class="headerlink" title="Pycharm"></a>Pycharm</h1><ul>
<li><p>IDE的概念</p>
<p><img src="http://image.kmoon.fun//images/202212180930358.png" alt="image-20221218093044306"></p>
<p><img src="http://image.kmoon.fun//images/202212180931188.png" alt="image-20221218093112140"></p>
</li>
<li><p>pycharm安装</p>
<p><img src="http://image.kmoon.fun//images/202212180931789.png" alt="image-20221218093145748"></p>
</li>
<li><p>pycharm使用介绍</p>
<p>新建工程</p>
<p><img src="http://image.kmoon.fun//images/202212180932230.png" alt="image-20221218093258173"></p>
</li>
</ul>
<p>扩展：自动生成指定的注释</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># _*_ coding : utf-8 _*_</span>
<span class="token comment"># @Time : 2022/1/14 15:27</span>
<span class="token comment"># @Author : Kmoon_Hs</span>
<span class="token comment"># @File : pythonDemo</span>
<span class="token comment"># @Project : python基础</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="Python基础"><a href="#Python基础" class="headerlink" title="Python基础"></a>Python基础</h1><h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><p>单行注释 #</p>
<p>多行注释 ‘’’…’’’</p>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p><code>变量名 = 变量值</code> </p>
<p><img src="http://image.kmoon.fun//images/202212180939700.png" alt="image-20221218093903637"></p>
<p><strong>数据才有类型 变量没有类型</strong></p>
<p>查看数据类型： type(变量名)</p>
<h2 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h2><p><img src="http://image.kmoon.fun//images/202212180941086.png" alt="image-20221218094102040"></p>
<p>命名规范</p>
<ul>
<li><p>驼峰命名法</p>
<p><img src="http://image.kmoon.fun//images/202212180941540.png" alt="image-20221218094157498"></p>
</li>
<li><p>下划线_</p>
</li>
</ul>
<h2 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h2><p><img src="http://image.kmoon.fun//images/202212180942893.png" alt="image-20221218094247849"></p>
<h2 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h2><p><img src="http://image.kmoon.fun//images/202212180943218.png" alt="image-20221218094324171"></p>
<h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><ul>
<li>算数运算符</li>
</ul>
<p><img src="http://image.kmoon.fun//images/202212180945898.png" alt="image-20221218094559803"></p>
<blockquote>
<p>注意：混合运算时，优先级顺序为： ** 高于 * / % // 高于 + - ，为了避免歧义，建议使用 () 来处理运 算符优先级。 并且，不同类型的数字在进行混合运算时，整数将会转换成浮点数进行运算。</p>
</blockquote>
<ul>
<li>赋值运算符</li>
</ul>
<p><img src="http://image.kmoon.fun//images/202212180947773.png" alt="image-20221218094724728"></p>
<p><img src="http://image.kmoon.fun//images/202212180947886.png" alt="image-20221218094735835"></p>
<ul>
<li>比较运算符</li>
</ul>
<p><img src="http://image.kmoon.fun//images/202212180947426.png" alt="image-20221218094759365"></p>
<ul>
<li>逻辑运算符</li>
</ul>
<p><img src="http://image.kmoon.fun//images/202212180948606.png" alt="image-20221218094827555"></p>
<h2 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h2><ol>
<li><p>输出</p>
<p>普通输出</p>
<p>格式化输出 %</p>
</li>
<li><p>输入</p>
<p>input()</p>
<p><img src="http://image.kmoon.fun//images/202212180951272.png" alt="image-20221218095125223"></p>
</li>
</ol>
<h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><ol>
<li><p>if</p>
</li>
<li><p>if else</p>
</li>
<li><p>elif</p>
</li>
<li><p>for</p>
</li>
<li><p>range</p>
<p>range 可以生成数字供 for 循环遍历,它可以传递三个参数，分别表示 起始、结束和步长</p>
</li>
</ol>
<h2 id="数据类型高级"><a href="#数据类型高级" class="headerlink" title="数据类型高级"></a>数据类型高级</h2><ul>
<li>字符串</li>
</ul>
<p><img src="http://image.kmoon.fun//images/202212180954651.png" alt="image-20221218095450600"></p>
<p><img src="http://image.kmoon.fun//images/202212180955114.png" alt="image-20221218095501064"></p>
<ul>
<li>列表</li>
</ul>
<p><strong>添加元素</strong></p>
<p>append会把新元素添加到列表末尾</p>
<p>insert(index, object) 在指定位置index前插入元素object</p>
<p>通过extend可以将另一个列表中的元素逐一添加到列表中</p>
<p><strong>修改元素</strong></p>
<p>是通过指定下标来访问列表元素，因此修改元素的时候，为指定的列表下标赋值即可</p>
<p><strong>查找元素</strong></p>
<p>in（存在）,如果存在那么结果为true，否则为false </p>
<p>not in（不存在），如果不存在那么结果为true，否则false</p>
<p><strong>删除元素</strong></p>
<p>del：根据下标进行删除 </p>
<p>pop：删除最后一个元素 </p>
<p>remove：根据元素的值进行删</p>
<ul>
<li>元组</li>
</ul>
<p>Python的元组与列表类似，不同之处在于元组的元素不能修改。元组使用小括号，列表使用方括号。</p>
<p>定义只有一个元素的元组，需要在唯一的元素后写一个逗号</p>
<p><img src="http://image.kmoon.fun//images/202212180959953.png" alt="image-20221218095928900"></p>
<ul>
<li>切片</li>
</ul>
<p>切片是指对操作的对象截取其中一部分的操作。字符串、列表、元组都支持切片操作。</p>
<p>切片的语法：<code>[起始:结束:步长]</code>，也可以简化使用 [起始:结束]</p>
<p>注意：选取的区间从”起始”位开始，到”结束”位的前一位结束（<strong>不包含结束位本身</strong>)，步长表示选取间隔。</p>
<ul>
<li>字典</li>
</ul>
<p><strong>查看元素</strong></p>
<p>key</p>
<p>get</p>
<p><img src="http://image.kmoon.fun//images/202212181001216.png" alt="image-20221218100136143"></p>
<p><strong>修改元素</strong></p>
<p>字典的每个元素中的数据是可以修改的，只要通过key找到，即可修改</p>
<p><strong>添加元素</strong></p>
<p>如果在使用 变量名[‘键’] = 数据 时，这个“键”在字典中，不存在，那么就会新增这个元素</p>
<p><strong>删除元素</strong></p>
<p>del:</p>
<p>del 可以通过键删除字典里的指定元素</p>
<p>del 也可以直接删除变量 删除整个字典</p>
<p>clear() 清空整个字典</p>
<p><strong>遍历</strong></p>
<p>遍历字典的key（键）</p>
<p><img src="http://image.kmoon.fun//images/202212181004783.png" alt="image-20221218100421730"></p>
<p>遍历字典的value（值）</p>
<p><img src="http://image.kmoon.fun//images/202212181004359.png" alt="image-20221218100433309"></p>
<p>遍历字典的项（元素）</p>
<p><img src="http://image.kmoon.fun//images/202212181004497.png" alt="image-20221218100443446"></p>
<p>遍历字典的key-value（键值对）</p>
<p><img src="http://image.kmoon.fun//images/202212181004633.png" alt="image-20221218100452581"></p>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>定义函数</p>
<p><img src="http://image.kmoon.fun//images/202212181005039.png" alt="image-20221218100529988"></p>
<p>调用函数</p>
<p>函数参数</p>
<p><img src="http://image.kmoon.fun//images/202212181006248.png" alt="image-20221218100639196"></p>
<blockquote>
<p>定义时小括号中的参数，用来接收参数用的，称为 “形参” </p>
<p>调用时小括号中的参数，用来传递给函数用的，称为 “实参”</p>
</blockquote>
<p>函数返回值 return</p>
<p>局部变量</p>
<blockquote>
<p>局部变量，就是在函数内部定义的变量</p>
<p>其作用范围是这个函数内部，即只能在这个函数中使用，在函数的外部是不能使用的</p>
</blockquote>
<p>全局变量</p>
<blockquote>
<p>在函数外边定义的变量叫做 全局变量 </p>
<p>全局变量能够在所有的函数中进行访问</p>
</blockquote>
<h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><ol>
<li>文件的打开与关闭</li>
</ol>
<p><strong>打开文件/创建文件</strong></p>
<p>在python，使用open函数，可以打开一个已经存在的文件，或者创建一个新文件 </p>
<p><code>open(文件路径，访问模式)</code></p>
<p><strong>文件路径</strong></p>
<p><img src="http://image.kmoon.fun//images/202212181010648.png" alt="image-20221218101033587"></p>
<p><strong>访问模式</strong></p>
<p><img src="http://image.kmoon.fun//images/202212181011706.png" alt="image-20221218101134620"></p>
<ol start="2">
<li>文件的读写</li>
</ol>
<p><strong>写数据write</strong></p>
<p>使用write()可以完成向文件写入数据</p>
<blockquote>
<p>如果文件不存在，那么创建；如果存在那么就先清空，然后写入数据</p>
</blockquote>
<p><strong>读数据read</strong></p>
<p>使用read(num)可以从文件中读取数据，num表示要从文件中读取的数据的长度（单位是字节），如果没有传入 num，那么就表示读取文件中所有的数据</p>
<blockquote>
<p>如果用open打开文件时，如果使用的”r”，那么可以省略 open(‘test.txt’)</p>
</blockquote>
<p><strong>读数据readline</strong></p>
<p>readline只用来读取一行数据</p>
<p><strong>读数据readlines</strong></p>
<p>readlines可以按照行的方式把整个文件中的内容进行一次性读取，并且返回的是一个列表，其中每一行为列表的 一个元素</p>
<ol start="3">
<li>序列化和反序列化</li>
</ol>
<blockquote>
<p>原因在于<strong>文件的写入操作不支持字典、元组、列表等对象的写入操作，因而需要先序列化后写入文件</strong>，而后读出时执行反序列化操作。</p>
</blockquote>
<p>通过文件操作，我们可以将字符串写入到一个本地文件。</p>
<p>但是，如果是一个<strong>对象</strong>(例如列表、字典、元组等)，就无法直接写入到一个文件里，需要对这个对象进行序列化，然后才能写入到文件里。</p>
<p>设计一套协议，按照某种规则，把内存中的数据转换为<strong>字节序列</strong>，保存到文件，这就是<strong>序列化</strong>，反之，从文件的字节序列恢复到内存中，就是<strong>反序列化</strong>。</p>
<blockquote>
<p>对象—》字节序列 === 序列化 </p>
</blockquote>
<blockquote>
<p>字节序列–》对象 ===反序列化</p>
</blockquote>
<p>Python中提供了JSON这个模块用来实现数据的序列化和反序列化。</p>
<p><strong>JSON模块</strong></p>
<blockquote>
<p>JSON(JavaScriptObjectNotation, JS对象简谱)是一种轻量级的数据交换标准。JSON的本质是字符串。</p>
</blockquote>
<p><strong>使用JSON实现序列化</strong></p>
<p>JSON提供了dump和dumps方法，将一个对象进行序列化。</p>
<p>dumps方法的作用是<strong>把对象转换成为字符串</strong>，它本身不具备将数据写入到文件的功能。</p>
<p><img src="http://image.kmoon.fun//images/202212181020364.png" alt="image-20221218102055300"></p>
<p>dump方法可以在将对象转换成为字符串的同时，指定一个文件对象，把转换后的字符串写入到这个文件里。</p>
<blockquote>
<p>dump方法可以接收一个文件参数，在将对象转换成为字符串的同时写入到文件里</p>
</blockquote>
<p><img src="http://image.kmoon.fun//images/202212181020026.png" alt="image-20221218102043962"></p>
<p><strong>使用JSON实现反序列化</strong></p>
<p>使用loads和load方法，可以将一个JSON字符串反序列化成为一个Python对象。</p>
<p>loads方法需要一个字符串参数，用来将一个字符串加载成为Python对象。</p>
<p><img src="http://image.kmoon.fun//images/202212181020612.png" alt="image-20221218102014553"></p>
<p>load方法可以传入一个文件对象，用来将一个文件对象里的数据加载成为Python对象。</p>
<p><img src="http://image.kmoon.fun//images/202212181020035.png" alt="image-20221218102028970"></p>
<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><ol>
<li><p>读取文件异常</p>
<p>在读取一个文件时，如果这个文件不存在，则会报出 <code>FileNotFoundError</code>错误。</p>
</li>
<li><p>try…except语句</p>
<p>try…except语句可以对代码运行过程中可能出现的异常进行处理。</p>
<p><img src="http://image.kmoon.fun//images/202212181022726.png" alt="image-20221218102249664"></p>
</li>
</ol>
<h1 id="页面结构"><a href="#页面结构" class="headerlink" title="页面结构"></a>页面结构</h1><img src="http://image.kmoon.fun//images/202212181028347.png" alt="image-20221218102849264" style="zoom:80%;">

<p>tabel 表格</p>
<p>tr 行</p>
<p>td 列</p>
<p>ul 无序列表</p>
<p>ol 有序列表</p>
<p>li 项</p>
<p>a 超链接</p>
<hr>
<h1 id="爬虫概念"><a href="#爬虫概念" class="headerlink" title="爬虫概念"></a>爬虫概念</h1><ol>
<li><p>什么是互联网爬虫</p>
<ul>
<li><p>解释1：通过一个程序，根据Url(<a href="http://www.taobao.com)进行爬取网页,获取有用信息/">http://www.taobao.com)进行爬取网页，获取有用信息</a> </p>
</li>
<li><p>解释2：使用程序模拟浏览器，去向服务器发送请求，获取响应信息</p>
</li>
</ul>
</li>
<li><p>爬虫的核心</p>
<ul>
<li>1.爬取网页：爬取整个网页 包含了网页中所有得内容 </li>
<li>2.解析数据：将网页中你得到的数据 进行解析 </li>
<li>3.难点：爬虫和反爬虫之间的博弈</li>
</ul>
</li>
<li><p>爬虫的用途</p>
<ul>
<li>数据分析/人工数据集</li>
<li>社交软件冷启动</li>
<li>舆情监控</li>
<li>竞争对手监控</li>
</ul>
</li>
<li><p>爬虫分类</p>
<p><img src="http://image.kmoon.fun//images/202212181049872.png" alt="image-20221218104922781"></p>
</li>
<li><p>反爬手段</p>
<img src="http://image.kmoon.fun//images/202212181053406.png" alt="image-20221218105314334"></li>
</ol>
<h1 id="Urllib"><a href="#Urllib" class="headerlink" title="Urllib"></a>Urllib</h1><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><p><img src="http://image.kmoon.fun//images/202212181057352.png" alt="image-20221218105722277"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 使用urllib来获取百度首页的源码</span>
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request


<span class="token comment"># (1)定义一个url  就是你要访问的地址</span>
url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com'</span>

<span class="token comment"># (2)模拟浏览器向服务器发送请求 response响应</span>
response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
	
<span class="token comment"># （3）获取响应中的页面的源码  content 内容的意思</span>
<span class="token comment"># read方法  返回的是字节形式的二进制数据</span>
<span class="token comment"># 我们要将二进制的数据转换为字符串</span>
<span class="token comment"># 二进制--》字符串  解码  decode('编码的格式')</span>
content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># （4）打印数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果<strong>不解码，获得的内容将会是二进制的格式</strong>，不利于我们的正常使用。</p>
<h2 id="1个类型6个方法"><a href="#1个类型6个方法" class="headerlink" title="1个类型6个方法"></a>1个类型6个方法</h2><p>类型; </p>
<p>response是HTTPResponse的类型</p>
<p>方法：</p>
<ul>
<li>read()	按照一个字节一个字节去读</li>
<li>read(num)	读取num个字节</li>
<li>readline()      读取一行</li>
<li>readlines()     逐行读取</li>
<li>getcode()      返回状态码</li>
<li>geturl()           返回请求网址</li>
<li>getheaders()  返回状态信息</li>
</ul>
<h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>urllib库之下载图片、音频、视频</p>
<p><code>urllib.request.urlretrieve()</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 下载网页</span>
url_page<span class="token operator">=</span><span class="token string">'http://www.baidu.com'</span>

<span class="token comment"># 参数url代表的是下载的路径  filename文件的名字</span>
<span class="token comment"># 在python中 可以变量的名字  也可以直接写值</span>
urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url_page<span class="token punctuation">,</span><span class="token string">'baidu.html'</span><span class="token punctuation">)</span>

<span class="token comment"># 下载图片</span>
url_img<span class="token operator">=</span><span class="token string">'https://img1.baidu.com/it/xxx.jpg'</span>

urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url<span class="token operator">=</span>url_img<span class="token punctuation">,</span>filename<span class="token operator">=</span><span class="token string">'lisa.jpg'</span><span class="token punctuation">)</span>

<span class="token comment"># 下载视频</span>
url_video <span class="token operator">=</span> <span class="token string">'https://vd3.bdstatic.com/xxx'</span>

urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url_video<span class="token punctuation">,</span><span class="token string">'hxekyyds.mp4'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="请求对象定制"><a href="#请求对象定制" class="headerlink" title="请求对象定制"></a>请求对象定制</h2><p>UA介绍：User Agent中文名为用户代理，简称 UA，它是一个特殊字符串头，使得服务器能够识别客户使用的操作系统 及版本、CPU 类型、浏览器及版本。</p>
<p>浏览器内核、浏览器渲染引擎、浏览器语言、浏览器插件等</p>
<p>语法：<code>request = urllib.request.Request()</code></p>
<blockquote>
<p> UA反爬</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># http/https    www.baidu.com   80/443     s      wd = 周杰伦     #</span>
<span class="token comment">#    协议             主机        端口号     路径     参数          锚点</span>

url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
<span class="token punctuation">}</span>

<span class="token comment"># 因为urlopen方法中不能存储字典 所以headers不能传递进去</span>
<span class="token comment"># 请求对象的定制</span>
<span class="token comment"># 因为参数顺序的问题 需要关键字传参</span>
request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="编解码"><a href="#编解码" class="headerlink" title="编解码"></a>编解码</h2><h3 id="1-get请求方式：urllib-parse-quote（）"><a href="#1-get请求方式：urllib-parse-quote（）" class="headerlink" title="1.get请求方式：urllib.parse.quote（）"></a>1.get请求方式：urllib.parse.quote（）</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse

<span class="token comment"># 将周杰伦三个字变成unicode编码的格式</span>
<span class="token comment"># 我们需要依赖于urllib.parse</span>
<span class="token comment"># 将中文汉字转为Unicode编码</span>
name <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span><span class="token string">'周杰伦'</span><span class="token punctuation">)</span>

url <span class="token operator">=</span> url <span class="token operator">+</span> name

request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf‐8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-get请求方式：urllib-parse-urlencode（）"><a href="#2-get请求方式：urllib-parse-urlencode（）" class="headerlink" title="2.get请求方式：urllib.parse.urlencode（）"></a>2.get请求方式：urllib.parse.urlencode（）</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse
url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com/s?'</span>
data <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'小刚'</span><span class="token punctuation">,</span>
<span class="token string">'sex'</span><span class="token punctuation">:</span><span class="token string">'男'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment"># 多个参数转Unicode编码</span>
data <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
url <span class="token operator">=</span> url <span class="token operator">+</span> data
<span class="token keyword">print</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> 

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token string">'User‐Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36'</span>
<span class="token punctuation">}</span>
request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-post请求方式"><a href="#3-post请求方式" class="headerlink" title="3.post请求方式"></a>3.post请求方式</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">eg<span class="token punctuation">:</span>百度翻译
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse

url <span class="token operator">=</span> <span class="token string">'https://fanyi.baidu.com/sug'</span>
headers <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token string">'user‐agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36'</span><span class="token punctuation">}</span>

keyword <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入您要查询的单词'</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token string">'kw'</span><span class="token punctuation">:</span>keyword
<span class="token punctuation">}</span>
<span class="token comment"># post请求的参数 必须进行编码</span>
data <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf‐8'</span><span class="token punctuation">)</span>
<span class="token comment"># post请求的参数 需要放在请求对象定制的参数中</span>
request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>

response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
<span class="token comment"># 字符串---&gt;json对象</span>
<span class="token keyword">import</span> json
obj <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="http://image.kmoon.fun//images/202212190858340.png" alt="image-20221219085811105"></p>
<ul>
<li>案例练习：百度详细翻译</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse

url <span class="token operator">=</span> <span class="token string">'https://fanyi.baidu.com/v2transapi?from=en&amp;to=zh'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'Cookie'</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxx'</span><span class="token punctuation">,</span>	<span class="token comment">#起决定因素</span>
<span class="token punctuation">}</span>
data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'from'</span><span class="token punctuation">:</span> <span class="token string">'en'</span><span class="token punctuation">,</span>
    <span class="token string">'to'</span><span class="token punctuation">:</span> <span class="token string">'zh'</span><span class="token punctuation">,</span>
    <span class="token string">'query'</span><span class="token punctuation">:</span> <span class="token string">'love'</span><span class="token punctuation">,</span>
    <span class="token string">'transtype'</span><span class="token punctuation">:</span> <span class="token string">'realtime'</span><span class="token punctuation">,</span>
    <span class="token string">'simple_means_flag'</span><span class="token punctuation">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
    <span class="token string">'sign'</span><span class="token punctuation">:</span> <span class="token string">'198772.518981'</span><span class="token punctuation">,</span>
    <span class="token string">'token'</span><span class="token punctuation">:</span> <span class="token string">'5483bfa652979b41f9c90d91f3de875d'</span><span class="token punctuation">,</span>
    <span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'common'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment"># post请求的参数  必须进行编码 并且要调用encode方法</span>
data <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># 请求对象的定制</span>
request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span> data<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>

<span class="token comment"># 模拟浏览器向服务器发送请求</span>
response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

<span class="token comment"># 获取响应的数据</span>
content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token keyword">import</span> json

obj <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Ajax的get请求"><a href="#Ajax的get请求" class="headerlink" title="Ajax的get请求"></a>Ajax的get请求</h2><ul>
<li>案例练习：豆瓣电影</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># get请求</span>
<span class="token comment"># 获取豆瓣电影的第一页的数据 并且保存起来</span>

<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

url <span class="token operator">=</span> <span class="token string">'https://movie.douban.com/j/chart/top_list?type=5&amp;interval_id=100%3A90&amp;action=&amp;start=0&amp;limit=20'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
<span class="token punctuation">}</span>

<span class="token comment"># (1) 请求对象的定制</span>
request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

<span class="token comment"># （2）获取响应的数据</span>
response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># (3) 数据下载到本地</span>
<span class="token comment"># open方法默认情况下使用的是gbk的编码  如果我们要想保存汉字 那么需要在open方法中指定编码格式为utf-8</span>
encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>
fp <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'douban.json'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>

<span class="token comment">#with open('douban1.json','w',encoding='utf-8') as fp:</span>
<span class="token comment">#    fp.write(content)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>下载豆瓣电影前10页的数据</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># （1） 请求对象的定制</span>
<span class="token comment"># （2） 获取响应的数据</span>
<span class="token comment"># （3） 下载数据</span>

<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

<span class="token keyword">def</span> <span class="token function">create_request</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span>
    base_url <span class="token operator">=</span> <span class="token string">'https://movie.douban.com/j/chart/top_list?type=5&amp;interval_id=100%3A90&amp;action=&amp;'</span>

    data <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'start'</span><span class="token punctuation">:</span><span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token string">'limit'</span><span class="token punctuation">:</span><span class="token number">20</span>
    <span class="token punctuation">}</span>
    data <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

    url <span class="token operator">=</span> base_url <span class="token operator">+</span> data

    headers <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
    <span class="token punctuation">}</span>

    request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    <span class="token keyword">return</span> request


<span class="token keyword">def</span> <span class="token function">get_content</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
    content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> content

<span class="token keyword">def</span> <span class="token function">down_load</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'douban_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.json'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">as</span> fp<span class="token punctuation">:</span>
        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>

<span class="token comment"># 程序的入口</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    start_page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入起始的页码'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    end_page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入结束的页面'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_page<span class="token punctuation">,</span>end_page<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token comment">#         每一页都有自己的请求对象的定制</span>
        request <span class="token operator">=</span> create_request<span class="token punctuation">(</span>page<span class="token punctuation">)</span>
<span class="token comment">#         获取响应的数据</span>
        content <span class="token operator">=</span> get_content<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token comment">#         下载</span>
        down_load<span class="token punctuation">(</span>page<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Ajax的post请求"><a href="#Ajax的post请求" class="headerlink" title="Ajax的post请求"></a>Ajax的post请求</h2><ul>
<li>案例：KFC官网</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse

<span class="token keyword">def</span> <span class="token function">create_request</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span>
    base_url <span class="token operator">=</span> <span class="token string">'http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx?op=cname'</span>
    data <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'cname'</span><span class="token punctuation">:</span> <span class="token string">'北京'</span><span class="token punctuation">,</span>
        <span class="token string">'pid'</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token string">'pageIndex'</span><span class="token punctuation">:</span> page<span class="token punctuation">,</span>
        <span class="token string">'pageSize'</span><span class="token punctuation">:</span> <span class="token string">'10'</span>
    <span class="token punctuation">}</span>

    data <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>base_url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> request

<span class="token keyword">def</span> <span class="token function">get_content</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
    content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> content

<span class="token keyword">def</span> <span class="token function">down_load</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'kfc_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.json'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">as</span> fp<span class="token punctuation">:</span>
        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    start_page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入起始页码'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    end_page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入结束页码'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_page<span class="token punctuation">,</span>end_page<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 请求对象的定制</span>
        request <span class="token operator">=</span> create_request<span class="token punctuation">(</span>page<span class="token punctuation">)</span>
        <span class="token comment"># 获取网页源码</span>
        content <span class="token operator">=</span> get_content<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        <span class="token comment"># 下载</span>
        down_load<span class="token punctuation">(</span>page<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="URLError-HTTPError"><a href="#URLError-HTTPError" class="headerlink" title="URLError\HTTPError"></a>URLError\HTTPError</h2><p>简介:</p>
<ul>
<li><p>1.HTTPError类是URLError类的<strong>子类</strong> </p>
</li>
<li><p>2.导入的包urllib.error.HTTPError     urllib.error.URLError </p>
</li>
<li><p>3.http错误：http错误是针对浏览器无法连接到服务器而增加出来的错误提示。引导并告诉浏览者该页是哪里出 了问题。 </p>
</li>
<li><p>4.通过urllib发送请求的时候，有可能会发送失败，这个时候如果想让你的代码更加的健壮，可以通过try‐ except进行捕获异常，异常有两类，URLError\HTTPError</p>
</li>
</ul>
<p><strong>try…except语句</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>error

<span class="token comment"># url = 'https://blog.csdn.net/sulixu/article/details/1198189491'</span>

url <span class="token operator">=</span> <span class="token string">'http://www.doudan1111.com'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
<span class="token punctuation">}</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>

    response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

    content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
<span class="token keyword">except</span> urllib<span class="token punctuation">.</span>error<span class="token punctuation">.</span>HTTPError<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'系统正在升级'</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> urllib<span class="token punctuation">.</span>error<span class="token punctuation">.</span>URLError<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'我都说了 系统正在升级'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="cookie登录"><a href="#cookie登录" class="headerlink" title="cookie登录"></a>cookie登录</h2><p>使用案例： 1.微博cookie登陆 </p>
<p>作业：qq空间的爬取</p>
<ul>
<li>适用的场景：数据采集的时候 需要<strong>绕过登陆</strong> 然后进入到某个页</li>
<li>个人信息页面是utf-8  但是还报错了编码错误  因为并没有进入到个人信息页面 而是跳转到了登陆页面 那么登陆页面不是utf-8  所以报错</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

url <span class="token operator">=</span> <span class="token string">'https://weibo.cn/6451491586/info'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token string">'accept-language'</span><span class="token punctuation">:</span> <span class="token string">'zh-CN,zh;q=0.9'</span><span class="token punctuation">,</span>
<span class="token comment"># cookie中携带着你的登陆信息   如果有登陆之后的cookie  那么我们就可以携带着cookie进入到任何页面</span>
<span class="token string">'cookie'</span><span class="token punctuation">:</span> <span class="token string">'xxxxxx'</span><span class="token punctuation">,</span>
<span class="token comment"># referer  判断当前路径是不是由上一个路径进来的    一般情况下 是做图片防盗链</span>
<span class="token string">'referer'</span><span class="token punctuation">:</span> <span class="token string">'https://weibo.cn/'</span><span class="token punctuation">,</span>

<span class="token string">'user-agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment"># 请求对象的定制</span>
request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
<span class="token comment"># 模拟浏览器向服务器发送请求</span>
response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token comment"># 获取响应的数据</span>
content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据保存到本地</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'weibo.html'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">as</span> fp<span class="token punctuation">:</span>
    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Handler处理器"><a href="#Handler处理器" class="headerlink" title="Handler处理器"></a>Handler处理器</h2><ul>
<li>为什么要学习handler？</li>
</ul>
<p>urllib.request.urlopen(url) 不能定制请求头 </p>
<p>urllib.request.Request(url,headers,data) 可以定制请求头 </p>
<p><strong>Handler</strong> </p>
<p>定制更高级的请求头（随着业务逻辑的复杂 请求对象的定制已经满足不了我们的需求（<strong>动态cookie和代理 不能使用请求对象的定制</strong>）</p>
<blockquote>
<p>1.获取handler对象<br>handler = urllib.request.HTTPHandler()</p>
<p>2.获取opener对象</p>
<p>opener = urllib.request.build_opener(handler)</p>
<p>3.调用open方法</p>
<p>response = opener.open(request)</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token string">'User ‐ Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla / 5.0(Windows NT 10.0;Win64;x64) AppleWebKit / 537.36(KHTML,likeGecko) Chrome / 74.0.3729.169Safari / 537.36'</span>
<span class="token punctuation">}</span>

request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
<span class="token comment"># handler build_handler open</span>
<span class="token comment"># 1.获取handler对象</span>
handler <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>HTTPHandler<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 2.获取opener对象</span>
opener <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>build_opener<span class="token punctuation">(</span>handler<span class="token punctuation">)</span>
<span class="token comment"># 3.调用open方法</span>
response <span class="token operator">=</span> opener<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf‐8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="代理服务器"><a href="#代理服务器" class="headerlink" title="代理服务器"></a>代理服务器</h2><ol>
<li><p>代理的常用功能? </p>
<ul>
<li><p><strong>1.突破自身IP访问限制，访问国外站点。</strong> </p>
</li>
<li><p><strong>2.访问一些单位或团体内部资源</strong> </p>
<p>扩展：某大学FTP(前提是该代理地址在该资源的允许访问范围之内)，使用教育网内地址段免费代理服务器，就可以用于对教育网开放的各类FTP下载上传，以及各类资料查询共享等服务。 </p>
</li>
<li><p><strong>3.提高访问速度</strong> </p>
<p>扩展：通常代理服务器都设置一个较大的<strong>硬盘缓冲区</strong>，当有外界的信息通过时，同时也将其保存到缓冲区中，当其他用户再访问相同的信息时， 则直接由缓冲区中取出信息，传给用户，以提高访问速度。 </p>
</li>
<li><p><strong>4.隐藏真实IP</strong> </p>
<p>扩展：上网者也可以通过这种方法隐藏自己的IP，免受攻击。</p>
</li>
</ul>
</li>
<li><p>代码配置代理 </p>
<p>创建Reuqest对象 </p>
<p>创建<strong>ProxyHandler</strong>对象 </p>
<p>用handler对象创建opener对象 </p>
<p>使用opener.open函数发送请求</p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com/s?wd=ip'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
<span class="token punctuation">}</span>

<span class="token comment"># 请求对象的定制</span>
request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>headers<span class="token operator">=</span> headers<span class="token punctuation">)</span>

<span class="token comment"># 模拟浏览器访问服务器</span>
<span class="token comment"># response = urllib.request.urlopen(request)</span>

proxies <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'http'</span><span class="token punctuation">:</span><span class="token string">'IP:Port'</span>
<span class="token punctuation">}</span>
<span class="token comment"># handler  build_opener  open</span>
handler <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>ProxyHandler<span class="token punctuation">(</span>proxies <span class="token operator">=</span> proxies<span class="token punctuation">)</span>

opener <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>build_opener<span class="token punctuation">(</span>handler<span class="token punctuation">)</span>

response <span class="token operator">=</span> opener<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>

<span class="token comment"># 获取响应的信息</span>
content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># 保存</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'daili.html'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">as</span> fp<span class="token punctuation">:</span>
    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>扩展：1.代理池 2.快代理</p>
<h2 id="代理池"><a href="#代理池" class="headerlink" title="代理池"></a>代理池</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">proxies_pool <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string">'http'</span><span class="token punctuation">:</span><span class="token string">'118.24.219.151:16817'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">'http'</span><span class="token punctuation">:</span><span class="token string">'118.24.219.151:16817'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>

<span class="token keyword">import</span> random

proxies <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>proxies_pool<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="解析"><a href="#解析" class="headerlink" title="解析"></a>解析</h2><h3 id="1-xpath"><a href="#1-xpath" class="headerlink" title="1. xpath"></a>1. xpath</h3><blockquote>
<p>xpath是一门在XML文档中查找信息的语言。xpath可用来在XML文档中对元素和属性进行遍历。</p>
</blockquote>
<ul>
<li><p>xpath使用</p>
<p>注意：提前安装xpath插件 </p>
<p>（1）打开chrome浏览器 </p>
<p>（2）点击右上角小圆点</p>
<p>（3）更多工具 </p>
<p>（4）扩展程序 </p>
<p>（5）拖拽xpath插件到扩展程序中 </p>
<p>（6）如果crx文件失效，需要将后缀修改zip </p>
<p>（7）再次拖拽 </p>
<p>（8）关闭浏览器重新打开 </p>
<p>（9）ctrl + shift + x </p>
<p>（10）出现小黑框 </p>
<p>1.安装lxml库 <code>pip install lxml</code></p>
<p>2.导入lxml.etree <code>from lxml import etree</code> </p>
<p>3.etree.parse() 解析本地文件 <code>html_tree=etree.parse('XX.html')</code> </p>
<p>4.etree.HTML() 服务器响应文件 </p>
<p><code>html_tree = etree.HTML(response.read().decode('utf‐8')</code> </p>
<p>5.html_tree.xpath(xpath路径)</p>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token comment"># xpath解析</span>
<span class="token comment">#（1）本地文件                                       </span>
<span class="token comment"># etree.parse</span>
<span class="token comment">#（2）服务器响应的数据  </span>
<span class="token comment"># response.read().decode('utf-8') *****   etree.HTML()</span>

<span class="token comment"># xpath解析本地文件</span>
tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">'xxx.html'</span><span class="token punctuation">)</span>

<span class="token comment">#tree.xpath('xpath路径')</span>
tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'xpath路径'</span><span class="token punctuation">)</span>
<span class="token comment"># 查找ul下面的li</span>
<span class="token comment"># li_list = tree.xpath('//body/ul/li')</span>


<span class="token comment"># 查找所有有id的属性的li标签</span>
<span class="token comment"># text()获取标签中的内容</span>
li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul/li[@id]/text()'</span><span class="token punctuation">)</span>

<span class="token comment"># 找到id为l1的li标签  注意引号的问题</span>
li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul/li[@id="l1"]/text()'</span><span class="token punctuation">)</span>

<span class="token comment"># 查找到id为l1的li标签的class的属性值</span>
li <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul/li[@id="l1"]/@class'</span><span class="token punctuation">)</span>

<span class="token comment"># 查询id中包含l的li标签</span>
li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul/li[contains(@id,"l")]/text()'</span><span class="token punctuation">)</span>

<span class="token comment"># 查询id的值以l开头的li标签</span>
li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul/li[starts-with(@id,"c")]/text()'</span><span class="token punctuation">)</span>

<span class="token comment">#查询id为l1和class为c1的</span>
li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul/li[@id="l1" and @class="c1"]/text()'</span><span class="token punctuation">)</span>
<span class="token comment">#查询id为l1或l2的</span>
li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul/li[@id="l1"]/text() | //ul/li[@id="l2"]/text()'</span><span class="token punctuation">)</span>

<span class="token comment"># 判断列表的长度</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>li_list<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>li_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>xpath基本语法</strong></p>
<p><img src="http://image.kmoon.fun//images/202212191425429.png" alt="image-20221219142500176"></p>
<p>应用案例： </p>
<ul>
<li>获取百度网站的百度一下</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># （1） 获取网页的源码</span>
<span class="token comment"># （2） 解析   解析的服务器响应的文件  etree.HTML</span>
<span class="token comment"># (3)  打印</span>

<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
<span class="token punctuation">}</span>

<span class="token comment"># 请求对象的定制</span>
request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>

<span class="token comment"># 模拟浏览器访问服务器</span>
response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

<span class="token comment"># 获取网页源码</span>
content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># 解析网页源码 来获取我们想要的数据</span>
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token comment"># 解析服务器响应的文件</span>
tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>content<span class="token punctuation">)</span>

<span class="token comment"># 获取想要的数据  xpath的返回值是一个列表类型的数据</span>
result <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//input[@id="su"]/@value'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>站长素材图片抓取并且下载（<a href="http://sc.chinaz.com/tupian/shuaigetupian.html%EF%BC%89--%E3%80%8B%E6%87%92%E5%8A%A0%E8%BD%BD">http://sc.chinaz.com/tupian/shuaigetupian.html）--》懒加载</a></li>
</ul>
<p><strong>重点：</strong></p>
<blockquote>
<p>xpath在浏览器中可以获取对象，而python代码中无法获取对象的原因是浏览器会自动更正我们的xpath代码，而lxml库却不会这么做，解决方法是编写xpath代码时必须按照网页源代码编写，而不是F12后的dom结构</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 需求 下载的前十页的图片</span>
<span class="token comment"># https://sc.chinaz.com/tupian/qinglvtupian_page.html</span>

<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token keyword">def</span> <span class="token function">create_request</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string">'https://sc.chinaz.com/tupian/qinglvtupian.html'</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>page <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">'https://sc.chinaz.com/tupian/qinglvtupian_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.html'</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>
    <span class="token keyword">return</span> request

<span class="token keyword">def</span> <span class="token function">get_content</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
    content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> content

<span class="token keyword">def</span> <span class="token function">down_load</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token comment">#     下载图片</span>
    <span class="token comment"># urllib.request.urlretrieve('图片地址','文件的名字')</span>
    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>content<span class="token punctuation">)</span>

    name_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="container"]//img/@alt'</span><span class="token punctuation">)</span>

    <span class="token comment"># 一般设计图片的网站都会进行懒加载</span>
    src_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="container"]//img/@data-original'</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>name_list<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>src_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>src_list<span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>name_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        name <span class="token operator">=</span> name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        src <span class="token operator">=</span> src_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        url <span class="token operator">=</span> <span class="token string">'https:'</span> <span class="token operator">+</span> src
        urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>filename<span class="token operator">=</span><span class="token string">'./loveImg/'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'.jpg'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    start_page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入起始页码'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    end_page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入结束页码'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_page<span class="token punctuation">,</span>end_page<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># (1) 请求对象的定制</span>
        request <span class="token operator">=</span> create_request<span class="token punctuation">(</span>page<span class="token punctuation">)</span>
        <span class="token comment"># （2）获取网页的源码</span>
        content <span class="token operator">=</span> get_content<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        <span class="token comment"># （3）下载</span>
        down_load<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-Jsonpath"><a href="#2-Jsonpath" class="headerlink" title="2. Jsonpath"></a>2. Jsonpath</h3><blockquote>
<p>jsonpath是一种简单的方法来提取给定JSON文档的部分内容。</p>
</blockquote>
<p>解析json数据，只能解析本地json文件</p>
<ul>
<li><p>安装及使用方式</p>
<p>pip安装： <code>pip install jsonpath</code> </p>
<p>jsonpath的使用： </p>
<p><code>obj = json.load(open('json文件', 'r', encoding='utf‐8'))</code> </p>
<p><code>ret = jsonpath.jsonpath(obj, 'jsonpath语法')</code></p>
</li>
</ul>
<p>JSONPath语法元素和对应XPath元素的对比:</p>
<table>
<thead>
<tr>
<th><strong>XPath</strong></th>
<th><strong>JSONPath</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td>/</td>
<td>$</td>
<td>表示根元素</td>
</tr>
<tr>
<td>.</td>
<td>@</td>
<td>当前元素</td>
</tr>
<tr>
<td>/</td>
<td>. or []</td>
<td>子元素</td>
</tr>
<tr>
<td>..</td>
<td>n/a</td>
<td>父元素</td>
</tr>
<tr>
<td>//</td>
<td>..</td>
<td>递归下降，JSONPath是从E4X借鉴的。</td>
</tr>
<tr>
<td>*</td>
<td>*</td>
<td>通配符，表示所有的元素</td>
</tr>
<tr>
<td>@</td>
<td>n/a</td>
<td>属性访问字符</td>
</tr>
<tr>
<td>[]</td>
<td>[]</td>
<td>子元素操作符</td>
</tr>
<tr>
<td>|</td>
<td>[,]</td>
<td>连接操作符在XPath 结果合并其它结点集合。JSONP允许name或者数组索引。</td>
</tr>
<tr>
<td>n/a</td>
<td>[start:ends:tep]</td>
<td>数组分割操作从ES4借鉴。</td>
</tr>
<tr>
<td>[]</td>
<td>?()</td>
<td>应用过滤表示式</td>
</tr>
<tr>
<td>n/a</td>
<td>()</td>
<td>脚本表达式，使用在脚本引擎下面。</td>
</tr>
<tr>
<td>()</td>
<td>n/a</td>
<td>Xpath分组</td>
</tr>
</tbody></table>
<p>教程链接：（<a href="http://blog.csdn.net/luxideyao/article/details/77802389%EF%BC%89">http://blog.csdn.net/luxideyao/article/details/77802389）</a></p>
<p>eg.</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">"store"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"book"</span><span class="token operator">:</span> <span class="token punctuation">[</span> 
      <span class="token punctuation">{</span> <span class="token property">"category"</span><span class="token operator">:</span> <span class="token string">"reference"</span><span class="token punctuation">,</span>
        <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"Nigel Rees"</span><span class="token punctuation">,</span>
        <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Sayings of the Century"</span><span class="token punctuation">,</span>
        <span class="token property">"price"</span><span class="token operator">:</span> <span class="token number">8.95</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token property">"category"</span><span class="token operator">:</span> <span class="token string">"fiction"</span><span class="token punctuation">,</span>
        <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"Evelyn Waugh"</span><span class="token punctuation">,</span>
        <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Sword of Honour"</span><span class="token punctuation">,</span>
        <span class="token property">"price"</span><span class="token operator">:</span> <span class="token number">12.99</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token property">"category"</span><span class="token operator">:</span> <span class="token string">"fiction"</span><span class="token punctuation">,</span>
        <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"Herman Melville"</span><span class="token punctuation">,</span>
        <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Moby Dick"</span><span class="token punctuation">,</span>
        <span class="token property">"isbn"</span><span class="token operator">:</span> <span class="token string">"0-553-21311-3"</span><span class="token punctuation">,</span>
        <span class="token property">"price"</span><span class="token operator">:</span> <span class="token number">8.99</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token property">"category"</span><span class="token operator">:</span> <span class="token string">"fiction"</span><span class="token punctuation">,</span>
        <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"J. R. R. Tolkien"</span><span class="token punctuation">,</span>
        <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"The Lord of the Rings"</span><span class="token punctuation">,</span>
        <span class="token property">"isbn"</span><span class="token operator">:</span> <span class="token string">"0-395-19395-8"</span><span class="token punctuation">,</span>
        <span class="token property">"price"</span><span class="token operator">:</span> <span class="token number">22.99</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"bicycle"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"color"</span><span class="token operator">:</span> <span class="token string">"red"</span><span class="token punctuation">,</span>
      <span class="token property">"price"</span><span class="token operator">:</span> <span class="token number">19.95</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="http://image.kmoon.fun//images/202212211412621.png" alt="image-20221221141234588"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">
<span class="token keyword">import</span> json
<span class="token keyword">import</span> jsonpath


obj <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'073_尚硅谷_爬虫_解析_jsonpath.json'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 书店所有书的作者</span>
author_list <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$.store.book[*].author'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>author_list<span class="token punctuation">)</span>

<span class="token comment"># 所有的作者</span>
author_list <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$..author'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>author_list<span class="token punctuation">)</span>

<span class="token comment"># store下面的所有的元素</span>
tag_list <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$.store.*'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>tag_list<span class="token punctuation">)</span>

<span class="token comment"># store里面所有东西的price</span>
price_list <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$.store..price'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>price_list<span class="token punctuation">)</span>

<span class="token comment"># 第三个书</span>
book <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$..book[2]'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span>

<span class="token comment"># 最后一本书</span>
book <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$..book[(@.length-1)]'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span>

<span class="token comment"># 	前面的两本书</span>
book_list <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$..book[0,1]'</span><span class="token punctuation">)</span>
book_list <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$..book[:2]'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>book_list<span class="token punctuation">)</span>

<span class="token comment"># 条件过滤需要在（）的前面添加一个？</span>
<span class="token comment"># 	 过滤出所有的包含isbn的书。</span>
book_list <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$..book[?(@.isbn)]'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>book_list<span class="token punctuation">)</span>


<span class="token comment"># 哪本书超过了10块钱</span>
book_list <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$..book[?(@.price&gt;10)]'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>book_list<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<ul>
<li>案例练习:淘票票</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

url <span class="token operator">=</span> <span class="token string">'https://dianying.taobao.com/cityAction.json?activityId&amp;_ksTS=1629789477003_137&amp;jsoncallback=jsonp138&amp;action=cityAction&amp;n_s=new&amp;event_submit_doGetAllRegion=true'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'accept'</span><span class="token punctuation">:</span> <span class="token string">'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01'</span><span class="token punctuation">,</span>
    <span class="token comment"># 'accept-encoding': 'gzip, deflate, br',</span>
    <span class="token string">'accept-language'</span><span class="token punctuation">:</span> <span class="token string">'zh-CN,zh;q=0.9'</span><span class="token punctuation">,</span>
    <span class="token string">'cookie'</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxx'</span><span class="token punctuation">,</span>
    <span class="token string">'referer'</span><span class="token punctuation">:</span> <span class="token string">'https://dianying.taobao.com/'</span><span class="token punctuation">,</span>
    <span class="token string">'user-agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span><span class="token punctuation">,</span>
    <span class="token string">'x-requested-with'</span><span class="token punctuation">:</span> <span class="token string">'XMLHttpRequest'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>

response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># split 切割</span>
content <span class="token operator">=</span> content<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment"># 写入本地json文件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'filename.json'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">as</span> fp<span class="token punctuation">:</span>
    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>

<span class="token keyword">import</span> json
<span class="token keyword">import</span> jsonpath

<span class="token comment"># 解析本地json文件</span>
obj <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'filename.json'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 提取json数据中的regionName属性</span>
city_list <span class="token operator">=</span> jsonpath<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'$..regionName'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>city_list<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>作业： </p>
<p>1.股票信息提取（<a href="http://quote.stockstar.com/%EF%BC%89">http://quote.stockstar.com/）</a> </p>
<p>2.boos直聘 </p>
<p>3.中华英才 </p>
<p>4.汽车之家</p>
<h3 id="3-BeautifulSoup"><a href="#3-BeautifulSoup" class="headerlink" title="3. BeautifulSoup"></a>3. BeautifulSoup</h3><blockquote>
<p>BS4全称是Beatiful Soup，它提供一些简单的、python式的函数用来处理导航、搜索、修改分析树等功能。</p>
</blockquote>
<ul>
<li><strong>基本简介</strong></li>
</ul>
<ol>
<li><p>BeautifulSoup简称： bs4 </p>
</li>
<li><p>什么是BeatifulSoup？</p>
<p>BeautifulSoup，和<strong>lxml</strong>一样，是一个<strong>html的解析器</strong>，主要功能也是<strong>解析和提取数据</strong> </p>
</li>
<li><p>优缺点？</p>
</li>
</ol>
<p>​	缺点：效率没有lxml的效率高 </p>
<p>​	优点：接口设计人性化，使用方便</p>
<ul>
<li><strong>安装以及创建</strong></li>
</ul>
<ol>
<li>安装</li>
</ol>
<p><code>pip install bs4</code> </p>
<ol start="2">
<li>导入</li>
</ol>
<p><code>from bs4 import BeautifulSoup</code> </p>
<ol start="3">
<li>创建对象</li>
</ol>
<p>服务器响应的文件生成对象 </p>
<p><code>soup = BeautifulSoup(response.read().decode(), 'lxml')</code> </p>
<p>本地文件生成对象 </p>
<p><code>soup = BeautifulSoup(open('1.html',encoding='utf-8'), 'lxml')</code> </p>
<blockquote>
<p><strong>注意：默认打开文件的编码格式gbk,所以需要指定打开编码格式</strong></p>
</blockquote>
<ul>
<li><strong>节点定位</strong></li>
</ul>
<ol>
<li>根据<strong>标签名</strong>查找节点</li>
</ol>
<p>soup.a 【注】只能找到第一个符合条件的a </p>
<p>soup.a.name 返回标签名</p>
<p>soup.a.attrs  返回标签属性和属性值</p>
<ol start="2">
<li>函数</li>
</ol>
<p>(1). <strong>find</strong>(返回一个对象) </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">find<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>：只找到第一个a标签 

find<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span>tittle<span class="token operator">=</span><span class="token string">'a2'</span><span class="token punctuation">)</span>  根据tittle的值找第一个a

find<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span>class_<span class="token operator">=</span><span class="token string">'a2'</span><span class="token punctuation">)</span>  根<span class="token keyword">class</span>的值找第一个a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>注意class标签需要添加下划线_</p>
</blockquote>
<p>(2). <strong>find_all</strong>(返回一个列表) </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">find_all<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> 查找到所有的a 

find_all<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'span'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 返回所有的a和span 

find_all<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> limit<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> 只找前两个a <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(3). <strong>select</strong>(根据选择器得到多个节点对象 返回列表)【<strong>推荐</strong>】 </p>
<ol>
<li><strong>element</strong></li>
</ol>
<p>eg:p </p>
<ol start="2">
<li>**<code>.class</code> **</li>
</ol>
<p>可以通过<code>.</code>代表class  这种操作叫做类选择器</p>
<p>eg:<code>.firstname</code> </p>
<ol start="3">
<li><strong><code>#id</code></strong></li>
</ol>
<p>eg:<code>#firstname</code> </p>
<ol start="4">
<li><p><strong>属性选择器</strong> </p>
<p>通过属性来寻找对应的标签</p>
</li>
</ol>
<p>[attribute] </p>
<p>eg:<code>li = soup.select('li[class]')</code> </p>
<p>[attribute=value] </p>
<p>eg:<code>li = soup.select('li[class="value"]')</code> </p>
<ol start="5">
<li><strong>层级选择器</strong></li>
</ol>
<p>element element  后代选择器</p>
<p>div p </p>
<p>element&gt;element 子代选择器（&gt;第一级）</p>
<p>div&gt;p </p>
<p>element,element 所有级</p>
<p>div,p </p>
<p>eg:<code>soup = soup.select('a,span')</code> </p>
<ul>
<li><strong>节点信息</strong></li>
</ul>
<p>(1).获取节点内容：适用于标签中嵌套标签的结构 obj.string </p>
<p><strong>obj.get_text()【推荐】</strong> </p>
<blockquote>
<p>如果标签对象中 只有内容 那么string和get_text()都可以使用<br>如果标签对象中 除了内容还有标签 那么string就获取不到数据 而get_text()是可以获取数据</p>
</blockquote>
<p>(2).节点的属性 </p>
<p>tag.name 获取标签名 </p>
<p>eg:tag = find(‘li) </p>
<p>print(tag.name) </p>
<p>tag.attrs将属性值作为一个<strong>字典</strong>返回 </p>
<p>(3).获取节点属性 </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">**</span>obj<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span>【常用】<span class="token operator">**</span> 

obj<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span> 

obj<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>应用实例： </p>
<p>1.股票信息提取（<a href="http://quote.stockstar.com/%EF%BC%89">http://quote.stockstar.com/）</a> </p>
<p>2.中华英才网-旧版 </p>
<p>3 .腾讯公司招聘需求抓取（<a href="https://hr.tencent.com/index.php%EF%BC%89">https://hr.tencent.com/index.php）</a></p>
<ul>
<li>案例练习：星巴克</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

url <span class="token operator">=</span> <span class="token string">'https://www.starbucks.com.cn/menu/'</span>

response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>content<span class="token punctuation">,</span><span class="token string">'lxml'</span><span class="token punctuation">)</span>

<span class="token comment"># xpath语法：</span>
<span class="token comment"># //ul[@class="grid padded-3 product"]//strong/text()</span>
name_list <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'ul[class="grid padded-3 product"] strong'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> name <span class="token keyword">in</span> name_list<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>拓展：下载星巴克菜单图片</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

url <span class="token operator">=</span> <span class="token string">'https://www.starbucks.com.cn/menu/'</span>

response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

content <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>


<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>content<span class="token punctuation">,</span><span class="token string">'lxml'</span><span class="token punctuation">)</span>

<span class="token comment"># //ul[@class="grid padded-3 product"]//strong/text()</span>
url_list <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'div[class="preview circle"]'</span><span class="token punctuation">)</span>
name_list <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'ul[class="grid padded-3 product"] strong'</span><span class="token punctuation">)</span>
tittle<span class="token operator">=</span><span class="token string">"https://www.starbucks.com.cn"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    urls<span class="token operator">=</span>tittle<span class="token operator">+</span>url_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'"'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    name<span class="token operator">=</span>name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token builtin">str</span><span class="token operator">=</span><span class="token string">"/"</span>
    <span class="token keyword">if</span> <span class="token builtin">str</span> <span class="token keyword">in</span> name<span class="token punctuation">:</span>
        name<span class="token operator">=</span>name<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>urls<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url<span class="token operator">=</span>urls<span class="token punctuation">,</span> filename<span class="token operator">=</span><span class="token string">'./XBKImg/'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'.jpg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="Selenium"><a href="#Selenium" class="headerlink" title="Selenium"></a>Selenium</h1><h2 id="Selenium-1"><a href="#Selenium-1" class="headerlink" title="Selenium"></a>Selenium</h2><h3 id="1-什么是selenium"><a href="#1-什么是selenium" class="headerlink" title="1.什么是selenium"></a>1.什么是selenium</h3><blockquote>
<p>selenium是一个自动化测试工具,支持Firefox,Chrome等众多浏览器 在爬虫中的应用主要是用来解决JS渲染的问题。</p>
</blockquote>
<p>（1）Selenium是一个用于Web应用程序测试的工具。 （2）Selenium 测试直接运行在浏览器中，就像真正的用户在操作一样。 </p>
<p>（3）支持通过各种<strong>driver</strong>（FirfoxDriver,IternetExplorerDriver，OperaDriver，ChromeDriver）驱动真实浏览器完成测试。 </p>
<p>（4）selenium也是支持无界面浏览器操作的。 </p>
<h3 id="2-为什么使用selenium"><a href="#2-为什么使用selenium" class="headerlink" title="2.为什么使用selenium"></a>2.为什么使用selenium</h3><p>模拟浏览器功能，自动执行网页中的js代码，实现动态加载 </p>
<h3 id="3-安装selenium"><a href="#3-安装selenium" class="headerlink" title="3.安装selenium"></a>3.安装selenium</h3><p>（1）操作谷歌浏览器驱动下载地址 <a href="http://chromedriver.storage.googleapis.com/index.html">http://chromedriver.storage.googleapis.com/index.html</a> </p>
<p>（2）谷歌驱动和谷歌浏览器版本之间的映射表 <a href="http://blog.csdn.net/huilan_same/article/details/51896672">http://blog.csdn.net/huilan_same/article/details/51896672</a> </p>
<p>（3）查看谷歌浏览器版本 </p>
<p>谷歌浏览器右上角‐‐&gt;帮助‐‐&gt;关于 </p>
<p>（4）pip install selenium </p>
<h3 id="4-使用步骤"><a href="#4-使用步骤" class="headerlink" title="4.使用步骤"></a><strong>4.使用步骤</strong></h3><p>（1）导入：</p>
<p><code>from selenium import webdriver</code> </p>
<p>（2）创建浏览器操作对象： </p>
<p><code>path = 浏览器驱动文件路径</code> </p>
<p><code>browser = webdriver.Chrome(path)</code> </p>
<p>（3）访问网址 </p>
<p><code>url = 要访问的网址 browser.get(url)</code> </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># （1）导入selenium</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># (2) 创建浏览器操作对象</span>

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token string">"chromedriver.exe"</span><span class="token punctuation">)</span>

<span class="token comment"># （3）访问网站</span>
<span class="token comment"># url = 'https://www.baidu.com'</span>
<span class="token comment">#</span>
<span class="token comment"># browser.get(url)</span>

url <span class="token operator">=</span> <span class="token string">'https://www.jd.com/'</span>

browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># page_source获取网页源码</span>
content <span class="token operator">=</span> browser<span class="token punctuation">.</span>page_source
<span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>注意：</p>
<p>1.需要安装Chrome浏览器</p>
<p>2.闪退的话需要安装3.3.1版本 <code>pip install selenium==3.3.1</code></p>
</blockquote>
<h4 id="4‐1：元素定位"><a href="#4‐1：元素定位" class="headerlink" title="4‐1：元素定位"></a>4‐1：元素定位</h4><p>自动化要做的就是模拟鼠标和键盘来操作来操作这些元素，点击、输入等等。操作这些元素前首先 要找到它们，WebDriver提供很多定位元素的方法 </p>
<p><strong>方法：</strong> </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span><span class="token punctuation">.</span>find_element_by_id 

button <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'su'</span><span class="token punctuation">)</span> 

<span class="token number">2</span><span class="token punctuation">.</span>find_elements_by_name 

name <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">'wd'</span><span class="token punctuation">)</span> 

<span class="token number">3</span><span class="token punctuation">.</span>find_elements_by_xpath 

xpath1 <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_elements_by_xpath<span class="token punctuation">(</span><span class="token string">'//input[@id="su"]'</span><span class="token punctuation">)</span> 

<span class="token number">4</span><span class="token punctuation">.</span>find_elements_by_tag_name 

names <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_elements_by_tag_name<span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span> 

<span class="token number">5</span><span class="token punctuation">.</span>find_elements_by_css_selector 

my_input <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_elements_by_css_selector<span class="token punctuation">(</span><span class="token string">'#kw'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 

<span class="token number">6</span><span class="token punctuation">.</span>find_elements_by_link_text 

browser<span class="token punctuation">.</span>find_element_by_link_text<span class="token punctuation">(</span><span class="token string">"新闻"</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>eg.</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

path <span class="token operator">=</span> <span class="token string">'chromedriver.exe'</span>
browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com'</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 元素定位</span>

<span class="token comment"># 根据id来找到对象</span>
button <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'su'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span>

<span class="token comment"># 根据标签属性的属性值来获取对象的</span>
button <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">'wd'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span>

<span class="token comment"># 根据标签的名字来获取对象</span>
button <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_elements_by_tag_name<span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span>

<span class="token comment"># 根据xpath语句来获取对象</span>
button <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_elements_by_xpath<span class="token punctuation">(</span><span class="token string">'//input[@id="su"]'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span>

<span class="token comment"># 使用的bs4的语法来获取对象</span>
button <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_elements_by_css_selector<span class="token punctuation">(</span><span class="token string">'#su'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span>

button <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_elements_by_link_text<span class="token punctuation">(</span><span class="token string">'新闻'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="4‐2-访问元素信息"><a href="#4‐2-访问元素信息" class="headerlink" title="4‐2:访问元素信息"></a>4‐2:访问元素信息</h4><p>获取元素<strong>属性</strong> .get_attribute(‘class’) </p>
<p>获取元素<strong>文本</strong> .text </p>
<p>获取<strong>标签名</strong> .tag_name </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

path <span class="token operator">=</span> <span class="token string">'chromedriver.exe'</span>
browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com'</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token builtin">input</span> <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'su'</span><span class="token punctuation">)</span>

<span class="token comment"># 获取标签的属性</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 获取标签的名字</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">.</span>tag_name<span class="token punctuation">)</span>
<span class="token comment"># 获取元素文本</span>
a <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_link_text<span class="token punctuation">(</span><span class="token string">'新闻'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="4‐3-交互"><a href="#4‐3-交互" class="headerlink" title="4‐3:交互"></a>4‐3:交互</h4><p>点击:click() </p>
<p>输入:send_keys() </p>
<p>后退操作:browser.back() </p>
<p>前进操作:browser.forword() </p>
<p>模拟JS滚动: </p>
<p><code>js='document.documentElement.scrollTop=100000'</code> </p>
<p><code>browser.execute_script(js)</code>  <strong>执行js代码</strong></p>
<p>获取网页代码：page_source </p>
<p>退出：browser.quit()</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 创建浏览器对象</span>
path <span class="token operator">=</span> <span class="token string">'chromedriver.exe'</span>
browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

<span class="token comment"># url</span>
url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com'</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 延时</span>
<span class="token keyword">import</span> time
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 获取文本框对象</span>
<span class="token builtin">input</span> <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>

<span class="token comment"># 在文本框中输入周杰伦</span>
<span class="token builtin">input</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'周杰伦'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 获取百度一下按钮</span>
button <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'su'</span><span class="token punctuation">)</span>
<span class="token comment"># 点击按钮</span>
button<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 滑到底部</span>
js_bottom <span class="token operator">=</span> <span class="token string">'document.documentElement.scrollTop=100000'</span>
browser<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span>js_bottom<span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 获取下一页按钮(xpath语法)</span>
<span class="token builtin">next</span> <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//a[@class="n"]'</span><span class="token punctuation">)</span>

<span class="token comment"># 点击下一页</span>
<span class="token builtin">next</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 回到上一页</span>
browser<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 回去</span>
browser<span class="token punctuation">.</span>forward<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># 退出</span>
browser<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Phantomjs"><a href="#Phantomjs" class="headerlink" title="Phantomjs"></a>Phantomjs</h2><p>1.什么是Phantomjs？<br>（1）是一个<strong>无界面的浏览器</strong></p>
<p>（2）支持页面元素查找，js的执行等</p>
<p>（3）由于不进行css和gui渲染，运行效率要比真实的浏览器要快很多</p>
<p>2.如何使用Phantomjs？</p>
<p>（1）获取PhantomJS.exe文件路径path</p>
<p>（2）browser = webdriver.PhantomJS(path)</p>
<p>（3）browser.get(url)</p>
<p>扩展：</p>
<p><strong>保存屏幕快照</strong>:<code>browser.save_screenshot('baidu.png')</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

path <span class="token operator">=</span> <span class="token string">'phantomjs.exe'</span>

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>PhantomJS<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com'</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

browser<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span><span class="token string">'baidu.png'</span><span class="token punctuation">)</span>

<span class="token keyword">import</span> time
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token builtin">input</span> <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
<span class="token builtin">input</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'昆凌'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

browser<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span><span class="token string">'kunling.png'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Chrome-handless"><a href="#Chrome-handless" class="headerlink" title="Chrome handless"></a>Chrome handless</h2><blockquote>
<p>Chrome-headless 模式， Google 针对 Chrome 浏览器59版新增加的一种模式，可以让你不打开UI界面的情况下使用 Chrome 浏览器，所以运行效果与 Chrome 保持完美一致。</p>
</blockquote>
<h3 id="1-系统要求"><a href="#1-系统要求" class="headerlink" title="1.系统要求"></a>1.系统要求</h3><p>Chrome<br>        Unix\Linux 系统需要 chrome &gt;= 59<br>        Windows 系统需要 chrome &gt;= 60<br>Python3.6以上<br>Selenium==3.4.*<br>ChromeDriver==2.31以上</p>
<h3 id="2-配置"><a href="#2-配置" class="headerlink" title="2.配置"></a>2.配置</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>options <span class="token keyword">import</span> Options

chrome_options <span class="token operator">=</span> Options<span class="token punctuation">(</span><span class="token punctuation">)</span>
chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'‐‐headless'</span><span class="token punctuation">)</span>
chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'‐‐disable‐gpu'</span><span class="token punctuation">)</span>

<span class="token comment"># Chrome浏览器路径</span>
path <span class="token operator">=</span> <span class="token string">r'C:\Program Files\Google\Chrome\Application\chrome.exe'</span>
chrome_options<span class="token punctuation">.</span>binary_location <span class="token operator">=</span> path

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>chrome_options<span class="token operator">=</span>chrome_options<span class="token punctuation">)</span>

browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://www.baidu.com/'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="3-封装调用"><a href="#3-封装调用" class="headerlink" title="3.封装调用"></a>3.封装调用</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>options <span class="token keyword">import</span> Options

<span class="token comment"># 函数封装</span>
<span class="token keyword">def</span> <span class="token function">share_browser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#初始化</span>
	chrome_options <span class="token operator">=</span> Options<span class="token punctuation">(</span><span class="token punctuation">)</span>
	chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'‐‐headless'</span><span class="token punctuation">)</span>
	chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'‐‐disable‐gpu'</span><span class="token punctuation">)</span>
	<span class="token comment">#这个路径是谷歌浏览器的路径</span>
	path <span class="token operator">=</span> <span class="token string">r'C:\Program Files 	(x86)\Google\Chrome\Application\chrome.exe'</span>
	chrome_options<span class="token punctuation">.</span>binary_location <span class="token operator">=</span> path
	browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>chrome_options<span class="token operator">=</span>chrome_options<span class="token punctuation">)</span>
	<span class="token keyword">return</span> browser

<span class="token comment"># 封装调用</span>
browser <span class="token operator">=</span> share_browser<span class="token punctuation">(</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://www.baidu.com/'</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span><span class="token string">'handless1.png'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="Requests"><a href="#Requests" class="headerlink" title="Requests"></a>Requests</h1><h2 id="基本使用-1"><a href="#基本使用-1" class="headerlink" title="基本使用"></a>基本使用</h2><h3 id="1-文档"><a href="#1-文档" class="headerlink" title="1.文档"></a>1.文档</h3><p>官方文档</p>
<p><a href="https://cn.python-requests.org/zh_CN/latest/">https://cn.python-requests.org/zh_CN/latest/</a></p>
<p>快速上手</p>
<p><a href="https://cn.python-requests.org/zh_CN/latest/user/quickstart.html">https://cn.python-requests.org/zh_CN/latest/user/quickstart.html</a></p>
<h3 id="2-安装"><a href="#2-安装" class="headerlink" title="2.安装"></a>2.安装</h3><p><code>pip install requests</code></p>
<h3 id="3-类型-属性"><a href="#3-类型-属性" class="headerlink" title="3.类型 属性"></a>3.类型 属性</h3><p>类型 				   ：models.Response</p>
<p>r.text 				   : 获取网站源码</p>
<p>r.encoding 		  ：访问或定制编码方式</p>
<p>r.url 				      ：获取请求的url</p>
<p>r.content 			 ：响应的字节类型</p>
<p>r.status_code      ：响应的状态码</p>
<p>r.headers 			 ：响应的头信息</p>
<p>基本使用</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com'</span>

response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">)</span>

<span class="token comment"># 一个类型和六个属性</span>
<span class="token comment"># Response类型</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 设置响应的编码格式</span>
response<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>

<span class="token comment"># 以字符串的形式来返回了网页的源码</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

<span class="token comment"># 返回一个url地址</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>url<span class="token punctuation">)</span>

<span class="token comment"># 返回的是二进制的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>

<span class="token comment"># 返回响应的状态码</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>

<span class="token comment"># 返回的是响应头</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p> <strong>对比urllib、requests</strong></p>
</blockquote>
<p>urllib</p>
<p>  (1) 一个类型以及<strong>六个方法</strong></p>
<p>（2）get请求</p>
<p>（3）post请求   百度翻译</p>
<p>（4）ajax的get请求</p>
<p>（5）ajax的post请求</p>
<p>（6）cookie登陆 微博</p>
<p>（7）代理</p>
<p>requests</p>
<p>  (1)一个类型以及<strong>六个属性</strong></p>
<p>（2）get请求</p>
<p>（3）post请求</p>
<p>（4）代理</p>
<p>（5）cookie  验证码</p>
<h2 id="get请求"><a href="#get请求" class="headerlink" title="get请求"></a>get请求</h2><h3 id="1-requests-get"><a href="#1-requests-get" class="headerlink" title="1.requests.get()"></a>1.requests.get()</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/s'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
<span class="token punctuation">}</span>

data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'wd'</span><span class="token punctuation">:</span><span class="token string">'北京'</span>
<span class="token punctuation">}</span>

<span class="token comment"># 参数列表</span>
<span class="token comment"># url  请求资源路径</span>
<span class="token comment"># params 参数</span>
<span class="token comment"># kwargs 字典</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>params<span class="token operator">=</span>data<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

content <span class="token operator">=</span> response<span class="token punctuation">.</span>text
<span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="2-参数定制"><a href="#2-参数定制" class="headerlink" title="2.参数定制"></a>2.参数定制</h3><p><strong>总结：</strong><br>（1）参数使用<strong>params</strong>传递<br>（2）参数<strong>无需urlencode编码</strong><br>（3）不需要请求对象的定制<br>（4）请求资源路径中的<strong>？</strong>可以加也可以不加</p>
<h2 id="post请求"><a href="#post请求" class="headerlink" title="post请求"></a>post请求</h2><h3 id="requests-post"><a href="#requests-post" class="headerlink" title="requests.post()"></a>requests.post()</h3><blockquote>
<p>get和post区别？ </p>
<p>1： get请求的参数名字是params </p>
<p>post请求的参数的名字是data </p>
<p>2： 请求资源路径后面可以不加? </p>
<p>3： 不需要手动编解码 </p>
<p>4： 不需要做请求对象的定制</p>
</blockquote>
<p>example:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">'https://fanyi.baidu.com/sug'</span>

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
<span class="token punctuation">}</span>

data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'kw'</span><span class="token punctuation">:</span> <span class="token string">'eye'</span>
<span class="token punctuation">}</span>

<span class="token comment"># url 请求地址</span>
<span class="token comment"># data 请求参数</span>
<span class="token comment"># json</span>
<span class="token comment"># kwargs 字典</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

content <span class="token operator">=</span>response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>总结</strong>：<br>（1）post请求不需要编解码<br>（2）post请求的参数是<strong>data</strong><br>（3）不需要请求对象的定制</p>
<h2 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h2><h3 id="proxy定制"><a href="#proxy定制" class="headerlink" title="proxy定制"></a>proxy定制</h3><p>在请求中设置proxies参数  </p>
<p>参数类型是一个字典类型</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com/s?'</span>
headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'Cookie'</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxxx'</span><span class="token punctuation">,</span>
    <span class="token string">'user‐agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/65.0.3325.181Safari/537.36'</span>
<span class="token punctuation">}</span>
data <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token string">'wd'</span><span class="token punctuation">:</span><span class="token string">'ip'</span>
<span class="token punctuation">}</span>
proxy <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token string">'http'</span><span class="token punctuation">:</span><span class="token string">'219.149.59.250:9797'</span>
<span class="token punctuation">}</span>
r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>params<span class="token operator">=</span>data<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>proxies<span class="token operator">=</span>proxy<span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'proxy.html'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf‐8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>
    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="cookie登录-1"><a href="#cookie登录-1" class="headerlink" title="cookie登录"></a>cookie登录</h2><ul>
<li>案例练习：cookie登录古诗文网</li>
</ul>
<p>需求：通过登陆  然后进入到主页面</p>
<p>通过找登陆接口发现 登陆的时候需要的参数很多</p>
<p>观察到_VIEWSTATE、__VIEWSTATEGENERATOR、code是一个可以变化的量</p>
<p><img src="http://image.kmoon.fun//images/202212220940853.png" alt="image-20221222094013606"></p>
<p>难点:<br>(1)_VIEWSTATE   __VIEWSTATEGENERATOR<br>一般情况看不到的数据 都是在页面的源码中</p>
<p>观察到这两个数据在页面的源码中 </p>
<p><img src="http://image.kmoon.fun//images/202212220944822.png" alt="image-20221222094329840">所以需要获取页面的源码 然后进行解析就可以获取</p>
<p>(2)验证码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

<span class="token comment"># 登陆页面url地址</span>
url <span class="token operator">=</span> <span class="token string">'https://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx'</span>
headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'</span>
<span class="token punctuation">}</span>

<span class="token comment"># 获取页面的源码</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>
content <span class="token operator">=</span> response<span class="token punctuation">.</span>text

<span class="token comment"># 解析页面源码  获取_VIEWSTATE   __VIEWSTATEGENERATOR</span>
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>content<span class="token punctuation">,</span><span class="token string">'lxml'</span><span class="token punctuation">)</span>

<span class="token comment"># 获取_VIEWSTATE</span>
viewstate <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'#__VIEWSTATE'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">)</span>

<span class="token comment"># 获取__VIEWSTATEGENERATOR</span>
viewstategenerator <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'#__VIEWSTATEGENERATOR'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">)</span>

<span class="token comment"># 获取验证码图片</span>
code <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'#imgCode'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span>
code_url <span class="token operator">=</span> <span class="token string">'https://so.gushiwen.cn'</span> <span class="token operator">+</span> code

<span class="token comment"># 其实验证码图片路径是固定的</span>

<span class="token comment"># 有坑（请求一次验证码图片后会刷新一次 验证码后后面登录请求的code不是同一个）</span>
<span class="token comment"># import urllib.request</span>
<span class="token comment"># urllib.request.urlretrieve(url=code_url,filename='code.jpg')</span>


<span class="token comment"># requests里面有一个方法 session（）  </span>
通过session的返回值 就能使用请求变成一个对象

session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 验证码的url的内容</span>
response_code <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>code_url<span class="token punctuation">)</span>
<span class="token comment"># 注意此时要使用二进制数据  不能使用text 因为我们要使用的是图片的下载</span>
content_code <span class="token operator">=</span> response_code<span class="token punctuation">.</span>content

<span class="token comment"># wb的模式就是将二进制数据写入到文件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'code.jpg'</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token keyword">as</span> fp<span class="token punctuation">:</span>
    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content_code<span class="token punctuation">)</span>

<span class="token comment"># 获取了验证码的图片之后 下载到本地 然后观察验证码  观察之后 然后在控制台输入这个验证码 就可以将这个值给</span>
<span class="token comment"># code的参数 就可以登陆</span>

code_name <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入你的验证码'</span><span class="token punctuation">)</span>
data_post <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'__VIEWSTATE'</span><span class="token punctuation">:</span> viewstate<span class="token punctuation">,</span>
    <span class="token string">'__VIEWSTATEGENERATOR'</span><span class="token punctuation">:</span> viewstategenerator<span class="token punctuation">,</span>
    <span class="token string">'from'</span><span class="token punctuation">:</span> <span class="token string">'http://so.gushiwen.cn/user/collect.aspx'</span><span class="token punctuation">,</span>
    <span class="token string">'email'</span><span class="token punctuation">:</span> <span class="token string">'3453863492@qq.com'</span><span class="token punctuation">,</span>
    <span class="token string">'pwd'</span><span class="token punctuation">:</span> <span class="token string">'password'</span><span class="token punctuation">,</span>
    <span class="token string">'code'</span><span class="token punctuation">:</span> code_name<span class="token punctuation">,</span>
    <span class="token string">'denglu'</span><span class="token punctuation">:</span> <span class="token string">'登录'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

response_post <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> headers<span class="token punctuation">,</span> data <span class="token operator">=</span> data_post<span class="token punctuation">)</span>

content_post <span class="token operator">=</span> response_post<span class="token punctuation">.</span>text
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'gushiwen.html'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span> <span class="token string">' utf-8'</span><span class="token punctuation">)</span><span class="token keyword">as</span> fp<span class="token punctuation">:</span>
    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content_post<span class="token punctuation">)</span>
    
<span class="token comment"># 难点</span>
<span class="token comment"># （1） 隐藏域</span>
<span class="token comment"># （2） 验证码</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="超级鹰平台"><a href="#超级鹰平台" class="headerlink" title="超级鹰平台"></a>超级鹰平台</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># coding:utf-8</span>

<span class="token keyword">import</span> requests
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5

<span class="token keyword">class</span> <span class="token class-name">Chaojiying_Client</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> soft_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>username <span class="token operator">=</span> username
        password <span class="token operator">=</span>  password<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>password <span class="token operator">=</span> md5<span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>soft_id <span class="token operator">=</span> soft_id
        self<span class="token punctuation">.</span>base_params <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'user'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
            <span class="token string">'pass2'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>password<span class="token punctuation">,</span>
            <span class="token string">'softid'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>soft_id<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>headers <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'Keep-Alive'</span><span class="token punctuation">,</span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>

    <span class="token keyword">def</span> <span class="token function">PostPic</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> im<span class="token punctuation">,</span> codetype<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        im: 图片字节
        codetype: 题目类型 参考 http://www.chaojiying.com/price.html
        """</span>
        params <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'codetype'</span><span class="token punctuation">:</span> codetype<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        params<span class="token punctuation">.</span>update<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base_params<span class="token punctuation">)</span>
        files <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'userfile'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'ccc.jpg'</span><span class="token punctuation">,</span> im<span class="token punctuation">)</span><span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://upload.chaojiying.net/Upload/Processing.php'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>params<span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">,</span> headers<span class="token operator">=</span>self<span class="token punctuation">.</span>headers<span class="token punctuation">)</span>
        <span class="token keyword">return</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">PostPic_base64</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> base64_str<span class="token punctuation">,</span> codetype<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        im: 图片字节
        codetype: 题目类型 参考 http://www.chaojiying.com/price.html
        """</span>
        params <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'codetype'</span><span class="token punctuation">:</span> codetype<span class="token punctuation">,</span>
            <span class="token string">'file_base64'</span><span class="token punctuation">:</span>base64_str
        <span class="token punctuation">}</span>
        params<span class="token punctuation">.</span>update<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base_params<span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://upload.chaojiying.net/Upload/Processing.php'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>params<span class="token punctuation">,</span> headers<span class="token operator">=</span>self<span class="token punctuation">.</span>headers<span class="token punctuation">)</span>
        <span class="token keyword">return</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">ReportError</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> im_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        im_id:报错题目的图片ID
        """</span>
        params <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'id'</span><span class="token punctuation">:</span> im_id<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        params<span class="token punctuation">.</span>update<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base_params<span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://upload.chaojiying.net/Upload/ReportError.php'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>params<span class="token punctuation">,</span> headers<span class="token operator">=</span>self<span class="token punctuation">.</span>headers<span class="token punctuation">)</span>
        <span class="token keyword">return</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    chaojiying <span class="token operator">=</span> Chaojiying_Client<span class="token punctuation">(</span><span class="token string">'超级鹰用户名'</span><span class="token punctuation">,</span> <span class="token string">'超级鹰用户名的密码'</span><span class="token punctuation">,</span> <span class="token string">'96001'</span><span class="token punctuation">)</span>	<span class="token comment">#用户中心&gt;&gt;软件ID 生成一个替换 96001</span>
    im <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'a.jpg'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>													<span class="token comment">#本地图片文件路径 来替换 a.jpg 有时WIN系统须要//</span>
    <span class="token keyword">print</span> chaojiying<span class="token punctuation">.</span>PostPic<span class="token punctuation">(</span>im<span class="token punctuation">,</span> <span class="token number">1902</span><span class="token punctuation">)</span>												<span class="token comment">#1902 验证码类型  官方网站&gt;&gt;价格体系 3.4+版 print 后要加()</span>
    <span class="token comment">#print chaojiying.PostPic(base64_str, 1902)  #此处为传入 base64代码</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>作业：</p>
<p>国家统计局（<a href="http://www.stats.gov.cn/tjsj/tjbz/tjyqhdmhcxhfdm/2017/%EF%BC%89%E5%85%B1%E8%AE%A168%E4%B8%87%E6%9D%A1%E6%95%B0">http://www.stats.gov.cn/tjsj/tjbz/tjyqhdmhcxhfdm/2017/）共计68万条数</a></p>
<h1 id="Scrapy"><a href="#Scrapy" class="headerlink" title="Scrapy"></a>Scrapy</h1><blockquote>
<p> Scrapy是一个为了爬取网站数据，提取结构性数据而编写的应用框架。可以应用在包括数据挖掘，信息处理或存储历史数据等一系列的程序中。</p>
<p> Scrapy是适用于Python的一个快速、高层次的屏幕抓取和web抓取框架，用于抓取web站点并从页面中提取结构化的数据。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试</p>
</blockquote>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><code>pip install scrapy</code></p>
<h2 id="基本使用-2"><a href="#基本使用-2" class="headerlink" title="基本使用"></a>基本使用</h2><h3 id="1-创建scrapy项目"><a href="#1-创建scrapy项目" class="headerlink" title="1.创建scrapy项目"></a>1.创建scrapy项目</h3><p>终端输入  <code>scrapy startproject 项目名称</code></p>
<p>项目名称包含中文 不能使用数字开头</p>
<h3 id="2-项目组成"><a href="#2-项目组成" class="headerlink" title="2.项目组成"></a>2.项目组成</h3><p><img src="http://image.kmoon.fun//images/202212221051066.png" alt="image-20221222105147762"></p>
<p><img src="http://image.kmoon.fun//images/202212221109594.png" alt="image-20221222110936434"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">项目名字
    项目名字
        spiders文件夹 （存储的是爬虫文件）
            init
            自定义的爬虫文件    核心功能文件
        init
        items        定义数据结构的地方 爬取的数据都包含哪些
        middleware   中间件    代理
        pipelines    管道   用来处理下载的数据
        settings     配置文件    robots协议  ua定义等<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>1️⃣ spiders</p>
<p>spiders可以理解为代表了我们人的操作，我们在操作scrapy的时候，实际上就是以spiders的身份在操作，初始的url是我们定义的。</p>
<p>2️⃣ 引擎</p>
<p>引擎是scrapy框架的中枢，从图中可以看出，引擎与所有的其他组件交互，并且交互大多带有指令性的操作，可以理解成一个指挥官。</p>
<p>3️⃣ 调度器</p>
<p>调度器，顾名思义，它是用来做调度的，简单的说就是它会把所有请求的url放入一个队列中，每一次会从队列中取出一个url，这个过程叫做调度。</p>
<p>4️⃣ 下载器</p>
<p>下载器，是用来下载数据的，它下载的是原始数据，可以理解为网页源码，这些源数据通过引擎再次交给我们用户spiders做进一步解析处理。(下载器沟通因特网，数据来源也是因特网)</p>
<p>5️⃣ 管道</p>
<p>管道的工作是下载图片、文件，它的工作与调度器下载源数据不同，它下载的是经过解析后的具体的图片、文件等数据。</p>
<p>1️⃣ Spiders文件夹</p>
<p>这文件夹我们不陌生，因为每一次新建scrapy爬虫项目后，我们都需要终端进入Spiders文件夹，生产爬虫文件。在Spiders文件夹下，又有两个文件，一个是_init_.py文件，一个是tc.py。<em>init</em>.py文件是我们创建项目时默认生成的一个py文件，我们用不到这个py文件，因此我们可以忽略它，另一个tc.py文件是我们爬虫的核心文件，后续的大部分代码都会写入这个文件，因此它是至关重要的py文件。</p>
<p>2️⃣<em>init</em>.py文件</p>
<p>它和上面提到的Spiders文件夹下的_init_.py一样，都是不被使用的py文件，无需理会。</p>
<p>3️⃣ items.py文件</p>
<p>这文件定义了数据结构，这里的数据结构与算法中的数据结构不同，它指的是爬虫目标数据的数据组成结构，例如我们需要获取目标网页的图片和图片的名称，那么此时我们的数据组成结构就定义为 图片、图片名称。后续会专门安排对scrapy框架定义数据结构的学习。</p>
<p>4️⃣ middleware.py文件</p>
<p>这py文件包含了scrapy项目的一些中间构件，例如代理、请求方式、执行等等，它对于项目来说是重要的，但对于我们爬虫基础学习来说，可以暂时不考虑更改它的内容。</p>
<p>5️⃣ pipelines.py文件</p>
<p>这是我们之前在工作原理中提到的scrapy框架中的管道文件，管道的作用是执行一些文件的下载，例如图片等，后续会安排对scrapy框架管道的学习，那时会专门研究这个py文件。</p>
<p>6️⃣ settings.py文件</p>
<p>这文件是整个scrapy项目的配置文件，里面是很多参数的设置，我们会偶尔设计到修改该文件中的部分参数，例如下一部分提到的ROBOTS协议限制，就需要进入该文件解除该限制，否则将无法实现爬取。</p>
<h3 id="3-创建爬虫文件"><a href="#3-创建爬虫文件" class="headerlink" title="3.创建爬虫文件"></a>3.创建爬虫文件</h3><p>要在spiders文件夹中取创建爬虫文件</p>
<p>执行 </p>
<p><code>scrapy genspider 爬虫文件名 要爬取的网页</code>scrapy genspider baidu <a href="http://www.baidu.com/">www.baidu.com</a></p>
<p>一般情况下不需要添加http协议</p>
<p><img src="http://image.kmoon.fun//images/202212221108805.png" alt="image-20221222110832624"></p>
<p><strong>response的属性和方法</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">response<span class="token punctuation">.</span>text   获取的是响应的字符串
response<span class="token punctuation">.</span>body   获取的是二进制数据

response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>  可以直接是xpath方法来解析response中的内容
response<span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>   提取seletor对象的data属性值
response<span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span> 提取seletor列表的第一个数据<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="4-运行爬虫文件"><a href="#4-运行爬虫文件" class="headerlink" title="4.运行爬虫文件"></a>4.运行爬虫文件</h3><p><code>scrapy crawl 爬虫文件名</code></p>
<p>修改settings.py是否遵守robots.txt协议 默认为True</p>
<blockquote>
<p>robots协议也叫robots.txt，是一种存放于网站根目录下的ASCII编码的文本文件，它通常告诉网络搜索引擎的漫游器（又称网络蜘蛛），此网站中的哪些内容是不应被搜索引擎的漫游器获取的，哪些是可以被漫游器获取的。</p>
</blockquote>
<p><img src="http://image.kmoon.fun//images/202212221109461.png" alt="image-20221222110900283"></p>
<h3 id="5-架构组成"><a href="#5-架构组成" class="headerlink" title="5.架构组成"></a>5.架构组成</h3><p>✳️ allowed_domains：这是scrapy框架中规定爬取的url的范围，简单地说就是，我们只能在这个参数定义的url的范围下获取数据，一旦数据超出范围，那么我们的请求将会失效。</p>
<p>✴️ start_urls：这是scrapy框架起始访问的url，也即在最初向这个url的位置发起请求。</p>
<ul>
<li>案例练习：汽车之家</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> scrapy

<span class="token keyword">class</span> <span class="token class-name">CarSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'car'</span>
    allowed_domains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://car.autohome.com.cn/price/brand-15.html'</span><span class="token punctuation">]</span>
    <span class="token comment"># 注意如果你的请求的接口是html为结尾的  那么是不需要加/的</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://car.autohome.com.cn/price/brand-15.html'</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        name_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="main-title"]/a/text()'</span><span class="token punctuation">)</span>
        price_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="main-lever"]//span/span/text()'</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>name_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            name <span class="token operator">=</span> name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>
            price <span class="token operator">=</span> price_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>scrapy架构组成</p>
<p><img src="http://image.kmoon.fun//images/202212221237610.png" alt="image-20221222123729385"></p>
<h3 id="6-工作原理"><a href="#6-工作原理" class="headerlink" title="6.工作原理"></a>6.工作原理</h3><p><img src="http://image.kmoon.fun//images/202212221238475.png" alt="image-20221222123855315"></p>
<p><img src="http://image.kmoon.fun//images/202212221242922.png" alt="image-20221222124252739"></p>
<p><img src="http://image.kmoon.fun//images/202212221619820.jpeg" alt="img"></p>
<h2 id="scrapyshell"><a href="#scrapyshell" class="headerlink" title="scrapyshell"></a>scrapyshell</h2><h3 id="1-什么是scrapy-shell"><a href="#1-什么是scrapy-shell" class="headerlink" title="1.什么是scrapy shell"></a>1.什么是scrapy shell</h3><p>scrapy终端是一个交互终端，供您在未启动spider的情况下尝试及调试您的爬取代码。其本意是用来测试提取数据的代码，不过您可以将其作为正常的python终端，在上面测试任何的python代码。</p>
<p>该终端是用来测试xpath或css表达式，查看他们的工作方式及从爬取的网页中提取的数据。在编写您的spider时，该终端提供了交互性能测试您的表达式代码的功能，免去了每次修改后运行spider的麻烦。</p>
<p>一旦熟悉了scrapy终端后，您会发现其在开发和调试spider时发挥了巨大的作用</p>
<h3 id="2-安装ipython"><a href="#2-安装ipython" class="headerlink" title="2.安装ipython"></a>2.安装ipython</h3><p>pip install ipython</p>
<p>ipython终端与其他相比更为强大，提供智能的自动补全，高亮输出及其他特性。</p>
<p><img src="http://image.kmoon.fun//images/202212221253624.png" alt="image-20221222125315435"></p>
<h3 id="3-应用"><a href="#3-应用" class="headerlink" title="3.应用"></a>3.应用</h3><p>进入到scrapy shell的终端 ：</p>
<p>直接在window的终端中输入scrapy shell 域名</p>
<p>如果想看到一些高亮 或者 自动补全  那么可以安装ipython</p>
<p><code>scrapy shell www.baidu.com</code></p>
<p><img src="http://image.kmoon.fun//images/202212221257544.png" alt="image-20221222125758361"></p>
<h2 id="yield"><a href="#yield" class="headerlink" title="yield"></a>yield</h2><p>1.带有yield的函数不再是一个普通函数，而是一个生成器函数generator，可用于迭代</p>
<p>2.yield是一个类似return的关键字，迭代一次遇到yield时就返回yield后面（右边）的值。重点是：下一次迭代时，从上一次迭代遇到的yield后面的代码（下一行）开始执行。</p>
<p>3.简要理解：yield就是return返回一个值，并且记住这个返回的位置，下次迭代就从这个位置后（下一行）开始</p>
<ul>
<li><strong>案例练习：当当网</strong></li>
</ul>
<p><strong>yield</strong></p>
<p><strong>管道封装</strong></p>
<p><strong>多条管道下载</strong></p>
<p><strong>多页数据下载</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># items.py</span>

<span class="token keyword">import</span> scrapy

<span class="token keyword">class</span> <span class="token class-name">ScrapyDangdang095Item</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># define the fields for your item here like:</span>
    <span class="token comment"># name = scrapy.Field()</span>
    <span class="token comment"># 通俗的说就是你要下载的数据都有什么</span>

    <span class="token comment"># 图片</span>
    src <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 名字</span>
    name <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 价格</span>
    price <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> scrapy
<span class="token keyword">from</span> scrapy_dangdang_095<span class="token punctuation">.</span>items <span class="token keyword">import</span> ScrapyDangdang095Item

<span class="token keyword">class</span> <span class="token class-name">DangSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'dang'</span>
    <span class="token comment"># 如果是多页下载的话 那么必须要调整的是allowed_domains的范围 一般情况下只写域名</span>
    allowed_domains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'category.dangdang.com'</span><span class="token punctuation">]</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'http://category.dangdang.com/cp01.01.02.00.00.00.html'</span><span class="token punctuation">]</span>


    base_url <span class="token operator">=</span> <span class="token string">'http://category.dangdang.com/pg'</span>
    page <span class="token operator">=</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token comment"># pipelines 下载数据</span>
<span class="token comment"># items     定义数据结构的</span>
<span class="token comment">#   src = //ul[@id="component_59"]/li//img/@src</span>
<span class="token comment">#   alt = //ul[@id="component_59"]/li//img/@alt</span>
<span class="token comment">#   price = //ul[@id="component_59"]/li//p[@class="price"]/span[1]/text()</span>
<span class="token comment"># 所有的seletor的对象 都可以再次调用xpath方法</span>
        li_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul[@id="component_59"]/li'</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
            src <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//img/@data-original'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># 第一张图片和其他的图片的标签的属性是不一样的</span>
            <span class="token comment"># 第一张图片的src是可以使用的  其他的图片的地址是data-original</span>
            <span class="token keyword">if</span> src<span class="token punctuation">:</span>
                src <span class="token operator">=</span> src
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                src <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//img/@src'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>

            name <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//img/@alt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
            price <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//p[@class="price"]/span[1]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>

            book <span class="token operator">=</span> ScrapyDangdang095Item<span class="token punctuation">(</span>src<span class="token operator">=</span>src<span class="token punctuation">,</span>name<span class="token operator">=</span>name<span class="token punctuation">,</span>price<span class="token operator">=</span>price<span class="token punctuation">)</span>

            <span class="token comment"># 获取一个book就将book交给pipelines</span>
            <span class="token keyword">yield</span> book<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># settings.py</span>

<span class="token comment"># Configure item pipelines</span>
<span class="token comment"># See https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span>
ITEM_PIPELINES <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token comment">#  管道可以有很多个  那么管道是有优先级的  优先级的范围是1到1000   值越小优先级越高</span>
   <span class="token string">'scrapy_dangdang_095.pipelines.ScrapyDangdang095Pipeline'</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>

<span class="token comment">#    DangDangDownloadPipeline</span>
   <span class="token string">'scrapy_dangdang_095.pipelines.DangDangDownloadPipeline'</span><span class="token punctuation">:</span><span class="token number">301</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># pipelines.py</span>

<span class="token comment"># 如果想使用管道的话 那么就必须在settings中开启管道</span>
<span class="token keyword">class</span> <span class="token class-name">ScrapyDangdang095Pipeline</span><span class="token punctuation">:</span>
    
    <span class="token comment"># 在爬虫文件开始的之前就执行的一个方法</span>
    <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>fp <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'book.json'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

    <span class="token comment"># item就是yield后面的book对象</span>
    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token comment"># 以下这种模式不推荐  因为每传递过来一个对象 那么就打开一次文件  对文件的操作过于频繁</span>
        <span class="token comment"># # (1) write方法必须要写一个字符串 而不能是其他的对象</span>
        <span class="token comment"># # (2) w模式 会每一个对象都打开一次文件 覆盖之前的内容</span>
        <span class="token comment"># with open('book.json','a',encoding='utf-8')as fp:</span>
        <span class="token comment">#     fp.write(str(item))</span>

        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> item

    <span class="token comment"># 在爬虫文件执行完之后  执行的方法</span>
    <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>多条管道同时下载</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># pipelines.py</span>

<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

<span class="token comment"># 多条管道开启</span>
<span class="token comment">#    (1) 定义管道类</span>
<span class="token comment">#   （2） 在settings中开启管道</span>
<span class="token comment"># 'scrapy_dangdang_095.pipelines.DangDangDownloadPipeline':301</span>
<span class="token keyword">class</span> <span class="token class-name">DangDangDownloadPipeline</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">'http:'</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span>
        filename <span class="token operator">=</span> <span class="token string">'./books/'</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.jpg'</span>

        urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> filename<span class="token operator">=</span> filename<span class="token punctuation">)</span>
        <span class="token keyword">return</span> item<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>多页数据下载</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">DangSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'dang'</span>
    <span class="token comment"># 如果是多页下载的话 那么必须要调整的是allowed_domains的范围 一般情况下只写域名</span>
    allowed_domains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'category.dangdang.com'</span><span class="token punctuation">]</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'http://category.dangdang.com/cp01.01.02.00.00.00.html'</span><span class="token punctuation">]</span>

    base_url <span class="token operator">=</span> <span class="token string">'http://category.dangdang.com/pg'</span>
    page <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># 每一页的爬取的业务逻辑全都是一样的，所以我们只需要将执行的那个页的请求再次调用parse方法就可以了</span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>page <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>page <span class="token operator">=</span> self<span class="token punctuation">.</span>page <span class="token operator">+</span> <span class="token number">1</span>
        url <span class="token operator">=</span> self<span class="token punctuation">.</span>base_url <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>page<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'-cp01.01.02.00.00.00.html'</span>

<span class="token comment">#  怎么去调用parse方法</span>
<span class="token comment">#  scrapy.Request就是scrpay的get请求</span>
<span class="token comment">#  url就是请求地址</span>
<span class="token comment">#  callback是你要执行的那个函数  注意不需要加（）</span>
		<span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>案例练习：电影天堂</strong></li>
</ul>
<p><strong>多级页面情况</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> scrapy

<span class="token keyword">from</span> scrapy_movie_099<span class="token punctuation">.</span>items <span class="token keyword">import</span> ScrapyMovie099Item

<span class="token keyword">class</span> <span class="token class-name">MvSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'mv'</span>
    allowed_domains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'www.dytt8.net'</span><span class="token punctuation">]</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://www.dytt8.net/html/gndy/china/index.html'</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token comment"># 要第一个的名字 和 第二页的图片</span>
        a_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="co_content8"]//td[2]//a[2]'</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> a <span class="token keyword">in</span> a_list<span class="token punctuation">:</span>
            <span class="token comment"># 获取第一页的name 和 要点击的链接</span>
            name <span class="token operator">=</span> a<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
            href <span class="token operator">=</span> a<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./@href'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># 第二页的地址是</span>
            url <span class="token operator">=</span> <span class="token string">'https://www.dytt8.net'</span> <span class="token operator">+</span> href

            <span class="token comment"># 对第二页的链接发起访问</span>
            <span class="token keyword">yield</span>  scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse_second<span class="token punctuation">,</span>meta<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span>name<span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">parse_second</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 注意 如果拿不到数据的情况下  一定检查xpath语法是否正确</span>
        src <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@id="Zoom"]//img/@src'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 接受到请求的那个meta参数的值</span>
        name <span class="token operator">=</span> response<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>

        movie <span class="token operator">=</span> ScrapyMovie099Item<span class="token punctuation">(</span>src<span class="token operator">=</span>src<span class="token punctuation">,</span>name<span class="token operator">=</span>name<span class="token punctuation">)</span>

        <span class="token keyword">yield</span> movie<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<p><strong>总结</strong>：</p>
<p>首先，我们需要定义数据结构</p>
<p>其次，我们需要封装管道</p>
<p>接下来，我们需要在settings配置文件中修改管道配置</p>
<p>最后，我们需要在爬虫文件中完成：响应解析、数据结构对象定义、调用管道</p>
<h2 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h2><h3 id="mysql下载-amp-安装"><a href="#mysql下载-amp-安装" class="headerlink" title="mysql下载&amp;安装"></a>mysql下载&amp;安装</h3><p><img src="http://image.kmoon.fun//images/202212221438125.png" alt="image-20221222143837775"></p>
<h2 id="pymysql的使用步骤"><a href="#pymysql的使用步骤" class="headerlink" title="pymysql的使用步骤"></a>pymysql的使用步骤</h2><p><img src="http://image.kmoon.fun//images/202212221523194.png" alt="image-20221222152352938"></p>
<h2 id="CrawlSpider"><a href="#CrawlSpider" class="headerlink" title="CrawlSpider"></a>CrawlSpider</h2><h3 id="1-继承自scrapy-Spider"><a href="#1-继承自scrapy-Spider" class="headerlink" title="1.继承自scrapy.Spider"></a>1.继承自scrapy.Spider</h3><h3 id="2-独门秘籍"><a href="#2-独门秘籍" class="headerlink" title="2.独门秘籍"></a>2.独门秘籍</h3><p>CrawlSpider可以定义规则，在解析html内容的时候，可以根据链接规则提取出指定的链接，然后再向这些链接发送请求</p>
<p>所以，如果有需要跟进链接的需求，意思就是爬取了网页下之后，需要提取链接再次爬取，使用CrawlSpider是非常合适的。</p>
<h3 id="3-链接提取器"><a href="#3-链接提取器" class="headerlink" title="3.链接提取器"></a>3.链接提取器</h3><p>链接提取器，在这里就可以写规则提取指定链接</p>
<p><img src="http://image.kmoon.fun//images/202212221448439.png" alt="image-20221222144830185"></p>
<p><img src="http://image.kmoon.fun//images/202212221453641.png" alt="image-20221222145300401"></p>
<ul>
<li>案例练习：读书网数据入库</li>
</ul>
<p><img src="http://image.kmoon.fun//images/202212221454828.png" alt="image-20221222145422583"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1.</span> 创建项目 scrapy startproject 项目的名字
<span class="token number">2.</span> 跳转到spiders文件夹的目录下
   cd 项目名字\项目名字\spiders
<span class="token number">3.</span> 创建爬虫文件
   scrapy genspider <span class="token operator">-</span>t crawl 爬虫文件的名字  爬取的域名
        
<span class="token keyword">import</span> scrapy
<span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>linkextractors <span class="token keyword">import</span> LinkExtractor
<span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>spiders <span class="token keyword">import</span> CrawlSpider<span class="token punctuation">,</span> Rule

<span class="token keyword">from</span> scrapy_readbook_101<span class="token punctuation">.</span>items <span class="token keyword">import</span> ScrapyReadbook101Item


<span class="token keyword">class</span> <span class="token class-name">ReadSpider</span><span class="token punctuation">(</span>CrawlSpider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'read'</span>
    allowed_domains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'www.dushu.com'</span><span class="token punctuation">]</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://www.dushu.com/book/1188_1.html'</span><span class="token punctuation">]</span>

    <span class="token comment"># follow 跟进</span>
    rules <span class="token operator">=</span> <span class="token punctuation">(</span>
        Rule<span class="token punctuation">(</span>LinkExtractor<span class="token punctuation">(</span>allow<span class="token operator">=</span><span class="token string">r'/book/1188_\d+\.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                           callback<span class="token operator">=</span><span class="token string">'parse_item'</span><span class="token punctuation">,</span>
                           follow<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">parse_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>

        img_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="bookslist"]//img'</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> img <span class="token keyword">in</span> img_list<span class="token punctuation">:</span>
            src <span class="token operator">=</span> img<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./@data-original'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
            name <span class="token operator">=</span> img<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./@alt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>

            book <span class="token operator">=</span> ScrapyReadbook101Item<span class="token punctuation">(</span>name<span class="token operator">=</span>name<span class="token punctuation">,</span>src<span class="token operator">=</span>src<span class="token punctuation">)</span>
            <span class="token keyword">yield</span> book<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="数据入库"><a href="#数据入库" class="headerlink" title="数据入库"></a>数据入库</h2><p><strong>创建数据库</strong></p>
<pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">mysql -uroot -p123456
create database spider01 charset=utf8;
use spider01
create table book(
    id int primarykey auto_increment,
    name varchar(128),
    src varchar(128)
)

select * from book;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>配置settings.py</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 参数中一个端口号 一个是字符集 都要注意</span>
DB_HOST <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span>
<span class="token comment"># 端口号是一个整数</span>
DB_PORT <span class="token operator">=</span> <span class="token number">3306</span>
DB_USER <span class="token operator">=</span> <span class="token string">'root'</span>
DB_PASSWROD <span class="token operator">=</span> <span class="token string">'123456'</span>
DB_NAME <span class="token operator">=</span> <span class="token string">'spider01'</span>
<span class="token comment"># utf-8的杠不允许写</span>
DB_CHARSET <span class="token operator">=</span> <span class="token string">'utf8'</span>

ITEM_PIPELINES <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token string">'scrapy_readbook_101.pipelines.ScrapyReadbook101Pipeline'</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
   <span class="token comment"># MysqlPipeline</span>
  <span class="token string">'scrapy_readbook_101.pipelines.MysqlPipeline'</span><span class="token punctuation">:</span><span class="token number">301</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>创建管道类</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 加载settings文件</span>
<span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>project <span class="token keyword">import</span> get_project_settings
<span class="token keyword">import</span> pymysql

<span class="token keyword">class</span> <span class="token class-name">MysqlPipeline</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        settings <span class="token operator">=</span> get_project_settings<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>host <span class="token operator">=</span> settings<span class="token punctuation">[</span><span class="token string">'DB_HOST'</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>port <span class="token operator">=</span>settings<span class="token punctuation">[</span><span class="token string">'DB_PORT'</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>user <span class="token operator">=</span>settings<span class="token punctuation">[</span><span class="token string">'DB_USER'</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>password <span class="token operator">=</span>settings<span class="token punctuation">[</span><span class="token string">'DB_PASSWROD'</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span>settings<span class="token punctuation">[</span><span class="token string">'DB_NAME'</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>charset <span class="token operator">=</span>settings<span class="token punctuation">[</span><span class="token string">'DB_CHARSET'</span><span class="token punctuation">]</span>

        self<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
                            host<span class="token operator">=</span>self<span class="token punctuation">.</span>host<span class="token punctuation">,</span>
                            port<span class="token operator">=</span>self<span class="token punctuation">.</span>port<span class="token punctuation">,</span>
                            user<span class="token operator">=</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span>
                            password<span class="token operator">=</span>self<span class="token punctuation">.</span>password<span class="token punctuation">,</span>
                            db<span class="token operator">=</span>self<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                            charset<span class="token operator">=</span>self<span class="token punctuation">.</span>charset
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        sql <span class="token operator">=</span> <span class="token string">'insert into book(name,src) values("{}","{}")'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>item<span class="token punctuation">[</span><span class="token string">'src'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># 执行sql语句</span>
        self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        <span class="token comment"># 提交</span>
        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> item

    <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="日志信息以及日志等级"><a href="#日志信息以及日志等级" class="headerlink" title="日志信息以及日志等级"></a>日志信息以及日志等级</h2><p><img src="http://image.kmoon.fun//images/202212221536464.png" alt="image-20221222153624162"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># settings.py</span>

<span class="token comment"># 指定日志的级别</span>
<span class="token comment"># LOG_LEVEL='WARNING'</span>

LOG_FILE <span class="token operator">=</span> <span class="token string">'logdemo.log'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>首先是不在终端显示日志，即还我们一个清爽的终端显示；</p>
<p>其次是把日志保存在spiders文件夹下的xxxx.log文件中，供我们查看</p>
<h2 id="Requests和reponse总结"><a href="#Requests和reponse总结" class="headerlink" title="Requests和reponse总结"></a>Requests和reponse总结</h2><h2 id="scrapy的post请求"><a href="#scrapy的post请求" class="headerlink" title="scrapy的post请求"></a>scrapy的post请求</h2><p><img src="http://image.kmoon.fun//images/202212221541177.png" alt="image-20221222154111906"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> scrapy
<span class="token keyword">import</span> json

<span class="token keyword">class</span> <span class="token class-name">TestpostSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'testpost'</span>
    allowed_domains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://fanyi.baidu.com/sug'</span><span class="token punctuation">]</span>
    <span class="token comment"># post请求 如果没有参数 那么这个请求将没有任何意义</span>
    <span class="token comment"># 所以start_urls 也没有用了</span>
    <span class="token comment"># parse方法也没有用了</span>
    <span class="token comment"># start_urls = ['https://fanyi.baidu.com/sug/']</span>
    <span class="token comment">#</span>
    <span class="token comment"># def parse(self, response):</span>
    <span class="token comment">#     pass</span>

    <span class="token keyword">def</span> <span class="token function">start_requests</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">'https://fanyi.baidu.com/sug'</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'kw'</span><span class="token punctuation">:</span> <span class="token string">'final'</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>FormRequest<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>formdata<span class="token operator">=</span>data<span class="token punctuation">,</span>callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse_second<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">parse_second</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        content <span class="token operator">=</span> response<span class="token punctuation">.</span>text
        obj <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>content<span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="Excel文件读写"><a href="#Excel文件读写" class="headerlink" title="Excel文件读写"></a>Excel文件读写</h1><h2 id="安装相关库"><a href="#安装相关库" class="headerlink" title="安装相关库"></a>安装相关库</h2><p><code>pip install xlrd==1.2.0</code></p>
<p>xlrd版本太高会出现报错</p>
<p><code>pip install xlsxwriter</code></p>
<p><strong>xlrd 这个包是当我们需要打开或者读出一个Excel文件时需要依赖的包</strong>，我们的写入操作是不需要它的。</p>
<p><strong>xlsxwriter</strong> 这个包从拼写就可以看出它<strong>是专供写入Excel使用的包</strong>。</p>
<h2 id="读写操作"><a href="#读写操作" class="headerlink" title="读写操作"></a>读写操作</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 导入包</span>
<span class="token keyword">import</span> xlrd
<span class="token keyword">import</span> xlsxwriter

<span class="token comment"># 创建一张空表</span>
<span class="token keyword">import</span> xlsxwriter
excel_file_writer <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">r'./demo.xlsx'</span><span class="token punctuation">)</span>
excel_file_writer<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>表的创建工作只需要xlsxwriter包即可，无关另一个包。它的过程是首先我们<strong>新建一个文件操作对象(excel_file_writer)<strong>，并在</strong>创建时传入文件的路径和文件名称</strong>(<strong>注意后缀只能是”xlsx”</strong>)。</p>
<p>写入数据</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> xlsxwriter
 
excel_file_writer <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">r'./demo.xlsx'</span><span class="token punctuation">)</span>
 
excel_worksheet_writer <span class="token operator">=</span> excel_file_writer<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">'sheet1'</span><span class="token punctuation">)</span>
 
student_name_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">]</span>
 
grade_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span>
 
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>student_name_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    excel_worksheet_writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>student_name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

    excel_worksheet_writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>grade_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    excel_file_writer<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>write(工作表的行数，工作表的列数，写入的数据)</strong></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://blog.csdn.net/qq_52736131/article/details/123251138">https://blog.csdn.net/qq_52736131/article/details/123251138</a> 六万字爬虫笔记</p>
<p><a href="https://blog.csdn.net/weixin_45816407/article/details/120176139">https://blog.csdn.net/weixin_45816407/article/details/120176139</a> xpath插件</p>

        </div>

    </div>

    

    

    

    

    

    
<nav class="article-nav">
  
    <a href="/2022/spider-example/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-caption">下一篇</div>
      <div class="article-nav-title">
        
          记录手敲Python爬虫案例练习“
        
      </div>
    </a>
  
  
    <a href="/2022/vue/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-caption">上一篇</div>
      <div class="article-nav-title">学习札记-VUEjs从入门到精通(放弃)</div>
    </a>
  
</nav>


    <section class="share">
        <div class="share-title">分享</div>
        <a class="share-item" target="_blank"
            href="https://twitter.com/share?text=学习札记-Python爬虫基础入门 - Kmoon | 个人学习记录&url=https%3A%2F%2Fwww.kmoon.fun%2F2022%2Fspider%2F">
            <ion-icon name="logo-twitter"></ion-icon>
        </a>
        <a class="share-item" target="_blank"
            href="https://www.facebook.com/sharer.php?title=学习札记-Python爬虫基础入门 - Kmoon | 个人学习记录&u=https%3A%2F%2Fwww.kmoon.fun%2F2022%2Fspider%2F">
            <ion-icon name="logo-facebook"></ion-icon>
        </a>
        <!-- <a class="share-item" target="_blank"
            href="https://service.weibo.com/share/share.php?title=学习札记-Python爬虫基础入门 - Kmoon | 个人学习记录&url=https://www.kmoon.fun/2022/spider/&pic=">
            <div class="n-icon n-icon-weibo"></div>
        </a> -->
    </section>

</article>










<section class="comments">
    <div id="valine-container"></div>
</section>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>







<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</div>
                </section>
            </section>

            
            <aside class="sidebar sidebar-search-fix">
                

    <div class="search">
    <div class="has-icon-right">
        <input type="text" class="form-input" id="search" placeholder="SEARCH" autocomplete="off">
        <div class="form-icon">
            <ion-icon name="search"></ion-icon>
        </div>
    </div>
    <div class="search-result" id="search-ps"></div>
</div>


<div class="widget" id="widget">
    
      
  <div class="widget-wrap">
    <div class="widget-inner">
      <div class="toc post-toc-html"></div>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-cate">
    <div class="widget-title"><span>Categories</span></div>
    <div class="widget-inner">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/XiaoHu-s-Daily/">XiaoHu's Daily</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/">他山之石</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/">刷题笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E4%B8%89%E4%BB%B6%E5%A5%97/">前端三件套</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E6%9C%AD%E8%AE%B0/">学习札记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/">实验报告</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%87%92%E4%BA%BA%E5%BF%85%E5%A4%87/">懒人必备</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%AA%E5%91%BD%E5%90%8D/">未命名</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B7%B1%E6%B8%8A/">深渊</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/">渗透工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/">靶场日记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A1%B9%E7%9B%AE%E8%AE%A1%E5%88%92/">项目计划</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-tags">
    <div class="widget-title"><span>Tags</span></div>
    <div class="widget-inner">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/51%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">51单片机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google/" rel="tag">Google</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RNN/" rel="tag">RNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SRC/" rel="tag">SRC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sec/" rel="tag">Sec</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swing/" rel="tag">Swing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WUT/" rel="tag">WUT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Whut/" rel="tag">Whut</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XSS/" rel="tag">XSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/daily/" rel="tag">daily</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hacker/" rel="tag">hacker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdwon/" rel="tag">markdwon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/me/" rel="tag">me</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nmap/" rel="tag">nmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/upload/" rel="tag">upload</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web%E5%AE%89%E5%85%A8/" rel="tag">web安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag">信息收集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/" rel="tag">关系代数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%8D%E4%B9%A0%E9%A2%98/" rel="tag">复习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" rel="tag">实验报告</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" rel="tag">数学建模</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" rel="tag">数据库系统原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" rel="tag">文件上传漏洞</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8B%E8%AF%95/" rel="tag">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/" rel="tag">渗透工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB%E6%A1%88%E4%BE%8B/" rel="tag">爬虫案例</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%84%E7%BD%91%E6%8A%80%E6%9C%AF/" rel="tag">组网技术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%BD%91/" rel="tag">计网</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/" rel="tag">跨站请求伪造漏洞</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%B6%E5%9C%BA/" rel="tag">靶场</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-recent-posts">
    <div class="widget-title"><span>Recent Posts</span></div>
    <div class="widget-inner">
      <ul>
        
          <li>
            <a href="/2023/null/">学习札记-JavaScript自查文档</a>
          </li>
        
          <li>
            <a href="/2023/null/">学习札记-CSS自查文档</a>
          </li>
        
          <li>
            <a href="/2023/html/">学习札记-HTML自查文档</a>
          </li>
        
          <li>
            <a href="/2022/code/">他山之石-代码随想录知识星球文库</a>
          </li>
        
          <li>
            <a href="/2022/js-basic/">学习札记-JavaScript基础知识</a>
          </li>
        
      </ul>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-archive">
    <div class="widget-title"><span>Archive</span></div>
    <div class="widget-inner">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a></li></ul>
    </div>
  </div>


    
</div>

<div id="backtop"><i class="icon icon-arrow-up"></i></div>
            </aside>
            
        </div>
    </div>

    <footer class="footer">
    <div class="footer-wave">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#3c4859" fill-opacity="1" d="M0,160L60,181.3C120,203,240,245,360,240C480,235,600,181,720,186.7C840,192,960,256,1080,261.3C1200,267,1320,213,1380,186.7L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path></svg>
    </div>

    <!-- Please do not remove this -->
    <!-- 开源不易，请勿删除 -->
    <div class="footer-wrap">
        <div class="footer-inner"> 
            Kmoon | 个人学习记录 &copy; 2023<br>
            Powered By Hexo · Theme By <a href="https://linhong.me/" target="_blank">Aomori</a> · <a href="https://github.com/lh1me/hexo-theme-aomori" target="_blank">Github</a>
			<br><img src="https://www.beian.gov.cn/img/new/gongan.png">
<a href="https://beian.miit.gov.cn/" target="_blank">渝ICP备2022011774号-1</a>


        </div>
    </div>

</footer>

<script type="module" src="https://unpkg.com/ionicons@6.0.2/dist/ionicons/ionicons.esm.js"></script>






<script src="/dist/build.js?1654266144177.js"></script>


<script src="/dist/custom.js?1654266144177.js"></script>



<!-- 百度链接提交 -->
<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>











<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":220,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>