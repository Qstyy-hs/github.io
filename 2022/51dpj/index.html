<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    
    <title>学习札记-51单片机(C语言版) | Kmoon</title>

    <meta name="description" content="&lt;blockquote&gt;
&lt;p&gt;做技术必须要认真，很多人做事的时候喜欢糊弄，但做技术绝对不可以。&lt;br&gt;技术是逻辑性很强的东西，不应该有任何侥幸心理，你糊弄它它就糊弄你。																												——李冬明【前言&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Last Update：2022.11.26&lt;/p&gt;
&lt;p&gt;Tips：仅个人理解，未对硬件原理深究,若发现错误敬请斧正。&lt;/p&gt;">
    <meta name="keywords" content="">

    

    <meta property="og:locale" content="cn" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content= "学习札记-51单片机(C语言版) | Kmoon"  />
    <meta property="og:description" content= "&lt;blockquote&gt;
&lt;p&gt;做技术必须要认真，很多人做事的时候喜欢糊弄，但做技术绝对不可以。&lt;br&gt;技术是逻辑性很强的东西，不应该有任何侥幸心理，你糊弄它它就糊弄你。																												——李冬明【前言&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Last Update：2022.11.26&lt;/p&gt;
&lt;p&gt;Tips：仅个人理解，未对硬件原理深究,若发现错误敬请斧正。&lt;/p&gt;" />
    <meta property="og:url" content="https://www.kmoon.fun/2022/51dpj/index.html" />
    <meta property="og:site_name" content="" />
    <meta property="article:author" content="Kmoon" />
    <meta property="article:publisher" content="" />
    <meta property="og:description" content="&lt;blockquote&gt;
&lt;p&gt;做技术必须要认真，很多人做事的时候喜欢糊弄，但做技术绝对不可以。&lt;br&gt;技术是逻辑性很强的东西，不应该有任何侥幸心理，你糊弄它它就糊弄你。																												——李冬明【前言&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Last Update：2022.11.26&lt;/p&gt;
&lt;p&gt;Tips：仅个人理解，未对硬件原理深究,若发现错误敬请斧正。&lt;/p&gt;" />
    <meta name="twitter:title" content="学习札记-51单片机(C语言版) | Kmoon"/>
    <meta name="twitter:description" content="&lt;blockquote&gt;
&lt;p&gt;做技术必须要认真，很多人做事的时候喜欢糊弄，但做技术绝对不可以。&lt;br&gt;技术是逻辑性很强的东西，不应该有任何侥幸心理，你糊弄它它就糊弄你。																												——李冬明【前言&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Last Update：2022.11.26&lt;/p&gt;
&lt;p&gt;Tips：仅个人理解，未对硬件原理深究,若发现错误敬请斧正。&lt;/p&gt;"/>
    <script type="application/ld+json">
        {
            "description": "&lt;blockquote&gt;
&lt;p&gt;做技术必须要认真，很多人做事的时候喜欢糊弄，但做技术绝对不可以。&lt;br&gt;技术是逻辑性很强的东西，不应该有任何侥幸心理，你糊弄它它就糊弄你。																												——李冬明【前言&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Last Update：2022.11.26&lt;/p&gt;
&lt;p&gt;Tips：仅个人理解，未对硬件原理深究,若发现错误敬请斧正。&lt;/p&gt;",
            "author": { "@type": "Person", "name": "Kmoon" },
            "@type": "BlogPosting",
            "url": "https://www.kmoon.fun/2022/51dpj/index.html",
            "publisher": {
            "@type": "Organization",
            "logo": {
                "@type": "ImageObject",
                "url": "https://www.kmoon.fun/image/avatar.png"
            },
            "name": "Kmoon"
            },
            "headline": "学习札记-51单片机(C语言版) | Kmoon",
            "datePublished": "2022-09-27T10:52:12.000Z",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://www.kmoon.fun/2022/51dpj/index.html"
            },
            "@context": "http://schema.org"
        }
    </script>




    

    
    <meta property="algolia:search" data-application-id="8Z51BHYAUH" data-api-key="dbc9dafd607e95ea5aa312369120eabd" data-index-name="kmoon_blog">
    

    

    

    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🌜️</text></svg>">
    

    

    

    
<link rel="stylesheet" href="/dist/build.css?v=1654266144177.css">


    
<link rel="stylesheet" href="/dist/custom.css?v=1654266144177.css">


    <script>
        window.isPost = true
        window.aomori = {
            
            
            valine: {
                enable: true,
                appId: "i7G1tHcsR13KVa00grUUf6mr-gzGzoHsz",
                appKey: "94N35fphXFiN5BGMNS9V5mHe",
                placeholder: "Hello World!",
                avatar: "",
                pageSize: "10",
                lang: "zh-CN",
                visitor: false,
                highlight: false,
                recordIP: false,
                emojiCDN: "",
                enableQQ: false,
                requiredFields: []
            },
            
            
        }
        window.aomori_logo_typed_animated = true
        window.aomori_search_algolia = true

    </script>

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Kmoon" type="application/atom+xml">
</head>

<body>

    <div class="container">
    <header class="header">
        <div class="header-type">
            
            <div class="header-type-avatar avatar avatar-sm">
                <img src="/image/avatar.png" alt="Kmoon">
            </div>
            
            <div class="header-type-inner">
                
                    <div id="typed-strings" style="display:none">
                        <p>Kmoon</p>
                    </div>
                    <a class="header-type-title" id="typed" href="/"></a>
                
    
                
            </div>
        </div>
        <div class="header-menu">
            <div class="header-menu-inner">
                
                <a href="/">主页</a>
                
                <a href="/archives">归档</a>
                
                <a href="/2022/10/about/">关于</a>
                
                <a href="/friends">友链</a>
                
                <a href="/photography">摄影</a>
                
                <a href="/categories/%E6%B7%B1%E6%B8%8A/">深渊</a>
                
                <a href="/wiki/">Wiki</a>
                
            </div>
            <div class="header-menu-social">
                
    <a class="social" target="_blank" href="https://github.com/kmoonn/">
        <ion-icon name="logo-github"></ion-icon>
    </a>

    <a class="social" target="_blank" href="">
        <ion-icon name="logo-wechat"></ion-icon>
    </a>

            </div>
        </div>

        <div class="header-menu-mobile">
            <div class="header-menu-mobile-inner" id="mobile-menu-open">
                <i class="icon icon-menu"></i>
            </div>
        </div>
    </header>

    <div class="header-menu-mobile-menu">
        <div class="header-menu-mobile-menu-bg"></div>
        <div class="header-menu-mobile-menu-wrap">
            <div class="header-menu-mobile-menu-inner">
                <div class="header-menu-mobile-menu-close" id="mobile-menu-close">
                    <i class="icon icon-cross"></i>
                </div>
                <div class="header-menu-mobile-menu-list">
                    
                    <a href="/">主页</a>
                    
                    <a href="/archives">归档</a>
                    
                    <a href="/2022/10/about/">关于</a>
                    
                    <a href="/friends">友链</a>
                    
                    <a href="/photography">摄影</a>
                    
                    <a href="/categories/%E6%B7%B1%E6%B8%8A/">深渊</a>
                    
                    <a href="/wiki/">Wiki</a>
                    
                </div>
            </div>
        </div>
    </div>

</div>

    <div class="container">
        <div class="main">
            <section class="inner">
                <section class="inner-main">
                    <div class="post">
    <article id="post-clay3ya020021l8vmfycf4spt" class="article article-type-post" itemscope
    itemprop="blogPost">

    <div class="article-inner">

        
          
        
        
        

        
        <header class="article-header">
            
  
    <h1 class="article-title" itemprop="name">
      学习札记-51单片机(C语言版)
    </h1>
  

        </header>
        

        <div class="article-more-info article-more-info-post hairline">

            <div class="article-date">
  <time datetime="2022-09-27T10:52:12.000Z" itemprop="datePublished">2022-09-27</time>
</div>

            
            <div class="article-category">
                <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0%E6%9C%AD%E8%AE%B0/">学习札记</a>
            </div>
            

            
            <div class="article-tag">
                <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/51%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">51单片机</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C</a></li></ul>
            </div>
            

            
            <div class="article-busuanzi">
                <span id="busuanzi_value_page_pv">N</span> 人看过
            </div>
            

        </div>

        <div class="article-entry post-inner-html hairline" itemprop="articleBody">
            <blockquote>
<p>做技术必须要认真，很多人做事的时候喜欢糊弄，但做技术绝对不可以。<br>技术是逻辑性很强的东西，不应该有任何侥幸心理，你糊弄它它就糊弄你。																												——李冬明【前言</p>
</blockquote>
<p>Last Update：2022.11.26</p>
<p>Tips：仅个人理解，未对硬件原理深究,若发现错误敬请斧正。</p>
<span id="more"></span>

<h2 id="一、概论"><a href="#一、概论" class="headerlink" title="一、概论"></a>一、概论</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><img src="https://img.gejiba.com/images/6511d16815b36b665708bd037e836282.png" alt="6511d16815b36b665708bd037e836282.png" style="zoom: 33%;">


<h4 id="Keil"><a href="#Keil" class="headerlink" title="Keil"></a>Keil</h4><p><strong>Keil uVision5安装</strong></p>
<p>无脑下一步即可，注意<strong>安装路径</strong>不要出现<strong>中文</strong>字符</p>
<p><strong>基本介绍</strong></p>
<p>菜单栏、工具栏、工程管理区、程序代码区域、信息输出窗口</p>
<p><strong>使用步骤</strong></p>
<ol>
<li><p>新建工程 .uvproj</p>
</li>
<li><p>选择单片机型号 Intel—&gt;80/87C52</p>
</li>
<li><p>保存工程</p>
</li>
<li><p>创建编写代码的文件</p>
</li>
<li><p>添加文件到工程中</p>
</li>
<li><p>编写程序</p>
</li>
<li><p>编译</p>
</li>
<li><p>下载</p>
</li>
</ol>
<h4 id="STC-ISP下载"><a href="#STC-ISP下载" class="headerlink" title="STC-ISP下载"></a>STC-ISP下载</h4><h5 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h5><h5 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h5><ol>
<li>选择单片机型号</li>
<li>找到编译的hex文件</li>
<li>选择COM口号</li>
<li>冷启动下载</li>
</ol>
<h3 id="单片机初识"><a href="#单片机初识" class="headerlink" title="单片机初识"></a>单片机初识</h3><h4 id="内部资源"><a href="#内部资源" class="headerlink" title="内部资源"></a><strong>内部资源</strong></h4><ol>
<li><p><strong>Flash</strong>——程序存储空间</p>
<p><strong>可重复擦写</strong>、容量大、成本低、<strong>断电后数据不丢失</strong>，类似计算机的<strong>硬盘</strong>。</p>
</li>
<li><p><strong>RAM</strong>——程序运行过程中产生的和需要的数据，类似计算器。</p>
<p><strong>断电后数据丢失</strong>，读写速度非常快，寿命无限。</p>
</li>
<li><p><strong>SFR</strong>——特殊功能寄存器</p>
<p>单片机<strong>每个功能都会对应一个或多个SFR</strong></p>
</li>
</ol>
<h4 id="最小系统"><a href="#最小系统" class="headerlink" title="最小系统"></a><strong>最小系统</strong></h4><img src="http://image.kmoon.fun//images/202211261307761.png" alt="image-20221126130654622" style="zoom:50%;">

<ol>
<li><p>电源</p>
</li>
<li><p>晶振</p>
<p>晶体振荡器，为单片机系统提供基准时钟信号。</p>
<p>通常分为有源晶振和无源晶振两种类型。</p>
<p>无源晶体一般称为crystal（晶体），有源晶体叫做oscillator（振荡器）。</p>
</li>
<li><p>复位电路</p>
<p>上电复位、手动复位、程序自动复位。</p>
<p>上电复位保证单片机每次都从一个固定的相同的状态开始工作</p>
<p>手动复位：重启</p>
<p>程序自动复位：看门狗模块</p>
</li>
</ol>
<h2 id="二、硬件基础"><a href="#二、硬件基础" class="headerlink" title="二、硬件基础"></a>二、硬件基础</h2><p><img src="https://img.gejiba.com/images/df80c35a1447f55f04968de95f5d121a.png" alt="df80c35a1447f55f04968de95f5d121a.png"></p>
<p><img src="http://image.kmoon.fun//images/202211231407102.png" alt="image-20221123140750758"></p>
<h3 id="LED"><a href="#LED" class="headerlink" title="LED"></a>LED</h3><p>发光二极管，俗称LED小灯</p>
<p>开发板共8个LED小灯，通过<strong>P0</strong>口（<strong>74HC254</strong>）控制。</p>
<p><code>sfr P0=0x80;</code></p>
<h3 id="电磁干扰EMI"><a href="#电磁干扰EMI" class="headerlink" title="电磁干扰EMI"></a>电磁干扰EMI</h3><h3 id="去耦电容"><a href="#去耦电容" class="headerlink" title="去耦电容"></a>去耦电容</h3><ol>
<li>缓冲作用</li>
<li>稳定作用</li>
</ol>
<h3 id="三极管"><a href="#三极管" class="headerlink" title="三极管"></a>三极管</h3><img src="http://image.kmoon.fun//images/202211261419771.png" alt="image-20221126141946694" style="zoom:80%;">

<img src="http://image.kmoon.fun//images/202211261426223.png" alt="image-20221126142644145" style="zoom:80%;">

<h3 id="74HC245"><a href="#74HC245" class="headerlink" title="74HC245"></a>74HC245</h3><p>双向缓冲器</p>
<p>74HC245左侧是通过P0口控制</p>
<p><img src="http://image.kmoon.fun//images/202211261518886.png" alt="image-20221126151834778"></p>
<h3 id="74HC138"><a href="#74HC138" class="headerlink" title="74HC138"></a>74HC138</h3><p><img src="http://image.kmoon.fun//images/202211261842963.png" alt="image-20221126184201825"></p>
<p>把3种输入状态翻译成8种输出</p>
<p>三八译码器 输出低电平有效</p>
<p>74HC138作为8个LED的总开关（<strong>LEDS6</strong>）</p>
<h3 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h3><p>51单片机内部有T0，T1两个定时器</p>
<p>定时器存储寄存器</p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">描述</th>
<th align="center">SFR地址</th>
<th align="center">复位值</th>
</tr>
</thead>
<tbody><tr>
<td align="center">TH0</td>
<td align="center">定时器0高字节</td>
<td align="center">0x8C</td>
<td align="center">0X00</td>
</tr>
<tr>
<td align="center">TL0</td>
<td align="center">定时器0低字节</td>
<td align="center">0x8A</td>
<td align="center">0X00</td>
</tr>
<tr>
<td align="center">TH1</td>
<td align="center">定时器1高字节</td>
<td align="center">0x8D</td>
<td align="center">0X00</td>
</tr>
<tr>
<td align="center">TL1</td>
<td align="center">定时器1低字节</td>
<td align="center">0x8B</td>
<td align="center">0X00</td>
</tr>
</tbody></table>
<p><img src="http://image.kmoon.fun//images/202211261954575.png" alt="image-20221126195432501"></p>
<p>TCON</p>
<p>TMOD</p>
<p><img src="http://image.kmoon.fun//images/202211262000412.png" alt="image-20221126200005339"></p>
<p>工作模式</p>
<p><strong>模式1</strong>：THn和TLn组成一个<strong>16位</strong>的定时器，<strong>计数范围是0~65535</strong></p>
<p><strong>模式2</strong>：<strong>8位</strong>自动重装载模式，<strong>只有TLn做加1计数，计数范围0~255</strong>，THn的值不会变化，而会保持原来的值，<strong>定时器溢出后THn重装到TLn</strong></p>
<p><strong>定时器的应用</strong></p>
<ol>
<li>设置特殊功能寄存器TMOD，配置好工作模式</li>
<li>设置计数寄存器TH0和TL0的初值</li>
<li>设置TCON，通过TR0置1来让定时器开始计数</li>
<li>判断TCON寄存器的TF0位，监测定时器溢出情况</li>
</ol>
<p><strong>！计算定时：</strong></p>
<p><strong>晶振是11.0592MHz，时钟周期就是1/11059200，机器周期是12/11056200</strong></p>
<p>计算所需的定时需要经过几个机器周期，再用定时器的溢出值减去经过的时钟周期，得到初始值，就可以给TH，TL设置初值，记得转成对应进制。</p>
<p><strong>总结：</strong></p>
<p><strong>TMOD 模式</strong></p>
<p><strong>TH TL 初值</strong></p>
<p><strong>TR 启动计时</strong></p>
<p><strong>TF 溢出停止</strong></p>
<p><img src="http://image.kmoon.fun//images/202211262008271.png" alt="image-20221126200846185"></p>
<h3 id="中断"><a href="#中断" class="headerlink" title="中断"></a>中断</h3><img src="http://image.kmoon.fun//images/202211262224704.png" alt="image-20221126222447627" style="zoom:67%;">

<p>控制中断的寄存器有两个：<strong>中断使能寄存器</strong>和<strong>中断优先级寄存器</strong></p>
<p>中断使能寄存器IE：</p>
<table>
<thead>
<tr>
<th align="center">位</th>
<th align="center">符号</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">7</td>
<td align="center">EA</td>
<td align="center">总中断使能位，相当于总开关</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">–</td>
<td align="center">–</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">ET2</td>
<td align="center">定时器2中断使能</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">ES</td>
<td align="center">串口中断使能</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">ET1</td>
<td align="center">定时器1中断使能</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">EX1</td>
<td align="center">外部中断1使能</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">ET0</td>
<td align="center">定时器0中断使能</td>
</tr>
<tr>
<td align="center">0</td>
<td align="center">EX0</td>
<td align="center">外部中断0使能</td>
</tr>
</tbody></table>
<p>中断查询序列</p>
<table>
<thead>
<tr>
<th align="center">中断函数编号</th>
<th align="center">中断名称</th>
<th align="center">中断标志位</th>
<th align="center">中断使能位</th>
<th align="center">中断向量地址</th>
<th align="center">默认优先级</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">外部中断0</td>
<td align="center">IE0</td>
<td align="center">EX0</td>
<td align="center">0x0003</td>
<td align="center">1(最高)</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">T0中断</td>
<td align="center">TF0</td>
<td align="center">ET0</td>
<td align="center">0x000B</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">外部中断1</td>
<td align="center">IE1</td>
<td align="center">EX1</td>
<td align="center">0x0013</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">T1中断</td>
<td align="center">TF1</td>
<td align="center">ET1</td>
<td align="center">0x001B</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">UART中断</td>
<td align="center">TI/RI</td>
<td align="center">ES</td>
<td align="center">0x0023</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">T2中断</td>
<td align="center">TF2/EXF2</td>
<td align="center">ET2</td>
<td align="center">0x002B</td>
<td align="center">6</td>
</tr>
</tbody></table>
<p><strong>EA=1 总开关</strong> <strong>0-5位相当于分开关</strong></p>
<p>中断函数不返回任何值</p>
<p>interrupt关键字</p>
<p>中断的优先级IP：</p>
<ol>
<li>抢占优先级</li>
<li>固有优先级</li>
</ol>
<h3 id="单片机I-x2F-O口"><a href="#单片机I-x2F-O口" class="headerlink" title="单片机I/O口"></a>单片机I/O口</h3><h3 id="上下拉电阻"><a href="#上下拉电阻" class="headerlink" title="上下拉电阻"></a>上下拉电阻</h3><h3 id="步进电机"><a href="#步进电机" class="headerlink" title="步进电机"></a>步进电机</h3><h3 id="蜂鸣器"><a href="#蜂鸣器" class="headerlink" title="蜂鸣器"></a>蜂鸣器</h3><p>压电式、磁电式</p>
<p>有源、无源</p>
<h3 id="UART串口通信"><a href="#UART串口通信" class="headerlink" title="UART串口通信"></a>UART串口通信</h3><p>并行通信</p>
<p>串行通信</p>
<p><img src="http://image.kmoon.fun//images/202211231513014.png" alt="image-20221123151259940"></p>
<p><strong>低位先发 高位后发</strong></p>
<p>波特率：发送二进制数据位的速率</p>
<p>即发送1位二进制数据的持续时间=1/baud</p>
<p>通信之前必须保<strong>持波特率一致</strong></p>
<p><img src="http://image.kmoon.fun//images/202211231521011.png" alt="image-20221123152142940"></p>
<h2 id="三、C语言基础"><a href="#三、C语言基础" class="headerlink" title="三、C语言基础"></a>三、C语言基础</h2><h3 id="进制"><a href="#进制" class="headerlink" title="进制"></a>进制</h3><p>二进制0b，十进制，十六进制0x</p>
<h3 id="移位"><a href="#移位" class="headerlink" title="移位"></a>移位</h3><p>&gt;&gt;   &lt;&lt;</p>
<h3 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h3><ol>
<li>逻辑与 &amp;&amp;</li>
<li>逻辑或 ||</li>
<li>逻辑非 ！</li>
<li>按位与 &amp;</li>
<li>按位或 |</li>
<li>按位取反 ~</li>
<li>按位异或 ^</li>
</ol>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p><img src="http://image.kmoon.fun//images/202211261902983.png" alt="image-20221126190246901"></p>
<h3 id="类型和范围"><a href="#类型和范围" class="headerlink" title="类型和范围"></a>类型和范围</h3><img src="https://img.gejiba.com/images/2f997ffd9a36c8138208363f238f6d72.png" alt="2f997ffd9a36c8138208363f238f6d72.png" style="zoom: 67%;">

<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><p>局部变量</p>
<p>全局变量</p>
<h3 id="存储类别"><a href="#存储类别" class="headerlink" title="存储类别"></a>存储类别</h3><p>static 静态变量</p>
<h3 id="判断语句"><a href="#判断语句" class="headerlink" title="判断语句"></a>判断语句</h3><h3 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h3><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>声明、定义</p>
<p>实参、形参</p>
<h3 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h3><p>函数名（实参列表）</p>
<p>先定义，后调用。</p>
<h3 id="sfr关键字"><a href="#sfr关键字" class="headerlink" title="sfr关键字"></a>sfr关键字</h3><p>51单片机内部有许多小模块，每个模块居住在拥有唯一房间号的房间内，同时每个模块都有8个控制单元。</p>
<p>51单片机内部有许多寄存器，如果想使用必须提前进行sfr声明，或者包含reg52.h头文件</p>
<pre class="line-numbers language-none"><code class="language-none">#include &lt;reg52.h&gt;
sfr P0 = 0x80;
//定义一个单片机特殊功能寄存器
//P0就是一个功能模块，住在0x80这个房间，通过设置P0内部这个模块的8个开关，来让单片机的P0这8个I/O口输出高低电平<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="sbit关键字"><a href="#sbit关键字" class="headerlink" title="sbit关键字"></a>sbit关键字</h3><pre class="line-numbers language-none"><code class="language-none">sbit LED = P0^0
//LED就代表P0.0口<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>sbit 就是对8个开关其中一个进行定义</p>
<p>位定义：sbit就是对SFR里面的8个开关其中的一个进行定义</p>
<h3 id="code关键字"><a href="#code关键字" class="headerlink" title="code关键字"></a>code关键字</h3><p>数据存储在Flash中，<strong>无需更改</strong></p>
<h3 id="延时"><a href="#延时" class="headerlink" title="延时"></a>延时</h3><ol>
<li><p>非精确延时</p>
<p>for(i=0;i&lt;100;i++)</p>
<p>i=100;while(i–)</p>
</li>
<li><p>精确延时</p>
<p>用定时器定时</p>
<p>利用率函数 _nop_() 一个NOP的时间是一个机器周期的时间</p>
</li>
</ol>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>声明</p>
<p>初始化</p>
<p>使用和赋值</p>
<h3 id="作用域-1"><a href="#作用域-1" class="headerlink" title="作用域"></a>作用域</h3><p>局部变量：函数内部变量、函数形参</p>
<p>全局变量：函数外声明的变量</p>
<h3 id="变量存储类别"><a href="#变量存储类别" class="headerlink" title="变量存储类别"></a>变量存储类别</h3><p>自动auto：未加static修饰的函数局部变量		自动分配存储空间 结束后自动释放内存</p>
<p>静态static：全局变量+static修饰的局部变量	只赋一次初值 保持前一次执行结果</p>
<p>寄存器register</p>
<p>外部extern</p>
<h3 id="数组-1"><a href="#数组-1" class="headerlink" title="数组"></a>数组</h3><h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><h2 id="四、模块学习"><a href="#四、模块学习" class="headerlink" title="四、模块学习"></a>四、模块学习</h2><p>REG52.H头文件快速对照</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__REG52_H__</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__REG52_H__</span></span>

<span class="token comment">/*  BYTE Registers  */</span>
sfr P0    <span class="token operator">=</span> <span class="token number">0x80</span><span class="token punctuation">;</span>
sfr P1    <span class="token operator">=</span> <span class="token number">0x90</span><span class="token punctuation">;</span>
sfr P2    <span class="token operator">=</span> <span class="token number">0xA0</span><span class="token punctuation">;</span>
sfr P3    <span class="token operator">=</span> <span class="token number">0xB0</span><span class="token punctuation">;</span>
sfr PSW   <span class="token operator">=</span> <span class="token number">0xD0</span><span class="token punctuation">;</span>
sfr ACC   <span class="token operator">=</span> <span class="token number">0xE0</span><span class="token punctuation">;</span>
sfr B     <span class="token operator">=</span> <span class="token number">0xF0</span><span class="token punctuation">;</span>
sfr SP    <span class="token operator">=</span> <span class="token number">0x81</span><span class="token punctuation">;</span>
sfr DPL   <span class="token operator">=</span> <span class="token number">0x82</span><span class="token punctuation">;</span>
sfr DPH   <span class="token operator">=</span> <span class="token number">0x83</span><span class="token punctuation">;</span>
sfr PCON  <span class="token operator">=</span> <span class="token number">0x87</span><span class="token punctuation">;</span>
sfr TCON  <span class="token operator">=</span> <span class="token number">0x88</span><span class="token punctuation">;</span>
sfr TMOD  <span class="token operator">=</span> <span class="token number">0x89</span><span class="token punctuation">;</span>
sfr TL0   <span class="token operator">=</span> <span class="token number">0x8A</span><span class="token punctuation">;</span>
sfr TL1   <span class="token operator">=</span> <span class="token number">0x8B</span><span class="token punctuation">;</span>
sfr TH0   <span class="token operator">=</span> <span class="token number">0x8C</span><span class="token punctuation">;</span>
sfr TH1   <span class="token operator">=</span> <span class="token number">0x8D</span><span class="token punctuation">;</span>
sfr IE    <span class="token operator">=</span> <span class="token number">0xA8</span><span class="token punctuation">;</span>
sfr IP    <span class="token operator">=</span> <span class="token number">0xB8</span><span class="token punctuation">;</span>
sfr SCON  <span class="token operator">=</span> <span class="token number">0x98</span><span class="token punctuation">;</span>
sfr SBUF  <span class="token operator">=</span> <span class="token number">0x99</span><span class="token punctuation">;</span>

<span class="token comment">/*  8052 Extensions  */</span>
sfr T2CON  <span class="token operator">=</span> <span class="token number">0xC8</span><span class="token punctuation">;</span>
sfr RCAP2L <span class="token operator">=</span> <span class="token number">0xCA</span><span class="token punctuation">;</span>
sfr RCAP2H <span class="token operator">=</span> <span class="token number">0xCB</span><span class="token punctuation">;</span>
sfr TL2    <span class="token operator">=</span> <span class="token number">0xCC</span><span class="token punctuation">;</span>
sfr TH2    <span class="token operator">=</span> <span class="token number">0xCD</span><span class="token punctuation">;</span>


<span class="token comment">/*  BIT Registers  */</span>
<span class="token comment">/*  PSW  */</span>
sbit CY    <span class="token operator">=</span> PSW<span class="token operator">^</span><span class="token number">7</span><span class="token punctuation">;</span>
sbit AC    <span class="token operator">=</span> PSW<span class="token operator">^</span><span class="token number">6</span><span class="token punctuation">;</span>
sbit F0    <span class="token operator">=</span> PSW<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>
sbit RS1   <span class="token operator">=</span> PSW<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>
sbit RS0   <span class="token operator">=</span> PSW<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
sbit OV    <span class="token operator">=</span> PSW<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit P     <span class="token operator">=</span> PSW<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//8052 only</span>

<span class="token comment">/*  TCON  */</span>
sbit TF1   <span class="token operator">=</span> TCON<span class="token operator">^</span><span class="token number">7</span><span class="token punctuation">;</span>
sbit TR1   <span class="token operator">=</span> TCON<span class="token operator">^</span><span class="token number">6</span><span class="token punctuation">;</span>
sbit TF0   <span class="token operator">=</span> TCON<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>
sbit TR0   <span class="token operator">=</span> TCON<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>
sbit IE1   <span class="token operator">=</span> TCON<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
sbit IT1   <span class="token operator">=</span> TCON<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit IE0   <span class="token operator">=</span> TCON<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>
sbit IT0   <span class="token operator">=</span> TCON<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">/*  IE  */</span>
sbit EA    <span class="token operator">=</span> IE<span class="token operator">^</span><span class="token number">7</span><span class="token punctuation">;</span>
sbit ET2   <span class="token operator">=</span> IE<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//8052 only</span>
sbit ES    <span class="token operator">=</span> IE<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>
sbit ET1   <span class="token operator">=</span> IE<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
sbit EX1   <span class="token operator">=</span> IE<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit ET0   <span class="token operator">=</span> IE<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>
sbit EX0   <span class="token operator">=</span> IE<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">/*  IP  */</span>
sbit PT2   <span class="token operator">=</span> IP<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>
sbit PS    <span class="token operator">=</span> IP<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>
sbit PT1   <span class="token operator">=</span> IP<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
sbit PX1   <span class="token operator">=</span> IP<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit PT0   <span class="token operator">=</span> IP<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>
sbit PX0   <span class="token operator">=</span> IP<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">/*  P3  */</span>
sbit RD    <span class="token operator">=</span> P3<span class="token operator">^</span><span class="token number">7</span><span class="token punctuation">;</span>
sbit WR    <span class="token operator">=</span> P3<span class="token operator">^</span><span class="token number">6</span><span class="token punctuation">;</span>
sbit T1    <span class="token operator">=</span> P3<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>
sbit T0    <span class="token operator">=</span> P3<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>
sbit INT1  <span class="token operator">=</span> P3<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
sbit INT0  <span class="token operator">=</span> P3<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit TXD   <span class="token operator">=</span> P3<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>
sbit RXD   <span class="token operator">=</span> P3<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">/*  SCON  */</span>
sbit SM0   <span class="token operator">=</span> SCON<span class="token operator">^</span><span class="token number">7</span><span class="token punctuation">;</span>
sbit SM1   <span class="token operator">=</span> SCON<span class="token operator">^</span><span class="token number">6</span><span class="token punctuation">;</span>
sbit SM2   <span class="token operator">=</span> SCON<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>
sbit REN   <span class="token operator">=</span> SCON<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>
sbit TB8   <span class="token operator">=</span> SCON<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
sbit RB8   <span class="token operator">=</span> SCON<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit TI    <span class="token operator">=</span> SCON<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>
sbit RI    <span class="token operator">=</span> SCON<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">/*  P1  */</span>
sbit T2EX  <span class="token operator">=</span> P1<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 8052 only</span>
sbit T2    <span class="token operator">=</span> P1<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 8052 only</span>
             
<span class="token comment">/*  T2CON  */</span>
sbit TF2    <span class="token operator">=</span> T2CON<span class="token operator">^</span><span class="token number">7</span><span class="token punctuation">;</span>
sbit EXF2   <span class="token operator">=</span> T2CON<span class="token operator">^</span><span class="token number">6</span><span class="token punctuation">;</span>
sbit RCLK   <span class="token operator">=</span> T2CON<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>
sbit TCLK   <span class="token operator">=</span> T2CON<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>
sbit EXEN2  <span class="token operator">=</span> T2CON<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
sbit TR2    <span class="token operator">=</span> T2CON<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit C_T2   <span class="token operator">=</span> T2CON<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>
sbit CP_RL2 <span class="token operator">=</span> T2CON<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="LED小灯"><a href="#LED小灯" class="headerlink" title="LED小灯"></a>LED小灯</h3><img src="https://img.gejiba.com/images/23b83fbfea5d0ffd4c50daeefc7d940f.png" alt="23b83fbfea5d0ffd4c50daeefc7d940f.png" style="zoom:50%;">

<h5 id="点亮、熄灭、闪烁"><a href="#点亮、熄灭、闪烁" class="headerlink" title="点亮、熄灭、闪烁"></a>点亮、熄灭、闪烁</h5><p>74HC254输入分别控制8个不同的LED小灯</p>
<p>LED=0</p>
<p>LED=1</p>
<p>循环</p>
<h5 id="定时器-1"><a href="#定时器-1" class="headerlink" title="定时器"></a>定时器</h5><p>非精确定时</p>
<p>精确定时 定时模式选择0、1</p>
<h3 id="流水灯"><a href="#流水灯" class="headerlink" title="流水灯"></a>流水灯</h3><h5 id="左右移动"><a href="#左右移动" class="headerlink" title="左右移动"></a>左右移动</h5><p>动态扫描</p>
<h3 id="LED数码管"><a href="#LED数码管" class="headerlink" title="LED数码管"></a>LED数码管</h3><p>数码管共有a,b,c,d,e,f,g,dp 8个段，每个段都是一个led小灯</p>
<p>由74HC138控制三极管的导通来控制整个数码管的使能</p>
<p><strong>真值表</strong></p>
<p><img src="http://image.kmoon.fun//images/202211262038772.png" alt="image-20221126203841702"></p>
<h5 id="静态显示"><a href="#静态显示" class="headerlink" title="静态显示"></a>静态显示</h5><h5 id="动态显示"><a href="#动态显示" class="headerlink" title="动态显示"></a>动态显示</h5><img src="http://image.kmoon.fun//images/202211262147399.png" alt="image-20221126214735326" style="zoom: 80%;">

<p>74HC138只能在同一个时间导通一个三极管，数码管是靠6个三极管来控制。</p>
<p>100Hz无闪烁（欺骗你的眼睛） 动态扫描</p>
<h5 id="消隐"><a href="#消隐" class="headerlink" title="消隐"></a>消隐</h5><p>主要是在数码管<strong>位选和段选产生的瞬态</strong>造成的，解决方法分以下两种：</p>
<ol>
<li><p>关闭段</p>
<p>刷新之前关闭所有段，改变好了位选后再打开段即可</p>
<p>在switch(i)前加一句P0=0XFF。</p>
</li>
<li><p>关闭位</p>
<p>关闭数码管的位，赋值过程都做好后再重新打开</p>
<p>在switch(i)前加一句ENLED=1，等赋值完成在重新赋值后break。</p>
</li>
</ol>
<h3 id="LED点阵"><a href="#LED点阵" class="headerlink" title="LED点阵"></a>LED点阵</h3><img src="https://img.gejiba.com/images/cd10d6e1fa6f001af44a46128d220289.png" alt="cd10d6e1fa6f001af44a46128d220289.png" style="zoom:50%;">

<p>一个8x8的点阵由64个LED小灯组成</p>
<p>控制点阵左侧引脚（阳极）的74HC138是原理图上的<strong>U4</strong>，8个引脚自上而下依次由U4的Y0~Y7输出来控制</p>
<p>使能U4：ENLEN=0,ADDR3=0</p>
<p>分开关：ADDR210,控制8排点阵LED</p>
<h5 id="显示"><a href="#显示" class="headerlink" title="显示"></a>显示</h5><p>P0整体控制一行点阵LED</p>
<h5 id="移动"><a href="#移动" class="headerlink" title="移动"></a>移动</h5><h3 id="按键"><a href="#按键" class="headerlink" title="按键"></a>按键</h3><img src="https://img.gejiba.com/images/ec58822f5aac7ef43eaa790114a53247.png" alt="ec58822f5aac7ef43eaa790114a53247.png" style="zoom: 67%;">

<p><strong>P2口（8位）控制keyOut1<del>4和KeyIn1</del>4</strong></p>
<h5 id="独立按键"><a href="#独立按键" class="headerlink" title="独立按键"></a>独立按键</h5><p>各自与独立的输入线相连接</p>
<h5 id="矩阵按键"><a href="#矩阵按键" class="headerlink" title="矩阵按键"></a>矩阵按键</h5><p>“多键一按”</p>
<h5 id="按键消抖"><a href="#按键消抖" class="headerlink" title="按键消抖"></a>按键消抖</h5><h3 id="电机"><a href="#电机" class="headerlink" title="电机"></a>电机</h3><img src="https://img.gejiba.com/images/d81a3297fc5b22355a9ec04c1d26d5de.png" alt="d81a3297fc5b22355a9ec04c1d26d5de.png" style="zoom:67%;">

<p>转动</p>
<h3 id="蜂鸣器-1"><a href="#蜂鸣器-1" class="headerlink" title="蜂鸣器"></a>蜂鸣器</h3><h3 id="UART串口通信-1"><a href="#UART串口通信-1" class="headerlink" title="UART串口通信"></a>UART串口通信</h3><h3 id="1602液晶"><a href="#1602液晶" class="headerlink" title="1602液晶"></a>1602液晶</h3><h3 id="I2C总线"><a href="#I2C总线" class="headerlink" title="I2C总线"></a>I2C总线</h3><h3 id="E²PROM"><a href="#E²PROM" class="headerlink" title="E²PROM"></a>E²PROM</h3><h3 id="实时时钟DS1302"><a href="#实时时钟DS1302" class="headerlink" title="实时时钟DS1302"></a>实时时钟DS1302</h3><ol>
<li><p>BCD码</p>
<p>0-9：0b0000-0b1001</p>
</li>
<li><p>SPI时序</p>
<p>高速 全双工 同步通信总线</p>
<img src="http://image.kmoon.fun//images/202211081412855.png" alt="image-20221108141216732" style="zoom:67%;">

<p>SPI四种模式：时钟极性/相位–&gt;数据采样/输出</p>
<img src="http://image.kmoon.fun//images/202211081414016.png" alt="image-20221108141441956" style="zoom: 67%;">

<p>实时时钟芯片DS1302</p>
<p>DS102.c文件</p>
</li>
</ol>
<h3 id="红外通信"><a href="#红外通信" class="headerlink" title="红外通信"></a>红外通信</h3><p>1. </p>
<h3 id="A-x2F-D-D-x2F-A"><a href="#A-x2F-D-D-x2F-A" class="headerlink" title="A/D D/A"></a>A/D D/A</h3><h3 id="RS-485通信与Modbus"><a href="#RS-485通信与Modbus" class="headerlink" title="RS-485通信与Modbus"></a>RS-485通信与Modbus</h3><h2 id="实践项目"><a href="#实践项目" class="headerlink" title="实践项目"></a>实践项目</h2><h3 id="多功能电子钟"><a href="#多功能电子钟" class="headerlink" title="多功能电子钟"></a>多功能电子钟</h3><h3 id="简易信号发生器"><a href="#简易信号发生器" class="headerlink" title="简易信号发生器"></a>简易信号发生器</h3><h3 id="温度传感器DS18B20"><a href="#温度传感器DS18B20" class="headerlink" title="温度传感器DS18B20"></a>温度传感器DS18B20</h3><h3 id="电子钟"><a href="#电子钟" class="headerlink" title="电子钟"></a>电子钟</h3><h3 id="计算器"><a href="#计算器" class="headerlink" title="计算器"></a>计算器</h3><h2 id="五、代码思路"><a href="#五、代码思路" class="headerlink" title="五、代码思路"></a>五、代码思路</h2><blockquote>
<p><strong>&lt;Tips：前面程序解释说明过的后续不再写出&gt;</strong></p>
</blockquote>
<p>闲话少叙，开始吧~</p>
<h3 id="1-点亮LED小灯"><a href="#1-点亮LED小灯" class="headerlink" title="1. 点亮LED小灯"></a>1. 点亮LED小灯</h3><p>​	思路：</p>
<p>​	<strong>总开关</strong>74HC138（<strong>U3</strong>）使能，74HC138输入控制<strong>LEDS6分开关</strong>为低电平，三极管Q16导通，74HC245（<strong>P0口</strong>）输入低电平，点亮对应小灯。</p>
   <pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;reg52.h&gt;   //本程序中相当于sfr P0 = 0x80; 
					 //P0为一个功能模块，有8个LED小灯,8个控制开关,输入低电平0为亮

sbit LED = P0^0;     //位地址声明，注意：sbit必须小写、P大写！
					 //P0^0表示74HC254一个输入值，即第一个LED的开关输入值

//因为74HC138（U3）为8个LED小灯总开关
//P1为一个功能模块，控制74HC138（U3）
sbit ADDR0 = P1^0;	 //ADDR0~2表示74HC138输入A0-2
sbit ADDR1 = P1^1;   
sbit ADDR2 = P1^2;
sbit ADDR3 = P1^3;	 //ADDR3代表74HC138使能端E3,高电平有效
sbit ENLED = P1^4;	 //ENLED代表74HC138使能端E1非,E2非,低电平有效

void main()
{
    ENLED = 0;
    ADDR3 = 1;
    
    ADDR2 = 1;	 //74HC138输入110，控制LEDS6（分开关）
    ADDR1 = 1;
    ADDR0 = 0;
    
    LED = 0;        //点亮小灯
    				
    while (1);      //程序停止在这里
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-LED闪烁"><a href="#2-LED闪烁" class="headerlink" title="2. LED闪烁"></a>2. LED闪烁</h3><p>   思路：LED=0亮，LED=1灭,中间+<strong>延时</strong>即可</p>
   <pre class="line-numbers language-c" data-language="c"><code class="language-c">sbit LED <span class="token operator">=</span> P0<span class="token operator">^</span>O<span class="token punctuation">;</span>	<span class="token comment">//也可以选择其他小灯P0^X</span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//定义一个无符号整型变量i赋初值0</span>
    
    <span class="token comment">//74HC138（U3）使能</span>
    <span class="token comment">//经U3的Y6输出开启三极管Q16</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        LED <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                  <span class="token comment">//点亮小灯</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">30000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//延时一段时间</span>
        LED <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                  <span class="token comment">//熄灭小灯</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">30000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//延时一段时间</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-P0同时控制8个LED小灯"><a href="#3-P0同时控制8个LED小灯" class="headerlink" title="3. P0同时控制8个LED小灯"></a>3. P0同时控制8个LED小灯</h3><p>   思路：直接设置P0为<strong>16进制</strong>，转换为2进制就是8位，分别控制LED小灯亮灭（0/1）</p>
   <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    P0 <span class="token operator">=</span> <span class="token number">0xFE</span><span class="token punctuation">;</span>    <span class="token comment">//向P0写入数据来控制LED小灯,0XFE=11111110,即点亮最后一个小灯</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-流水灯左-x2F-右移"><a href="#4-流水灯左-x2F-右移" class="headerlink" title="4. 流水灯左/右移"></a>4. 流水灯左/右移</h3><p>   思路：P0统一控制，<strong>P0的值不断变化</strong>（移位）</p>
   <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//左移</span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token comment">//定义循环变量i，用于软件延时</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//定义计数变量cnt，用于移位控制</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        P0 <span class="token operator">=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">0x01</span> <span class="token operator">&lt;&lt;</span> cnt<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//P0等于1左移cnt位，控制8个LED ~表示二进制取反</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">20000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//软件延时</span>
        cnt<span class="token operator">++</span><span class="token punctuation">;</span>                    <span class="token comment">//移位计数变量自加1</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;=</span> <span class="token number">8</span><span class="token punctuation">)</span>             <span class="token comment">//移位计数超过7后，再重新从0开始</span>
        <span class="token punctuation">{</span>
            cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//右移</span>
P0 <span class="token operator">=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">0x80</span> <span class="token operator">&gt;&gt;</span> cnt<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//P0等于0x80右移cnt位，控制8个LED</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-花样流水灯-循环往返"><a href="#5-花样流水灯-循环往返" class="headerlink" title="5. 花样流水灯(循环往返)"></a>5. 花样流水灯(循环往返)</h3><p>   思路：主要是初值设定＋条件语句+<strong>判断</strong>（移到头后重新换方向移动）</p>
   <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//定义循环变量i，用于软件延时</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> dir <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//定义移位方向变量dir，用于控制移位的方向</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> shift <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>  <span class="token comment">//定义循环移位变量shift，并赋初值0x01</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        P0 <span class="token operator">=</span> <span class="token operator">~</span>shift<span class="token punctuation">;</span>              <span class="token comment">//P0等于循环移位变量取反，控制8个LED</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">20000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//软件延时</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dir <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>             <span class="token comment">//移位方向变量为0时，左移</span>
        <span class="token punctuation">{</span>
            shift <span class="token operator">=</span> shift <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment">//循环移位变量左移1位</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>shift <span class="token operator">==</span> <span class="token number">0x80</span><span class="token punctuation">)</span>    <span class="token comment">//左移到最左端后，改变移位方向</span>
            <span class="token punctuation">{</span>
                dir <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>                      <span class="token comment">//移位方向变量不为0时，右移</span>
        <span class="token punctuation">{</span>
            shift <span class="token operator">=</span> shift <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment">//循环移位变量右移1位</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>shift <span class="token operator">==</span> <span class="token number">0x01</span><span class="token punctuation">)</span>    <span class="token comment">//右移到最右端后，改变移位方向</span>
            <span class="token punctuation">{</span>
                dir <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-LED定时闪烁"><a href="#6-LED定时闪烁" class="headerlink" title="6. LED定时闪烁"></a>6. LED定时闪烁</h3><p>   思路：选择定时器模式-&gt;计算定时时长-&gt;设置初值-&gt;启动定时</p>
   <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//定义一个计数变量，记录T0溢出次数</span>

    TMOD <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>  <span class="token comment">//设置T0为模式1(16位定时器，范围0~65535)</span>
    TH0  <span class="token operator">=</span> <span class="token number">0xB8</span><span class="token punctuation">;</span>  <span class="token comment">//为T0赋初值0xB800（溢出一次为0.02s）</span>
    TL0  <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
    TR0  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">//启动T0</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//函数一直在这里循环定时,溢出TF0=1，时间为0.02s//</span>
        
        <span class="token keyword">if</span> <span class="token punctuation">(</span>TF0 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment">//判断T0是否溢出</span>
        <span class="token punctuation">{</span>
            TF0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>         <span class="token comment">//T0溢出后，清零中断标志</span>
            TH0 <span class="token operator">=</span> <span class="token number">0xB8</span><span class="token punctuation">;</span>      <span class="token comment">//重新赋初值</span>
            TL0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
            cnt<span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token comment">//计数值自加1（1X0.02s）</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;=</span> <span class="token number">50</span><span class="token punctuation">)</span>   <span class="token comment">//判断T0溢出是否达到50次（1s）</span>
            <span class="token punctuation">{</span>
                cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token comment">//达到50次后计数值清零</span>
                LED <span class="token operator">=</span> <span class="token operator">~</span>LED<span class="token punctuation">;</span>  <span class="token comment">//LED取反：0--&gt;1、1--&gt;0</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="7-数码管显示”1”"><a href="#7-数码管显示”1”" class="headerlink" title="7. 数码管显示”1”"></a>7. 数码管显示”1”</h3><p>   思路：</p>
<p>   <strong>涉及新的模块，我们重新讲一遍。</strong></p>
<p>   <strong>总开关</strong>74HC138使能：ENLED=0,ADDR3=1</p>
<p>   74HC138输入值ADDR012=000，选择控制<strong>分开关</strong>LEDS0，即第一个数码管DS1</p>
<p>   P0控制DB_(DB)，即数码管各段输入，低电平有效</p>
   <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;reg52.h&gt;</span></span>

sbit ADDR0 <span class="token operator">=</span> P1<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>
sbit ADDR1 <span class="token operator">=</span> P1<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>
sbit ADDR2 <span class="token operator">=</span> P1<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit ADDR3 <span class="token operator">=</span> P1<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
sbit ENLED <span class="token operator">=</span> P1<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ENLED <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//使能U3，选择数码管DS1</span>
    ADDR3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">//分开关</span>
    ADDR2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    ADDR1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    ADDR0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    P0 <span class="token operator">=</span> <span class="token number">0xF9</span><span class="token punctuation">;</span>    <span class="token comment">//点亮数码管段b和c</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="8-数码管静态显示秒表（单个数码管）"><a href="#8-数码管静态显示秒表（单个数码管）" class="headerlink" title="8. 数码管静态显示秒表（单个数码管）"></a>8. 数码管静态显示秒表（单个数码管）</h3><p>   思路：数组循环索引</p>
   <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//用数组来存储数码管的真值表</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> code LedChar<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span>
    <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x8E</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//记录T0中断次数</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//记录经过的秒数</span>
    
    <span class="token comment">//！注意:之前解释说明过的重复代码省略</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>TF0 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment">//判断T0是否溢出</span>
        <span class="token punctuation">{</span>
            TF0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>         <span class="token comment">//T0溢出后，清零中断标志</span>
            TH0 <span class="token operator">=</span> <span class="token number">0xB8</span><span class="token punctuation">;</span>      <span class="token comment">//并重新赋初值</span>
            TL0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
            cnt<span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token comment">//计数值自加1</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;=</span> <span class="token number">50</span><span class="token punctuation">)</span>   <span class="token comment">//判断T0溢出是否达到50次（1s）</span>
            <span class="token punctuation">{</span>
                cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token comment">//达到50次后计数值清零</span>
                P0 <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>sec<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//当前秒数对应的真值表中的值送到P0口</span>
                sec<span class="token operator">++</span><span class="token punctuation">;</span>              <span class="token comment">//秒数记录自加1</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>sec <span class="token operator">&gt;=</span> <span class="token number">16</span><span class="token punctuation">)</span>      <span class="token comment">//当秒数超过0x0F(15)后，重新从0开始</span>
                <span class="token punctuation">{</span>
                    sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="9-使用定时器实现左右移动的流水灯"><a href="#9-使用定时器实现左右移动的流水灯" class="headerlink" title="9. 使用定时器实现左右移动的流水灯"></a>9. 使用定时器实现左右移动的流水灯</h3><p>   思路：第5题加个定时器而已</p>
   <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//定义计数变量cnt，记录T0溢出次数</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> dir <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//定义移位方向变量dir，用于控制移位的方向</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> shift <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>  <span class="token comment">//定义循环移位变量shift，并赋初值0x01</span>

    <span class="token comment">//省略74HC138使能，输入值，定时器初始化</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        P0 <span class="token operator">=</span> <span class="token operator">~</span>shift<span class="token punctuation">;</span>       <span class="token comment">//P0等于循环移位变量取反，控制8个LED</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>TF0 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//当TF0等于0时一直执行空循环，即停在这里直到T0溢出</span>
        TF0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token comment">//T0溢出后，清零中断标志</span>
        TH0 <span class="token operator">=</span> <span class="token number">0xB8</span><span class="token punctuation">;</span>        <span class="token comment">//并重新赋初值</span>
        TL0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
        cnt<span class="token operator">++</span><span class="token punctuation">;</span>             <span class="token comment">//计数值自加1</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;=</span> <span class="token number">10</span><span class="token punctuation">)</span>     <span class="token comment">//T0溢出达到10次后，控制移位（0.2s）</span>
        <span class="token punctuation">{</span>
            cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>dir <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token comment">//移位方向变量为0时，左移</span>
            <span class="token punctuation">{</span>
                shift <span class="token operator">=</span> shift <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//循环移位变量左移1位</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>shift <span class="token operator">==</span> <span class="token number">0x80</span><span class="token punctuation">)</span>   <span class="token comment">//左移到最左端后，改变移位方向</span>
                <span class="token punctuation">{</span>
                    dir <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>                     <span class="token comment">//移位方向变量不为0时，右移</span>
            <span class="token punctuation">{</span>
                shift <span class="token operator">=</span> shift <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//循环移位变量右移1位</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>shift <span class="token operator">==</span> <span class="token number">0x01</span><span class="token punctuation">)</span>   <span class="token comment">//右移到最右端后，改变移位方向</span>
                <span class="token punctuation">{</span>
                    dir <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="10-数码管静态显示秒表（倒计时）"><a href="#10-数码管静态显示秒表（倒计时）" class="headerlink" title="10. 数码管静态显示秒表（倒计时）"></a>10. 数码管静态显示秒表（倒计时）</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c">思路：第<span class="token number">8</span>题数组逆置或者变换sec

```c
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> sec <span class="token operator">=</span> <span class="token number">0x0F</span><span class="token punctuation">;</span>  <span class="token comment">//记录经过的秒数，倒计时初值0x0F(15)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>sec <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment">//当秒数大于0时，减1</span>
                <span class="token punctuation">{</span>
                    sec<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>                <span class="token comment">//当秒数等于0时，重新赋初值0x0F</span>
                <span class="token punctuation">{</span>
                    sec <span class="token operator">=</span> <span class="token number">0x0F</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
```<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="11-数码管动态显示秒表（多个数码管）"><a href="#11-数码管动态显示秒表（多个数码管）" class="headerlink" title="11. 数码管动态显示秒表（多个数码管）"></a>11. 数码管动态显示秒表（多个数码管）</h3><p>思路：(障眼法)</p>
<p>通过瞬间改变分开关74HC138输入值+P0的值，控制6个数码管显示数字</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> code LedChar<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">//数码管显示字符转换表</span>
    <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span>
    <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x8E</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> LedBuff<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">//数码管显示缓冲区，初值0xFF确保启动时都不亮</span>
    <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//动态扫描的索引</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span>  cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//记录T0中断次数</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//记录经过的秒数</span>

    <span class="token comment">//因为需要动态改变ADDR0-2的值，所以不需要再初始化了</span>
    TMOD <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>  <span class="token comment">//设置T0为模式1</span>
    TH0  <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>  <span class="token comment">//为T0赋初值0xFC67，定时1ms</span>
    TL0  <span class="token operator">=</span> <span class="token number">0x67</span><span class="token punctuation">;</span>
    TR0  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">//启动T0</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>TF0 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token comment">//判断T0是否溢出</span>
        <span class="token punctuation">{</span>
            TF0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>          <span class="token comment">//T0溢出后，清零中断标志</span>
            TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>       <span class="token comment">//并重新赋初值</span>
            TL0 <span class="token operator">=</span> <span class="token number">0x67</span><span class="token punctuation">;</span>
            cnt<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token comment">//计数值自加1</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;=</span> <span class="token number">1000</span><span class="token punctuation">)</span>  <span class="token comment">//判断T0溢出是否达到1000次（1s）</span>
            <span class="token punctuation">{</span>
                cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment">//达到1000次后计数值清零</span>
                sec<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token comment">//秒计数自加1</span>
                <span class="token comment">//以下代码将sec按十进制位从低到高依次提取并转为数码管显示字符</span>
                LedBuff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>sec<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                LedBuff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>sec<span class="token operator">/</span><span class="token number">10</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                LedBuff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>sec<span class="token operator">/</span><span class="token number">100</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                LedBuff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>sec<span class="token operator">/</span><span class="token number">1000</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                LedBuff<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>sec<span class="token operator">/</span><span class="token number">10000</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                LedBuff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>sec<span class="token operator">/</span><span class="token number">100000</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//以下代码完成数码管动态扫描刷新（控制6个数码管）</span>
            <span class="token comment">//看上去是6个数码管同时变化，但是是以极快的速度切换</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>	<span class="token comment">//最右边数码管</span>
                <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>	<span class="token comment">//依次进位</span>
                <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//举个例子</span>
当计数到sec<span class="token operator">=</span><span class="token number">123456</span>时，P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>LedChar<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0x82</span><span class="token punctuation">(</span>数码管显示<span class="token number">6</span><span class="token punctuation">)</span> 即个位显示<span class="token number">6</span>
```<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>​    </p>
<h3 id="12-数码管动态显示秒表（中断函数消隐）"><a href="#12-数码管动态显示秒表（中断函数消隐）" class="headerlink" title="12. 数码管动态显示秒表（中断函数消隐）"></a>12. 数码管动态显示秒表（中断函数消隐）</h3><p>思路:</p>
<p>消隐就是位选和段选，两个等一个搞好了在搞后一个。</p>
<p>下面程序的执行过程：定时到1ms-&gt;中断1次-&gt;定时到1s-&gt;进入中断函数-&gt;控制6个数码管</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    
    EA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token comment">//使能总中断,只要用到中断就要EA=1</span>
    <span class="token comment">//这里选用定时器0中断，因为定时器使用的是T0</span>
    ET0  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">//使能T0中断，分开关</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;=</span> <span class="token number">1000</span><span class="token punctuation">)</span>  <span class="token comment">//判断T0溢出是否达到1000次</span>
        <span class="token punctuation">{</span>
            cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment">//达到1000次后计数值清零</span>
            sec<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token comment">//秒计数自加1</span>
            <span class="token comment">//以下代码将sec按十进制位从低到高依次提取并转为数码管显示字符</span>
            LedBuff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>sec<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">//...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 定时器0中断服务函数 */</span>
<span class="token comment">// TF=1溢出1次就会调用中断函数1次（该程序中每1ms调用1次中断函数）</span>

<span class="token keyword">void</span> <span class="token function">InterruptTimer0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>		<span class="token comment">//N×8+3=中断向量地址，使单片机找到对应中断函数</span>
<span class="token punctuation">{</span>
    TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>  <span class="token comment">//重新加载初值</span>
    TL0 <span class="token operator">=</span> <span class="token number">0x67</span><span class="token punctuation">;</span>
    cnt<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token comment">//中断次数计数值加1</span>
    <span class="token comment">//以下代码完成数码管动态扫描刷新</span>
    P0 <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>   <span class="token comment">//显示消隐（全灭）</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token comment">//...</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>




<h3 id="13-数码管动态显示秒表（高位0不显示）"><a href="#13-数码管动态显示秒表（高位0不显示）" class="headerlink" title="13. 数码管动态显示秒表（高位0不显示）"></a>13. 数码管动态显示秒表（高位0不显示）</h3><p>思路：</p>
<p>取余只提取低位，即遇到0不显示</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> code LedChar<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">//数码管显示字符转换表</span>
    <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span>
    <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x8E</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> LedBuff<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">//数码管显示缓冲区，初值0xFF确保启动时都不亮</span>
    <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//动态扫描的索引</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//记录T0中断次数</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> j<span class="token punctuation">;</span>  <span class="token comment">//循环变量</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//记录经过的秒数</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">//中间转换缓冲区</span>

    EA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token comment">//使能总中断</span>
    ET0  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">//使能T0中断</span>
    <span class="token comment">//...</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;=</span> <span class="token number">1000</span><span class="token punctuation">)</span>  <span class="token comment">//判断T0溢出是否达到1000次</span>
        <span class="token punctuation">{</span>
            cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment">//达到1000次后计数值清零</span>
            sec<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token comment">//秒计数自加1</span>
            <span class="token comment">//将sec按十进制位从低到高依次提取到buf数组中</span>
            buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">10</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">100</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">1000</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">10000</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">100000</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            <span class="token comment">//从最高为开始，遇到0不显示，遇到非0退出循环</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">&gt;=</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    LedBuff<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//将剩余的有效数字位如实转换</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token punctuation">;</span> j<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>  <span class="token comment">//for()起始未对j操作，j即保持上个循环结束时的值</span>
            <span class="token punctuation">{</span>
                LedBuff<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>buf<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 定时器0中断服务函数 */</span>
<span class="token comment">//略</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="14-数码管动态显示999999倒计时（定时器T1中断）"><a href="#14-数码管动态显示999999倒计时（定时器T1中断）" class="headerlink" title="14. 数码管动态显示999999倒计时（定时器T1中断）"></a>14. 数码管动态显示999999倒计时（定时器<strong>T1</strong>中断）</h3><p>思路：</p>
<p>定时器T1中断，则定时器选择T1模式</p>
<p>倒序取余，高位0不显示，低位非0照常显示</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> code LedChar<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">//数码管显示字符转换表</span>
    <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span>
    <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x8E</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> LedBuff<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">//数码管显示缓冲区，初值0xFF确保启动时都不亮</span>
    <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> j<span class="token punctuation">;</span>  <span class="token comment">//循环变量</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sec <span class="token operator">=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>  <span class="token comment">//记录经过的秒数，倒计时初值为999999+1</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">//中间转换缓冲区</span>

    EA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token comment">//使能总中断</span>
    ENLED <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//使能U3</span>
    ADDR3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment">//因为需要动态改变ADDR0-2的值，所以不需要再初始化了</span>
    TMOD <span class="token operator">=</span> <span class="token number">0x10</span><span class="token punctuation">;</span>  <span class="token comment">//设置T1为模式1</span>
    TH1  <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>  <span class="token comment">//为T1赋初值0xFC67，定时1ms</span>
    TL1  <span class="token operator">=</span> <span class="token number">0x67</span><span class="token punctuation">;</span>
    ET1  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">//使能T1中断</span>
    TR1  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">//启动T1</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;=</span> <span class="token number">1000</span><span class="token punctuation">)</span>  <span class="token comment">//判断T1溢出是否达到1000次</span>
        <span class="token punctuation">{</span>
            cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment">//达到1000次后计数值清零</span>
            sec<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token comment">//秒计数自减1</span>
            <span class="token comment">//将sec按十进制位从低到高依次提取到buf数组中</span>
            buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">10</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">100</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">1000</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">10000</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> sec<span class="token operator">/</span><span class="token number">100000</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">;</span>
            <span class="token comment">//从最高为开始，遇到0不显示，遇到非0退出循环</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">&gt;=</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    LedBuff<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//将剩余的有效数字位如实转换</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token punctuation">;</span> j<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>  <span class="token comment">//for()起始未对j操作，j即保持上个循环结束时的值</span>
            <span class="token punctuation">{</span>
                LedBuff<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>buf<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 定时器1中断服务函数 */</span>
<span class="token keyword">void</span> <span class="token function">InterruptTimer1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">3</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//动态扫描的索引</span>
    <span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//记录T1中断次数</span>
    TH1 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>  <span class="token comment">//重新加载初值</span>
    TL1 <span class="token operator">=</span> <span class="token number">0x67</span><span class="token punctuation">;</span>
    cnt<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token comment">//中断次数计数值加1</span>
    <span class="token comment">//以下代码完成数码管动态扫描刷新</span>
    P0 <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>   <span class="token comment">//显示消隐</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="15-点亮点阵左上角LED小灯"><a href="#15-点亮点阵左上角LED小灯" class="headerlink" title="15. 点亮点阵左上角LED小灯"></a>15. 点亮点阵左上角LED小灯</h3><p>思路：</p>
<p>涉及新的模块，点阵LED由总开关74HC138（U4）控制</p>
<p>使能U4：ENLEN=0,ADDR3=0</p>
<p>分开关：ADDR210,控制8牌点阵LED</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">sbit LED<span class="token operator">=</span>P0<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>
sbit ADDR0<span class="token operator">=</span>P1<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>
sbit ADDR1<span class="token operator">=</span>P1<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>
sbit ADDR2<span class="token operator">=</span>P1<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit ADDR3<span class="token operator">=</span>P1<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
sbit ENLED<span class="token operator">=</span>P1<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    ENLED<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//使能U4</span>
    ADDR3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    
    ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//使能第一行点阵LED分开关</span>
    ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    
    LED<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//点亮左上角第一个LED</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="16-点亮点阵第二行LED小灯"><a href="#16-点亮点阵第二行LED小灯" class="headerlink" title="16. 点亮点阵第二行LED小灯"></a>16. 点亮点阵第二行LED小灯</h3><p>思路：使能第二行分开关，然后P0整体赋值即可点亮一行</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>

P0<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="17-点亮点阵全部LED小灯（定时器中断）"><a href="#17-点亮点阵全部LED小灯（定时器中断）" class="headerlink" title="17. 点亮点阵全部LED小灯（定时器中断）"></a>17. 点亮点阵全部LED小灯（定时器中断）</h3><p>思路：设置定时器模式T0，定义定时器0中断服务函数，动态扫描即可点亮全部点阵LED</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    EA<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>	<span class="token comment">//使能总中断</span>
    ENLED<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//使能U4</span>
    ADDR3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    TMOD<span class="token operator">=</span><span class="token number">0x01</span><span class="token punctuation">;</span>	<span class="token comment">//设置计时T0为模式1</span>
    THO<span class="token operator">=</span><span class="token number">0xFC</span><span class="token punctuation">;</span>	<span class="token comment">//设置初值</span>
    TL0<span class="token operator">=</span><span class="token number">0X67</span><span class="token punctuation">;</span>
    ET0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>		<span class="token comment">//使能T0中断（分开关）</span>
    TR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>		<span class="token comment">//启动定时器T0</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//定时器0中断服务函数</span>
<span class="token keyword">void</span> <span class="token function">InterruptTime0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    TH0<span class="token operator">=</span><span class="token number">0xFC</span><span class="token punctuation">;</span>
    THL<span class="token operator">=</span><span class="token number">0x67</span><span class="token punctuation">;</span>
    
    <span class="token keyword">switch</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="18-点阵显示静态字符（字模软件）"><a href="#18-点阵显示静态字符（字模软件）" class="headerlink" title="18. 点阵显示静态字符（字模软件）"></a>18. 点阵显示静态字符（字模软件）</h3><p>思路：</p>
<p>学会字模软件的使用，定义数组即可</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> code image<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">//图片的字模表</span>
    <span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0xFF</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    EA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token comment">//使能总中断</span>
    ENLED <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//使能U4，选择LED点阵</span>
    ADDR3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    TMOD <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>  <span class="token comment">//设置T0为模式1</span>
    TH0  <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>  <span class="token comment">//为T0赋初值0xFC67，定时1ms</span>
    TL0  <span class="token operator">=</span> <span class="token number">0x67</span><span class="token punctuation">;</span>
    ET0  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">//使能T0中断</span>
    TR0  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">//启动T0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 定时器0中断服务函数 */</span>
<span class="token keyword">void</span> <span class="token function">InterruptTimer0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//动态扫描的索引</span>

    TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>  <span class="token comment">//重新加载初值</span>
    TL0 <span class="token operator">=</span> <span class="token number">0x67</span><span class="token punctuation">;</span>
    <span class="token comment">//以下代码完成LED点阵动态扫描刷新</span>
    P0 <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>   <span class="token comment">//显示消隐</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="19-点阵的动画显示（纵向-x2F-横向移动）"><a href="#19-点阵的动画显示（纵向-x2F-横向移动）" class="headerlink" title="19. 点阵的动画显示（纵向/横向移动）"></a>19. 点阵的动画显示（纵向/横向移动）</h3><p>思路：</p>
<p>多张图片分别进行取模，方向不是问题，关键是定义图片的字模表数组</p>
<p>横向移动需要使用二维数组，因为字模数据不是连续的，对需要的图片逐一取模。</p>
<p>可以理解为switch语句下面的代码是同时执行的，动态扫描一张图片，然后250ms换下一张图片（只有一行不同）。</p>
<p>横向移动就是每250ms换一张图片，但是因为字模数据不是连续的，所以新的图片是全新的图片。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> code image<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">//图片的字模表</span>
<span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xF9</span><span class="token punctuation">,</span><span class="token number">0xF9</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span>
<span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span>
<span class="token number">0xC3</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0xBD</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xBD</span><span class="token punctuation">,</span><span class="token number">0xBD</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span>
<span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span>
<span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/* 定时器0中断服务函数 */</span>
<span class="token keyword">void</span> <span class="token function">InterruptTimer0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//动态扫描的索引</span>
    <span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> tmr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//250ms软件定时器</span>
    <span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//图片刷新索引</span>

    TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>  <span class="token comment">//重新加载初值</span>
    TL0 <span class="token operator">=</span> <span class="token number">0x67</span><span class="token punctuation">;</span>
    <span class="token comment">//以下代码完成LED点阵动态扫描刷新</span>
    P0 <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>   <span class="token comment">//显示消隐</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">9</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//以下代码完成每250ms改变一帧图像</span>
    tmr<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tmr <span class="token operator">&gt;=</span> <span class="token number">250</span><span class="token punctuation">)</span>  <span class="token comment">//达到250ms时改变一次图片索引</span>
    <span class="token punctuation">{</span>
        tmr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        index<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;=</span> <span class="token number">32</span><span class="token punctuation">)</span>  <span class="token comment">//图片索引达到32后归零(最后一张图片)</span>
        <span class="token punctuation">{</span>
            index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//横向移动</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> code image<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧1</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧2</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧3</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x1F</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0x1F</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧4</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">,</span><span class="token number">0x9F</span><span class="token punctuation">,</span><span class="token number">0x9F</span><span class="token punctuation">,</span><span class="token number">0x9F</span><span class="token punctuation">,</span><span class="token number">0x9F</span><span class="token punctuation">,</span><span class="token number">0x9F</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧5</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0xCF</span><span class="token punctuation">,</span><span class="token number">0xCF</span><span class="token punctuation">,</span><span class="token number">0xCF</span><span class="token punctuation">,</span><span class="token number">0xCF</span><span class="token punctuation">,</span><span class="token number">0xCF</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧6</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xC3</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0xC3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧7</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xE1</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xE1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧8</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0xF9</span><span class="token punctuation">,</span><span class="token number">0xF0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧9</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x1C</span><span class="token punctuation">,</span><span class="token number">0x1C</span><span class="token punctuation">,</span><span class="token number">0x1C</span><span class="token punctuation">,</span><span class="token number">0x3C</span><span class="token punctuation">,</span><span class="token number">0x7C</span><span class="token punctuation">,</span><span class="token number">0xF8</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧10</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x9C</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span><span class="token number">0x1E</span><span class="token punctuation">,</span><span class="token number">0x3E</span><span class="token punctuation">,</span><span class="token number">0x7C</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧11</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xCE</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">,</span><span class="token number">0x1F</span><span class="token punctuation">,</span><span class="token number">0x3E</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧12</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">,</span><span class="token number">0x9F</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧13</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0xCF</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧14</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xC3</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧15</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0xC0</span><span class="token punctuation">,</span><span class="token number">0xE1</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧16</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0xC0</span><span class="token punctuation">,</span><span class="token number">0xC0</span><span class="token punctuation">,</span><span class="token number">0xC0</span><span class="token punctuation">,</span><span class="token number">0xE0</span><span class="token punctuation">,</span><span class="token number">0xF0</span><span class="token punctuation">,</span><span class="token number">0xF9</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧17</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0xFC</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧18</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x3C</span><span class="token punctuation">,</span><span class="token number">0x7E</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧19</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x9C</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x9C</span><span class="token punctuation">,</span><span class="token number">0x1E</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧20</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xCE</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0xCE</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">,</span><span class="token number">0x1F</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧21</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧22</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧23</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xC3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧24</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0xC0</span><span class="token punctuation">,</span><span class="token number">0xE1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧25</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0xE0</span><span class="token punctuation">,</span><span class="token number">0xF0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧26</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0xF0</span><span class="token punctuation">,</span><span class="token number">0xF8</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧27</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xF9</span><span class="token punctuation">,</span><span class="token number">0xF9</span><span class="token punctuation">,</span><span class="token number">0xF9</span><span class="token punctuation">,</span><span class="token number">0xF9</span><span class="token punctuation">,</span><span class="token number">0xF9</span><span class="token punctuation">,</span><span class="token number">0xF8</span><span class="token punctuation">,</span><span class="token number">0xFC</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧28</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFC</span><span class="token punctuation">,</span><span class="token number">0xFC</span><span class="token punctuation">,</span><span class="token number">0xFC</span><span class="token punctuation">,</span><span class="token number">0xFC</span><span class="token punctuation">,</span><span class="token number">0xFC</span><span class="token punctuation">,</span><span class="token number">0xFC</span><span class="token punctuation">,</span><span class="token number">0xFE</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//动画帧29</span>
    <span class="token punctuation">{</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xFE</span><span class="token punctuation">,</span><span class="token number">0xFE</span><span class="token punctuation">,</span><span class="token number">0xFE</span><span class="token punctuation">,</span><span class="token number">0xFE</span><span class="token punctuation">,</span><span class="token number">0xFE</span><span class="token punctuation">,</span><span class="token number">0xFE</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">}</span>   <span class="token comment">//动画帧30</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/* 定时器0中断服务函数 */</span>
<span class="token keyword">void</span> <span class="token function">InterruptTimer0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//以下代码完成每250ms改变一帧图像</span>
    tmr<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tmr <span class="token operator">&gt;=</span> <span class="token number">250</span><span class="token punctuation">)</span>  <span class="token comment">//达到250ms时改变一次图片索引</span>
    <span class="token punctuation">{</span>
        tmr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        index<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;=</span> <span class="token number">30</span><span class="token punctuation">)</span>  <span class="token comment">//图片索引达到30后归零</span>
        <span class="token punctuation">{</span>
            index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="20-点阵实现9-0的倒计时牌显示"><a href="#20-点阵实现9-0的倒计时牌显示" class="headerlink" title="20. 点阵实现9~0的倒计时牌显示"></a>20. 点阵实现9~0的倒计时牌显示</h3><p>思路：</p>
<p>对9-0数字分别取模，然后定义数组，动态刷新即可。</p>
<p>因为字模数据不连续，所以需要二维数组。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> code image<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">{</span><span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字0</span>
    <span class="token punctuation">{</span><span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xE3</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字1</span>
    <span class="token punctuation">{</span><span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字2</span>
    <span class="token punctuation">{</span><span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字3</span>
    <span class="token punctuation">{</span><span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字4</span>
    <span class="token punctuation">{</span><span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字5</span>
    <span class="token punctuation">{</span><span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字6</span>
    <span class="token punctuation">{</span><span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字7</span>
    <span class="token punctuation">{</span><span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字8</span>
    <span class="token punctuation">{</span><span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数字9</span>
    <span class="token punctuation">{</span><span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//全亮</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/* 定时器0中断服务函数 */</span>
<span class="token keyword">void</span> <span class="token function">InterruptTimer0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>image<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//以下代码完成每秒改变一帧图像</span>
    tmr<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tmr <span class="token operator">&gt;=</span> <span class="token number">1000</span><span class="token punctuation">)</span>  <span class="token comment">//达到1000ms时改变一次图片索引</span>
    <span class="token punctuation">{</span>
        tmr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">//图片索引10~0循环</span>
            index <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            index<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="21-实现流水灯、数码管和点阵的同时显示"><a href="#21-实现流水灯、数码管和点阵的同时显示" class="headerlink" title="21. 实现流水灯、数码管和点阵的同时显示"></a>21. <strong>实现流水灯、数码管和点阵的同时显示</strong></h3><p>思路：动态刷新 注意总开关和分开关使能就行</p>
<p>同样理解：因为刷新速度飞快，所以我们可以认为switch语句后面的同时执行</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* 定时器0中断服务函数 */</span>
<span class="token keyword">void</span> <span class="token function">InterruptTimer0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//动态扫描的索引</span>

    TH0 <span class="token operator">=</span> <span class="token number">0xFC</span><span class="token punctuation">;</span>  <span class="token comment">//重新加载初值</span>
    TL0 <span class="token operator">=</span> <span class="token number">0x67</span><span class="token punctuation">;</span>
    <span class="token comment">//以下代码完成LED点阵动态扫描刷新</span>
    P0 <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>   <span class="token comment">//显示消隐</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//点阵LED部分	使能U4</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token comment">//数码管部分	  使能U3</span>
        <span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span>  ADDR3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">9</span><span class="token operator">:</span>  ADDR3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">10</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">11</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">12</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">13</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token comment">//独立LED部分  使能U3</span>
        <span class="token keyword">case</span> <span class="token number">14</span><span class="token operator">:</span> ADDR3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> P0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="22-秒计数函数"><a href="#22-秒计数函数" class="headerlink" title="22. 秒计数函数"></a>22. 秒计数函数</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">/* 秒计数函数，每秒进行一次秒数+1，并转换为数码管显示字符 */
void SecondCount()
{
    static unsigned int  cnt = 0;  //记录T0中断次数
    static unsigned long sec = 0;  //记录经过的秒数

    cnt++;            //计数值自加1
    if (cnt &gt;= 1000)  //判断T0溢出是否达到1000次
    {
        cnt = 0;      //达到1000次后计数值清零
        sec++;        //秒计数自加1
        LedBuff[0] = LedChar[sec%10];
        LedBuff[1] = LedChar[sec/10%10];
        LedBuff[2] = LedChar[sec/100%10];
        LedBuff[3] = LedChar[sec/1000%10];
        LedBuff[4] = LedChar[sec/10000%10];
        LedBuff[5] = LedChar[sec/100000%10];
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="23-数码管动态扫描刷新函数"><a href="#23-数码管动态扫描刷新函数" class="headerlink" title="23. 数码管动态扫描刷新函数"></a>23. 数码管动态扫描刷新函数</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* 数码管动态扫描刷新函数 */</span>
<span class="token keyword">void</span> <span class="token function">LedRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//动态扫描的索引</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> ADDR2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> ADDR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ADDR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> P0<span class="token operator">=</span>LedBuff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="24-独立按键的扫描（LED）"><a href="#24-独立按键的扫描（LED）" class="headerlink" title="24. 独立按键的扫描（LED）"></a>24. 独立按键的扫描（LED）</h3><p>思路：P2口（8位）控制KeyOut1<del>4，KeyIn1</del>4。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">sbit LED9 <span class="token operator">=</span> P0<span class="token operator">^</span><span class="token number">7</span><span class="token punctuation">;</span>
sbit LED8 <span class="token operator">=</span> P0<span class="token operator">^</span><span class="token number">6</span><span class="token punctuation">;</span>
sbit LED7 <span class="token operator">=</span> P0<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>
sbit LED6 <span class="token operator">=</span> P0<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>

sbit KEY1 <span class="token operator">=</span> P2<span class="token operator">^</span><span class="token number">4</span><span class="token punctuation">;</span>
sbit KEY2 <span class="token operator">=</span> P2<span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">;</span>
sbit KEY3 <span class="token operator">=</span> P2<span class="token operator">^</span><span class="token number">6</span><span class="token punctuation">;</span>
sbit KEY4 <span class="token operator">=</span> P2<span class="token operator">^</span><span class="token number">7</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//U3使能，LEDS6开启</span>
    
    P2 <span class="token operator">=</span> <span class="token number">0xF7</span><span class="token punctuation">;</span>   <span class="token comment">//P2.3置0，即KeyOut1输出低电平</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//将按键扫描引脚的值传递到LED上</span>
        LED9 <span class="token operator">=</span> KEY1<span class="token punctuation">;</span>  <span class="token comment">//按下时为0，对应的LED点亮</span>
        LED8 <span class="token operator">=</span> KEY2<span class="token punctuation">;</span>
        LED7 <span class="token operator">=</span> KEY3<span class="token punctuation">;</span>
        LED6 <span class="token operator">=</span> KEY4<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="25-按键消抖"><a href="#25-按键消抖" class="headerlink" title="25. 按键消抖"></a>25. 按键消抖</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> code LedChar<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">//数码管显示字符转换表</span>
    <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span>
    <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x8E</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    bit backup <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//定义一个位变量，保存前一次扫描的按键值</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//定义一个计数变量，记录按键按下的次数</span>
    
	<span class="token comment">//U3使能 </span>
    <span class="token comment">//选择数码管DS1进行显示</span>
    ADDR2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    ADDR1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    ADDR0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    P2 <span class="token operator">=</span> <span class="token number">0xF7</span><span class="token punctuation">;</span>   <span class="token comment">//P2.3置0，即KeyOut1输出低电平</span>
    P0 <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">//显示按键次数初值</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>KEY4 <span class="token operator">!=</span> backup<span class="token punctuation">)</span>   <span class="token comment">//当前值与前次值不相等说明此时按键有动作</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>backup <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">//如果前次值为0，则说明当前是由0变1，即按键弹起</span>
            <span class="token punctuation">{</span>
                cnt<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token comment">//按键次数+1</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;=</span> <span class="token number">10</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>             <span class="token comment">//只用1个数码管显示，所以加到10就清零重新开始</span>
                    cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                P0 <span class="token operator">=</span> LedChar<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//计数值显示到数码管上</span>
            <span class="token punctuation">}</span>
            backup <span class="token operator">=</span> KEY4<span class="token punctuation">;</span>   <span class="token comment">//更新备份为当前值，以备进行下次比较</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="26-矩阵按键的扫描、消抖、动作分离"><a href="#26-矩阵按键的扫描、消抖、动作分离" class="headerlink" title="26. 矩阵按键的扫描、消抖、动作分离"></a>26. 矩阵按键的扫描、消抖、动作分离</h3><h3 id="27-简易加法计算器"><a href="#27-简易加法计算器" class="headerlink" title="27. 简易加法计算器"></a>27. <strong>简易加法计算器</strong></h3><h3 id="28-按键实现数码管数字递减（F-0）"><a href="#28-按键实现数码管数字递减（F-0）" class="headerlink" title="28. 按键实现数码管数字递减（F~0）"></a>28. 按键实现数码管数字递减（F~0）</h3><h3 id="29-简易减法计算器（矩阵按键）"><a href="#29-简易减法计算器（矩阵按键）" class="headerlink" title="29. 简易减法计算器（矩阵按键）"></a>29. 简易减法计算器（矩阵按键）</h3><h3 id="30-电机简单转动"><a href="#30-电机简单转动" class="headerlink" title="30. 电机简单转动"></a>30. 电机简单转动</h3><h3 id="31-电机转动任意圈数（函数实现）"><a href="#31-电机转动任意圈数（函数实现）" class="headerlink" title="31. 电机转动任意圈数（函数实现）"></a>31. 电机转动任意圈数（函数实现）</h3><h3 id="32-电机转动任意圈数（定时中断实现）"><a href="#32-电机转动任意圈数（定时中断实现）" class="headerlink" title="32. 电机转动任意圈数（定时中断实现）"></a>32. 电机转动任意圈数（定时中断实现）</h3><h3 id="33-电机转动综合应用程序（按键控制）"><a href="#33-电机转动综合应用程序（按键控制）" class="headerlink" title="33. 电机转动综合应用程序（按键控制）"></a>33. 电机转动综合应用程序（按键控制）</h3><h3 id="34-步进电机正反转任意角度"><a href="#34-步进电机正反转任意角度" class="headerlink" title="34. 步进电机正反转任意角度"></a>34. 步进电机正反转任意角度</h3><h3 id="35-蜂鸣器指定频率发声"><a href="#35-蜂鸣器指定频率发声" class="headerlink" title="35. 蜂鸣器指定频率发声"></a>35. 蜂鸣器指定频率发声</h3><h3 id="36-蜂鸣器输出音乐（了解）"><a href="#36-蜂鸣器输出音乐（了解）" class="headerlink" title="36. 蜂鸣器输出音乐（了解）"></a>36. 蜂鸣器输出音乐（<strong>了解</strong>）</h3>
        </div>

    </div>

    

    

    

    

    

    
<nav class="article-nav">
  
    <a href="/2022/linux/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-caption">下一篇</div>
      <div class="article-nav-title">
        
          学习札记—Linux基础入门
        
      </div>
    </a>
  
  
    <a href="/2022/txyl/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-caption">上一篇</div>
      <div class="article-nav-title">深渊-WUT信息工程教材习题参考答案汇</div>
    </a>
  
</nav>


    <section class="share">
        <div class="share-title">分享</div>
        <a class="share-item" target="_blank"
            href="https://twitter.com/share?text=学习札记-51单片机(C语言版) - Kmoon&url=https%3A%2F%2Fwww.kmoon.fun%2F2022%2F51dpj%2F">
            <ion-icon name="logo-twitter"></ion-icon>
        </a>
        <a class="share-item" target="_blank"
            href="https://www.facebook.com/sharer.php?title=学习札记-51单片机(C语言版) - Kmoon&u=https%3A%2F%2Fwww.kmoon.fun%2F2022%2F51dpj%2F">
            <ion-icon name="logo-facebook"></ion-icon>
        </a>
        <!-- <a class="share-item" target="_blank"
            href="https://service.weibo.com/share/share.php?title=学习札记-51单片机(C语言版) - Kmoon&url=https://www.kmoon.fun/2022/51dpj/&pic=">
            <div class="n-icon n-icon-weibo"></div>
        </a> -->
    </section>

</article>










<section class="comments">
    <div id="valine-container"></div>
</section>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>







<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</div>
                </section>
            </section>

            
            <aside class="sidebar sidebar-search-fix">
                

    <div class="search">
    <div class="has-icon-right">
        <input type="text" class="form-input" id="search" placeholder="SEARCH" autocomplete="off">
        <div class="form-icon">
            <ion-icon name="search"></ion-icon>
        </div>
    </div>
    <div class="search-result" id="search-ps"></div>
</div>


<div class="widget" id="widget">
    
      
  <div class="widget-wrap">
    <div class="widget-inner">
      <div class="toc post-toc-html"></div>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-cate">
    <div class="widget-title"><span>Categories</span></div>
    <div class="widget-inner">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/XiaoHu-s-Daily/">XiaoHu's Daily</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/">他山之石</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/">刷题笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E6%9C%AD%E8%AE%B0/">学习札记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/">实验报告</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%87%92%E4%BA%BA%E5%BF%85%E5%A4%87/">懒人必备</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%AA%E5%91%BD%E5%90%8D/">未命名</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B7%B1%E6%B8%8A/">深渊</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/">渗透工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/">靶场日记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A1%B9%E7%9B%AE%E8%AE%A1%E5%88%92/">项目计划</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-tags">
    <div class="widget-title"><span>Tags</span></div>
    <div class="widget-inner">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/51%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">51单片机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google/" rel="tag">Google</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RNN/" rel="tag">RNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SRC/" rel="tag">SRC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sec/" rel="tag">Sec</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WUT/" rel="tag">WUT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Whut/" rel="tag">Whut</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XSS/" rel="tag">XSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/daily/" rel="tag">daily</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hacker/" rel="tag">hacker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdwon/" rel="tag">markdwon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/me/" rel="tag">me</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nmap/" rel="tag">nmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/upload/" rel="tag">upload</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web%E5%AE%89%E5%85%A8/" rel="tag">web安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag">信息收集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/" rel="tag">关系代数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%8D%E4%B9%A0%E9%A2%98/" rel="tag">复习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" rel="tag">实验报告</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" rel="tag">数学建模</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" rel="tag">数据库系统原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" rel="tag">文件上传漏洞</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8B%E8%AF%95/" rel="tag">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/" rel="tag">渗透工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%84%E7%BD%91%E6%8A%80%E6%9C%AF/" rel="tag">组网技术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%BD%91/" rel="tag">计网</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/" rel="tag">跨站请求伪造漏洞</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%B6%E5%9C%BA/" rel="tag">靶场</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-recent-posts">
    <div class="widget-title"><span>Recent Posts</span></div>
    <div class="widget-inner">
      <ul>
        
          <li>
            <a href="/2022/dbcreatereport/">WUT-数据库应用系统开发实验报告</a>
          </li>
        
          <li>
            <a href="/2022/edareport/">WUT-电子线路EDA实验报告</a>
          </li>
        
          <li>
            <a href="/2022/google/">他山之石-GoogleHacking谷歌语法</a>
          </li>
        
          <li>
            <a href="/2022/action/">开门见山-欢迎来到Kmoon的小世界</a>
          </li>
        
          <li>
            <a href="/2022/c/">实验报告-WUT_C++程序设计实验报告</a>
          </li>
        
      </ul>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-archive">
    <div class="widget-title"><span>Archive</span></div>
    <div class="widget-inner">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a></li></ul>
    </div>
  </div>


    
</div>

<div id="backtop"><i class="icon icon-arrow-up"></i></div>
            </aside>
            
        </div>
    </div>

    <footer class="footer">
    <div class="footer-wave">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#3c4859" fill-opacity="1" d="M0,160L60,181.3C120,203,240,245,360,240C480,235,600,181,720,186.7C840,192,960,256,1080,261.3C1200,267,1320,213,1380,186.7L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path></svg>
    </div>

    <!-- Please do not remove this -->
    <!-- 开源不易，请勿删除 -->
    <div class="footer-wrap">
        <div class="footer-inner"> 
            Kmoon &copy; 2022<br>
            Powered By Hexo · Theme By <a href="https://linhong.me/" target="_blank">Aomori</a> · <a href="https://github.com/lh1me/hexo-theme-aomori" target="_blank">Github</a>
			<br><img src="https://www.beian.gov.cn/img/new/gongan.png">
<a href="http://www.beian.gov.cn/" target="_blank">渝-2022011774</a>


        </div>
    </div>

</footer>

<script type="module" src="https://unpkg.com/ionicons@6.0.2/dist/ionicons/ionicons.esm.js"></script>






<script src="/dist/build.js?1654266144177.js"></script>


<script src="/dist/custom.js?1654266144177.js"></script>



<!-- 百度链接提交 -->
<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>











<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":220,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>